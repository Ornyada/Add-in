/*! For license information please see 53af1a76da26915c8863.js.LICENSE.txt */
function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return n};var e,n={},t=Object.prototype,r=t.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",c=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function u(e,n,t,r){return Object.defineProperty(e,n,{value:t,enumerable:!r,configurable:!r,writable:!r})}try{u({},"")}catch(e){u=function(e,n,t){return e[n]=t}}function l(n,t,r,o){var a=t&&t.prototype instanceof d?t:d,c=Object.create(a.prototype);return u(c,"_invoke",function(n,t,r){var o=1;return function(a,c){if(3===o)throw Error("Generator is already running");if(4===o){if("throw"===a)throw c;return{value:e,done:!0}}for(r.method=a,r.arg=c;;){var s=r.delegate;if(s){var u=C(s,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===o)throw o=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=3;var l=i(n,t,r);if("normal"===l.type){if(o=r.done?4:2,l.arg===f)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=4,r.method="throw",r.arg=l.arg)}}}(n,r,new _(o||[])),!0),c}function i(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=l;var f={};function d(){}function p(){}function g(){}var m={};u(m,a,(function(){return this}));var h=Object.getPrototypeOf,y=h&&h(h(E([])));y&&y!==t&&r.call(y,a)&&(m=y);var x=g.prototype=d.prototype=Object.create(m);function v(e){["next","throw","return"].forEach((function(n){u(e,n,(function(e){return this._invoke(n,e)}))}))}function b(e,n){function t(o,a,c,s){var u=i(e[o],e,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==_typeof(f)&&r.call(f,"__await")?n.resolve(f.__await).then((function(e){t("next",e,c,s)}),(function(e){t("throw",e,c,s)})):n.resolve(f).then((function(e){l.value=e,c(l)}),(function(e){return t("throw",e,c,s)}))}s(u.arg)}var o;u(this,"_invoke",(function(e,r){function a(){return new n((function(n,o){t(e,r,n,o)}))}return o=o?o.then(a,a):a()}),!0)}function C(n,t){var r=t.method,o=n.i[r];if(o===e)return t.delegate=null,"throw"===r&&n.i.return&&(t.method="return",t.arg=e,C(n,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var a=i(o,n.i,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,f;var c=a.arg;return c?c.done?(t[n.r]=c.value,t.next=n.n,"return"!==t.method&&(t.method="next",t.arg=e),t.delegate=null,f):c:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,f)}function w(e){this.tryEntries.push(e)}function k(n){var t=n[4]||{};t.type="normal",t.arg=e,n[4]=t}function _(e){this.tryEntries=[[-1]],e.forEach(w,this),this.reset(!0)}function E(n){if(null!=n){var t=n[a];if(t)return t.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,c=function t(){for(;++o<n.length;)if(r.call(n,o))return t.value=n[o],t.done=!1,t;return t.value=e,t.done=!0,t};return c.next=c}}throw new TypeError(_typeof(n)+" is not iterable")}return p.prototype=g,u(x,"constructor",g),u(g,"constructor",p),p.displayName=u(g,s,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===p||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,u(e,s,"GeneratorFunction")),e.prototype=Object.create(x),e},n.awrap=function(e){return{__await:e}},v(b.prototype),u(b.prototype,c,(function(){return this})),n.AsyncIterator=b,n.async=function(e,t,r,o,a){void 0===a&&(a=Promise);var c=new b(l(e,t,r,o),a);return n.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},v(x),u(x,s,"Generator"),u(x,a,(function(){return this})),u(x,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var r in n)t.unshift(r);return function e(){for(;t.length;)if((r=t.pop())in n)return e.value=r,e.done=!1,e;return e.done=!0,e}},n.values=E,_.prototype={constructor:_,reset:function(n){if(this.prev=this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(k),!n)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var t=this;function r(e){c.type="throw",c.arg=n,t.next=e}for(var o=t.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a[4],s=this.prev,u=a[1],l=a[2];if(-1===a[0])return r("end"),!1;if(!u&&!l)throw Error("try statement without catch or finally");if(null!=a[0]&&a[0]<=s){if(s<u)return this.method="next",this.arg=e,r(u),!0;if(s<l)return r(l),!1}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var o=r;break}}o&&("break"===e||"continue"===e)&&o[0]<=n&&n<=o[2]&&(o=null);var a=o?o[4]:{};return a.type=e,a.arg=n,o?(this.method="next",this.next=o[2],f):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),f},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t[2]===e)return this.complete(t[4],t[3]),k(t),f}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t[0]===e){var r=t[4];if("throw"===r.type){var o=r.arg;k(t)}return o}}throw Error("illegal catch attempt")},delegateYield:function(n,t,r){return this.delegate={i:E(n),r:t,n:r},"next"===this.method&&(this.arg=e),f}},n}function _createForOfIteratorHelper(e,n){var t="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=_unsupportedIterableToArray(e))||n&&e&&"number"==typeof e.length){t&&(e=t);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,s=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return c=e.done,e},e:function(e){s=!0,a=e},f:function(){try{c||null==t.return||t.return()}finally{if(s)throw a}}}}function _unsupportedIterableToArray(e,n){if(e){if("string"==typeof e)return _arrayLikeToArray(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_arrayLikeToArray(e,n):void 0}}function _arrayLikeToArray(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}function asyncGeneratorStep(e,n,t,r,o,a,c){try{var s=e[a](c),u=s.value}catch(e){return void t(e)}s.done?n(u):Promise.resolve(u).then(r,o)}function _asyncToGenerator(e){return function(){var n=this,t=arguments;return new Promise((function(r,o){var a=e.apply(n,t);function c(e){asyncGeneratorStep(a,r,o,c,s,"next",e)}function s(e){asyncGeneratorStep(a,r,o,c,s,"throw",e)}c(void 0)}))}}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("convertBtn").onclick=convertSTDF,document.getElementById("importFolderBtn").addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,t,r,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=document.getElementById("folderInput").files).length){e.next=4;break}return alert("Please select a folder first."),e.abrupt("return");case 4:t=new FormData,r=_createForOfIteratorHelper(n);try{for(r.s();!(o=r.n()).done;)a=o.value,t.append("files",a,a.webkitRelativePath)}catch(e){r.e(e)}finally{r.f()}return e.next=9,importFolder(t);case 9:case"end":return e.stop()}}),e)}))));var n=document.getElementById("importDatalogBtn");n&&n.addEventListener("click",importFile),document.getElementById("compareAll").addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark((function e(){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelectorAll("#checkboxForm input[type='checkbox']").forEach((function(e){e.checked=!e.checked}));case 2:case"end":return e.stop()}}),e)})))),document.getElementById("compare").addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,t,r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.querySelectorAll("#checkboxForm input[type='checkbox']"),t=Array.from(n).filter((function(e){return!e.checked})).map((function(e){return e.value})),console.log(t),r=Array.from(n).filter((function(e){return e.checked})).map((function(e){return e.value})),console.log(r),e.next=7,checkboxHide(t,r);case 7:case"end":return e.stop()}}),e)}))))}}));export function convertSTDF(){return _convertSTDF.apply(this,arguments)}function _convertSTDF(){return(_convertSTDF=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,t,r,o,a,c,s,u,l,i,f,d,p,g;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,document.body.style.cursor="wait",n=document.getElementById("stdfInput"),t=n.files,r=Array.from(t),t&&0!==t.length){e.next=7;break}return e.abrupt("return");case 7:console.log("File Amount : %d",r.length),logToConsole("File Amount : %d",r.length),o=0,a=r;case 10:if(!(o<a.length)){e.next=53;break}if(!(c=a[o]).name.toLowerCase().endsWith(".stdf")){e.next=48;break}if(s=new FormData,c){e.next=18;break}return console.warn("No file"),e.abrupt("return");case 18:return s.append("files",c),console.log("Processing : ".concat(c.name)),logToConsole("Processing : ".concat(c.name)),document.body.style.cursor="wait",e.next=24,fetch("https://limit-project-demo.onrender.com/upload-stdf/",{method:"POST",body:s});case 24:if((u=e.sent).ok){e.next=32;break}return e.next=28,u.text();case 28:return l=e.sent,console.error("STDF upload failed:",l),logToConsole("STDF upload failed:",l),e.abrupt("return");case 32:return e.next=34,u.blob();case 34:i=e.sent,f=window.URL.createObjectURL(i),d=c.name.replace(/\.[^/.]+$/,""),p="".concat(d,".xlsx"),(g=document.createElement("a")).href=f,g.download=p,document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(f),logToConsole("Successfully converted and downloaded STDF"),e.next=50;break;case 48:console.warn("Doesn't support ".concat(c.name)),logToConsole("Doesn't support ".concat(c.name));case 50:o++,e.next=10;break;case 53:e.next=59;break;case 55:e.prev=55,e.t0=e.catch(0),console.error("Error while processing file: ".concat(file.name),err),logToConsole("Error while processing file: ".concat(file.name));case 59:return e.prev=59,document.body.style.cursor="default",e.finish(59);case 62:case"end":return e.stop()}}),e,null,[[0,55,59,62]])})))).apply(this,arguments)}function importFile(){return _importFile.apply(this,arguments)}function _importFile(){return _importFile=_asyncToGenerator(_regeneratorRuntime().mark((function e(){var n,t,r,o,a,c,s;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.body.style.cursor="wait",n=document.getElementById("fileInput"),t=n.files,r=Array.from(t),t&&0!==t.length){e.next=6;break}return e.abrupt("return");case 6:console.log("File Amount : %d",r.length),logToConsole("File Amount : %d",r.length),o=0,a=_regeneratorRuntime().mark((function e(){var n,t,r,a,u,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=s[c],t=n.name.toLowerCase().endsWith(".csv"),r=n.name.toLowerCase().endsWith(".xlsx"),e.prev=3,t||r?(console.log("Processing : ".concat(n.name)),logToConsole("Processing : ".concat(n.name)),(a=new FileReader).onload=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=new Uint8Array(t.target.result),!(XLSX.read(r,{type:"array"}).SheetNames.length>1)){e.next=10;break}return e.next=6,uploadSelfConvertedDatalog(n,o);case 6:logToConsole("Processed file = %d",o=e.sent),e.next=15;break;case 10:return logToConsole("EY datalog is importing"),e.next=13,uploadEYdatalog(n,o);case 13:logToConsole("Processed file = %d",o=e.sent);case 15:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),a.readAsArrayBuffer(n),(u=document.getElementById("importedFilesList"))&&((l=document.createElement("li")).textContent="".concat(n.name," - ").concat(n.webkitRelativePath||n.name),u.appendChild(l))):(console.warn("Doesn't support ".concat(n.name)),logToConsole("Doesn't support ".concat(n.name))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),console.error("Error while processing file: ".concat(n.name),e.t0),logToConsole("Error while processing file: ".concat(n.name));case 11:return e.prev=11,e.next=14,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,o,a,c,s,u,l;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.workbook.worksheets).load("items/name"),e.next=4,t.sync();case 4:return o="InputFiles",r.items.map((function(e){return e.name})).includes(o)?a=r.getItem(o):(a=r.add(o),c=["File_Name"],(s=a.getRangeByIndexes(0,0,1,c.length)).values=[c],s.format.fill.color="#C6EFCE",s.format.font.bold=!0,a.position=0),(u=a.getUsedRange()).load("rowCount"),e.next=11,t.sync();case 11:return l=u.rowCount,a.getRangeByIndexes(l,0,1,1).values=[[n.name]],e.next=16,t.sync();case 16:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 14:return e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[3,7,11,15]])})),c=0,s=r;case 11:if(!(c<s.length)){e.next=16;break}return e.delegateYield(a(),"t0",13);case 13:c++,e.next=11;break;case 16:document.body.style.cursor="default";case 17:case"end":return e.stop()}}),e)}))),_importFile.apply(this,arguments)}function uploadSelfConvertedDatalog(e,n){return _uploadSelfConvertedDatalog.apply(this,arguments)}function _uploadSelfConvertedDatalog(){return _uploadSelfConvertedDatalog=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.abrupt("return",new Promise((function(e,r){var o=new FileReader;o.onload=function(r){var o=new FormData;o.append("file",n);var a=new Uint8Array(r.target.result),c=XLSX.read(a,{type:"array"}).Sheets.mir;Excel.run(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function n(a){var s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P,H,j,W;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return l=a.workbook.worksheets.getItem("Masterfile"),(i=l.getUsedRange()).load(["rowCount","columnCount"]),n.next=5,a.sync();case 5:f=a.workbook.worksheets.getItem("Masterfile"),d=1e3,p=i.rowCount,g=i.columnCount,m=[],h=0;case 11:if(!(h<p)){n.next=21;break}return y=Math.min(d,p-h),(x=f.getRangeByIndexes(h,0,y,g)).load("values"),n.next=17,a.sync();case 17:m=m.concat(x.values);case 18:h+=d,n.next=11;break;case 21:for(v=m[0],console.log("headers: ",v),b=XLSX.utils.sheet_to_json(c,{defval:""}),C=null===(s=b[0])||void 0===s||null===(s=s.JOB_NAM)||void 0===s?void 0:s.trim(),w=null===(u=b[0])||void 0===u||null===(u=u.TEST_COD)||void 0===u?void 0:u.trim(),k=v.indexOf(C),console.log("productColINdex before add product name or stage: %d",k),_=[],T=0;T<=v.length;T++)"Can remove (Y/N)"===v[T]&&(E=T),"Lsl_typ"===v[T]&&(I=T);if(I-E-1>0)for(F=E+1;F<I;F++)A=v[F],S=m[1][F],A&&""!==A.trim()?(_.push({name:A.trim(),stage:S}),R=A.trim()):_.push({name:R,stage:S});if(-1!==k){n.next=57;break}if((B=a.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(N=B.getRange("F1:F1")).values=[[C]],!((O=v.indexOf("Can remove (Y/N)"))<0)){n.next=42;break}return logToConsole("Can't find 'Can remove' col"),n.abrupt("return");case 42:if(!((L=v.indexOf("Lsl_typ"))<0)){n.next=46;break}return logToConsole("Can't find 'Lsl_typ' col"),n.abrupt("return");case 46:for(U=0,Y=O;Y<L;Y++)M=i.getCell(0,Y),isNaN(M)&&""===M||U++;return G=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][U%4],N.format.fill.color=G,B.getRange("F2:F2").values=[[w]],n.next=55,a.sync();case 55:n.next=83;break;case 57:return D=a.workbook.worksheets.getItem("Masterfile"),n.next=60,a.sync();case 60:return P=k,H=_.filter((function(e){return e.name===C})).length,console.log("product : %s , stage count : %d stage",C,H),D.getRangeByIndexes(0,P+1,1,1).insert(Excel.InsertShiftDirection.right),(i=D.getUsedRange()).load("rowCount"),n.next=69,a.sync();case 69:return j=i.rowCount,D.getRangeByIndexes(1,P+H,j,1).insert(Excel.InsertShiftDirection.right),i=D.getUsedRange(),n.next=75,a.sync();case 75:return D.getCell(1,P+H).values=[[w]],console.log("startcol for merge: %d stagecount for merge: %d",P,H),(W=D.getRangeByIndexes(0,P,1,H)).values=Array(1).fill(Array(H).fill(C)),W.merge(),n.next=83,a.sync();case 83:return i=l.getUsedRange(),n.next=86,a.sync();case 86:return l.activate(),console.log("Completely added product name and stage"),logToConsole("Completely added product name and stage"),n.abrupt("return",fetch("https://limit-project-demo.onrender.com/process-self-converted-datalog/",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(n){var o=n.test_data;null!==o&&logToConsole("Successfully fetched process-datalog-excel"),Excel.run(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function n(a){var c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,k,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P,H,j,W,X,V,q,J,$,z,K,Q,Z,ee,ne,te,re,oe,ae;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s=a.workbook.worksheets.getItem("Masterfile"),(u=s.getUsedRange()).load(["rowCount","columnCount"]),n.next=5,a.sync();case 5:l=1e3,i=u.rowCount,f=u.columnCount,d=[],p=0;case 10:if(!(p<i)){n.next=20;break}return g=Math.min(l,i-p),(m=s.getRangeByIndexes(p,0,g,f)).load("values"),n.next=16,a.sync();case 16:d=d.concat(m.values);case 17:p+=l,n.next=10;break;case 20:if(h=d[0],y=h.indexOf("Test number"),x=h.indexOf("Suite name"),v=h.indexOf("Test name"),-1!==y){n.next=28;break}return console.error("Test number column is not found"),logToConsole("Test number is not found"),n.abrupt("return");case 28:if(-1!==x){n.next=32;break}return console.error("Suite name is not found"),logToConsole("Suite name is not found"),n.abrupt("return");case 32:if(-1!==v){n.next=36;break}return console.error("Test name is not found"),logToConsole("Test name is not found"),n.abrupt("return");case 36:return(b=s.getRangeByIndexes(2,v,d.length-2,1)).load("values"),n.next=40,a.sync();case 40:C=[],n.prev=41,C=b.values.flat().filter((function(e){return""!==e})),n.next=49;break;case 45:return n.prev=45,n.t0=n.catch(41),console.error("Error while processing testNameRange.values:",n.t0),n.abrupt("return");case 49:if(Array.isArray(o)){n.next=52;break}return console.error("TestData isn't an array or isn't downloaded"),n.abrupt("return");case 52:k=[],n.prev=53,k=o.filter((function(e){return!C.includes(e.test_name)})),n.next=61;break;case 57:return n.prev=57,n.t1=n.catch(53),console.error("Error while TestData.filter",n.t1),n.abrupt("return");case 61:if(Array.isArray(d)){n.next=64;break}return console.error("allValues isn't an array"),n.abrupt("return");case 64:if(E=d.length,R=[],F=[],n.prev=67,!(k.length>0)){n.next=87;break}if(A=k.map((function(e){var n;return[null!==(n=null==e?void 0:e.test_number)&&void 0!==n?n:""]})),-1!==y){n.next=73;break}return logToConsole("Can't find Test number column in header"),n.abrupt("return");case 73:return s.getRangeByIndexes(E,y,k.length,1).values=A,n.next=77,a.sync();case 77:return I=s.getRangeByIndexes(E,x,k.length,1),T=s.getRangeByIndexes(E,v,k.length,1),R=k.map((function(e){return[e.suite_name]})),F=k.map((function(e){return[e.test_name]})),I.values=R,T.values=F,n.next=85,a.sync();case 85:n.next=88;break;case 87:logToConsole("There's no new test");case 88:n.next=93;break;case 90:n.prev=90,n.t2=n.catch(67),console.error("Error while processing newTests:",n.t2);case 93:if(S=new Uint8Array(r.target.result),B=XLSX.read(S,{type:"array"}),N=B.Sheets.mir,O=XLSX.utils.sheet_to_json(N,{defval:""}),L=null===(c=O[0])||void 0===c||null===(c=c.JOB_NAM)||void 0===c?void 0:c.trim(),-1!==(U=h.indexOf(L))){n.next=103;break}return console.error("Can't find product name column:",L),logToConsole("Can't find product name column:",L),n.abrupt("return");case 103:return _.push({name:L,stage:w}),Y=_.filter((function(e){return e.name===L})).length,(G=s.getRangeByIndexes(1,U,1,Y)).load("values"),n.next=109,a.sync();case 109:D=0;case 110:if(!(D<=Y)){n.next=118;break}if(console.log("stage %d = %s",D,G.values[0][D]),G.values[0][D]!==w){n.next=115;break}return M=D,n.abrupt("break",118);case 115:D++,n.next=110;break;case 118:return void 0===M&&(console.error("Can't find stage name index :",w),logToConsole("Can't find stage name index :",w)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",U,Y,M),u=s.getUsedRange(),n.next=123,a.sync();case 123:return u.load(["rowCount","columnCount"]),n.next=126,a.sync();case 126:i=u.rowCount,f=u.columnCount,d=[],P=0;case 130:if(!(P<i)){n.next=140;break}return H=Math.min(l,i-P),(j=s.getRangeByIndexes(P,0,H,f)).load("values"),n.next=136,a.sync();case 136:d=d.concat(j.values);case 137:P+=l,n.next=130;break;case 140:return h=d[0],(W=s.getRangeByIndexes(2,v,d.length-2,1)).load("values"),n.next=145,a.sync();case 145:X=W.values.map((function(e){return e[0]})),V=[];try{V=X.map((function(e){var n=o.find((function(n){return n.test_name===e}));return[n?n.YN_check:""]}))}catch(e){console.error("Error while creating YNValues:",e)}return(q=s.getRangeByIndexes(2,U+M,V.length,1)).load("values"),n.next=152,a.sync();case 152:return 0===V.length?(console.warn("No Y/N check data"),logToConsole("No Y/N check data")):console.log("YN.length of %s %s is %d",L,w,V.length),q.values=V,n.next=156,a.sync();case 156:return J=h.indexOf("Is used (Y/N)"),($=s.getRangeByIndexes(2,J,q.values.length,1)).load("values"),n.next=161,a.sync();case 161:for(z=$.values,Array.isArray(z)&&0!==z.length||(z=Array.from({length:q.values.length},(function(){return[""]}))),K=0;K<q.values.length;K++)"Y"===q.values[K][0]?"Partial"===z[K][0]||"No"===z[K][0]?z[K][0]="Partial":""===z[K][0]&&(z[K][0]="All"):"All"===z[K][0]||"Partial"===z[K][0]?z[K][0]="Partial":z[K][0]="No";return $.values=z,n.next=167,a.sync();case 167:for((Q=q.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",Q.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},Z=["All","Partial"],ee=["#C6EFCE","#FFEB9C"],ne=$.conditionalFormats.count-1;ne>=0;ne--)$.conditionalFormats.getItemAt(ne).delete();return n.next=175,a.sync();case 175:for(te=0;te<Z.length;te++)re=Z[te],oe=ee[te],(ae=$.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=oe,ae.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:re};return n.next=178,a.sync();case 178:console.log("Finished processing a file"),logToConsole("Finished processing a file"),t++,e(t),document.body.style.cursor="default";case 183:case"end":return n.stop()}}),n,null,[[41,45],[53,57],[67,90]])})));return function(e){return n.apply(this,arguments)}}())})));case 90:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},o.onerror=r,o.readAsArrayBuffer(n)})));case 2:case"end":return e.stop()}}),e)}))),_uploadSelfConvertedDatalog.apply(this,arguments)}function uploadEYdatalog(e,n){return _uploadEYdatalog.apply(this,arguments)}function _uploadEYdatalog(){return _uploadEYdatalog=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,r){var o=new FileReader;o.onload=function(){var r=_asyncToGenerator(_regeneratorRuntime().mark((function r(o){var a,c,s,u,l,i,f,d,p,g,m,h,y,x;return _regeneratorRuntime().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return(a=new FormData).append("file",n),new Uint8Array(o.target.result),r.next=5,fetch("https://limit-project-demo.onrender.com/process-EY/",{method:"POST",body:a});case 5:if((c=r.sent).ok){r.next=10;break}return console.error("Upload failed"),logToConsole("Upload failed"),r.abrupt("return");case 10:return r.next=12,c.json();case 12:s=r.sent,u=s.data,l=[],d=[],p=_createForOfIteratorHelper(u);try{for(p.s();!(g=p.n()).done;)m=g.value,f!==m.product?(f=m.product,i=m.stage,l.push({name:m.product,stage:m.stage}),d.push(f)):m.stage!==i&&(i=m.stage,l.push({name:m.product,stage:m.stage}))}catch(e){p.e(e)}finally{p.f()}console.log("All product: ",d),console.log("All EY stage and product: ",l),h=_regeneratorRuntime().mark((function e(){var n,t,r,o,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=x[y],t=l.filter((function(e){return e.name===n})),console.log("OneProduct_Allstage: ",t),r=_createForOfIteratorHelper(t),e.prev=4,a=_regeneratorRuntime().mark((function e(){var n,t,r,a;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.value,t=n.name,r=n.stage.toLowerCase(),e.next=5,Check_product_stage(t,r);case 5:return a=u.filter((function(e){return t===e.product&&n.stage===e.stage})),console.log("OneStage_data: ",a),e.next=9,WriteNewtest(a);case 9:return e.next=11,YN(a,t,r);case 11:case"end":return e.stop()}}),e)})),r.s();case 7:if((o=r.n()).done){e.next=11;break}return e.delegateYield(a(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),r.e(e.t1);case 16:return e.prev=16,r.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})),y=0,x=d;case 22:if(!(y<x.length)){r.next=27;break}return r.delegateYield(h(),"t0",24);case 24:y++,r.next=22;break;case 27:logToConsole("Imported EY file successfully"),t++,e(t);case 30:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}(),o.onerror=r,o.readAsArrayBuffer(n)})));case 1:case"end":return e.stop()}}),e)}))),_uploadEYdatalog.apply(this,arguments)}function importFolder(e){return _importFolder.apply(this,arguments)}function _importFolder(){return _importFolder=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var t,r,o,a,c;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],r=[],o=[],a=[],c=[],e.next=7,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(s){var u,l,i,f,d,p,g,m,h,y,x,v;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,fetch("https://limit-project-demo.onrender.com/upload-folder/",{method:"POST",body:n});case 3:if((u=e.sent).ok){e.next=8;break}return console.error("Upload failed"),logToConsole("Upload failed"),e.abrupt("return");case 8:return logToConsole("Imported Folder fetched successfully"),e.next=11,u.json();case 11:return l=e.sent,i=l.mfh_files||[],(f=document.getElementById("mfh-list")).innerHTML="",(d=s.workbook.worksheets).load("items/name"),e.next=19,s.sync();case 19:if(p="InputFiles",!d.items.map((function(e){return e.name})).includes(p)){e.next=25;break}g=d.getItem(p),e.next=34;break;case 25:return g=d.add(p),m=["File_Name"],(h=g.getRangeByIndexes(0,0,1,m.length)).values=[m],h.format.fill.color="#C6EFCE",h.format.font.bold=!0,g.position=0,e.next=34,s.sync();case 34:if(p="Masterfile",d.items.map((function(e){return e.name})).includes(p)){e.next=48;break}return console.log("Creating Masterfile..."),logToConsole("Creating Masterfile..."),(x=s.workbook.worksheets).load("items/name"),e.next=43,s.sync();case 43:v="Masterfile",x.items.map((function(e){return e.name})).includes(v)||((y=x.add(v)).position=0),y.activate();case 48:i.forEach((function(e){var n=document.createElement("li");n.textContent="".concat(e," (ready)"),n.style.cursor="pointer",n.addEventListener("click",_asyncToGenerator(_regeneratorRuntime().mark((function s(){var u,l;return _regeneratorRuntime().wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return document.querySelectorAll("li").forEach((function(e){e.classList.remove("selected-file")})),n.classList.add("selected-file"),s.next=4,fetch("https://limit-project-demo.onrender.com/process-testtable/?filename=".concat(encodeURIComponent(e)));case 4:if((u=s.sent).ok){s.next=9;break}return document.getElementById("download-links").innerHTML='<p style="color:red;">Failed to process '.concat(e,"</p>"),s.abrupt("return");case 9:return n.textContent=e,s.next=12,u.json();case 12:return displayResults((l=s.sent).files),s.next=16,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var s,u,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P,H,j,W,X,V,q,J,$,z,K,Q,Z,ee,ne,te,re,oe,ae,ce,se,ue,le,ie,fe,de,pe,ge,me,he,ye,xe,ve,be,Ce,we,ke,_e,Ee,Ie,Te,Re,Fe,Ae,Se,Be,Ne,Oe,Le,Ue,Ye,Me,Ge,De,Pe,He,je,We,Xe,Ve,qe,Je,$e,ze;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.body.style.cursor="wait",s=n.workbook.worksheets.getItem("Masterfile"),u=[],i=0;case 4:if(!(i<l.files.length)){e.next=75;break}return(f=s.getUsedRange()).load(["values","rowCount","columnCount"]),e.next=9,n.sync();case 9:return d=f.values[0]||[],p=f.values[1]||[],e.next=13,n.sync();case 13:if("ok"!==(g=l.files[i]).status||!Array.isArray(g.content)){e.next=72;break}if(m=g.content[0],h=g.content[1],0!==i){e.next=57;break}y=0;case 19:if(!(y<m.length)){e.next=34;break}if(x=m[y],v=h[y],u.push({name:x,stage:v}),!x||x===(d[y]||"")){e.next=27;break}return s.getCell(0,y).values=[[x]],e.next=27,n.sync();case 27:if(!v||v===p[y]){e.next=31;break}return s.getCell(1,y).values=[[v]],e.next=31,n.sync();case 31:y++,e.next=19;break;case 34:return f.load(["rowCount","columnCount"]),e.next=37,n.sync();case 37:b=n.workbook.worksheets.getItem("Masterfile"),C=1e3,w=f.rowCount,k=f.columnCount,_=[],E=0;case 43:if(!(E<w)){e.next=53;break}return I=Math.min(C,w-E),(T=b.getRangeByIndexes(E,0,I,k)).load("values"),e.next=49,n.sync();case 49:_=_.concat(T.values);case 50:E+=C,e.next=43;break;case 53:d=_[0],p=_[1],e.next=70;break;case 57:return f.load(["rowCount","columnCount"]),e.next=60,n.sync();case 60:if(NaN!==(R=d.indexOf("Units"))){e.next=63;break}return e.abrupt("return");case 63:F=_regeneratorRuntime().mark((function e(){var t,r,o;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=m[A],r=h[A],"Lsl"!==t&&"Usl"!==t){e.next=20;break}if(void 0!==(o=u.find((function(e){return e.stage===r})))&&""!==o){e.next=20;break}return u.push({name:t,stage:r}),s.getRangeByIndexes(0,R+3,f.rowCount,2).insert(Excel.InsertShiftDirection.right),logToConsole("Insert new column"),e.next=11,n.sync();case 11:return f.load(["rowCount","columnCount"]),e.next=14,n.sync();case 14:return s.getCell(0,R+3).values=[["Lsl"]],s.getCell(0,R+4).values=[["Usl"]],s.getCell(1,R+3).values=r,s.getCell(1,R+4).values=r,e.next=20,n.sync();case 20:case"end":return e.stop()}}),e)})),A=0;case 65:if(!(A<d.length)){e.next=70;break}return e.delegateYield(F(),"t0",67);case 67:A++,e.next=65;break;case 70:return e.next=72,n.sync();case 72:i++,e.next=4;break;case 75:return e.next=77,n.sync();case 77:return(S=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=81,n.sync();case 81:B=n.workbook.worksheets.getItem("Masterfile"),N=1e3,O=S.rowCount,L=S.columnCount,U=[],Y=0;case 87:if(!(Y<O)){e.next=97;break}return M=Math.min(N,O-Y),(G=B.getRangeByIndexes(Y,0,M,L)).load("values"),e.next=93,n.sync();case 93:U=U.concat(G.values);case 94:Y+=N,e.next=87;break;case 97:return D=U[0],P=U[1],H=S.rowCount,e.next=102,n.sync();case 102:return j=[],W=[],X=[],V=[],q=[],J=[],$=[],z=[],K=[],Q=[],Z=[],ee=[],ne=[],(S=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=119,n.sync();case 119:N=1e3,O=S.rowCount,L=S.columnCount,U=[],te=0;case 124:if(!(te<O)){e.next=134;break}return re=Math.min(N,O-te),(oe=B.getRangeByIndexes(te,0,re,L)).load("values"),e.next=130,n.sync();case 130:U=U.concat(oe.values);case 131:te+=N,e.next=124;break;case 134:return D=U[0],P=U[1],e.next=138,n.sync();case 138:if(console.log(P),j=P.filter((function(e){return"w"===e[0]})),W=P.filter((function(e){return"f"===e[0]})),X=P.filter((function(e){return"a"===e[0]})),console.log(j),console.log(W),console.log(X),V=j.filter((function(e){return"h"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("wh",""))-parseInt(n[0].replace("wh",""))})),q=j.filter((function(e){return"r"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("wr",""))-parseInt(n[0].replace("wr",""))})),J=j.filter((function(e){return"c"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("wc",""))-parseInt(n[0].replace("wc",""))})),$=j.filter((function(e){return"i"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("wi",""))-parseInt(n[0].replace("wi",""))})),z=j.filter((function(e){return"w"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("ww",""))-parseInt(n[0].replace("ww",""))})),console.log(V),console.log(q),console.log(J),console.log(z),console.log($),j=[],0!==V.length&&(ae=j).push.apply(ae,_toConsumableArray(V)),0!==q.length&&(ce=j).push.apply(ce,_toConsumableArray(q)),0!==J.length&&(se=j).push.apply(se,_toConsumableArray(J)),0!==z.length&&(ue=j).push.apply(ue,_toConsumableArray(z)),0!==$.length&&(le=j).push.apply(le,_toConsumableArray($)),t.push.apply(t,_toConsumableArray(j)),K=W.filter((function(e){return"h"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("fh",""))-parseInt(n[0].replace("fh",""))})),Q=W.filter((function(e){return"r"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("fr",""))-parseInt(n[0].replace("fr",""))})),Z=W.filter((function(e){return"c"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("fc",""))-parseInt(n[0].replace("fc",""))})),ee=W.filter((function(e){return"i"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("fi",""))-parseInt(n[0].replace("fi",""))})),ne=W.filter((function(e){return"w"===e[1]})).sort((function(e,n){return parseInt(e[0].replace("fw",""))-parseInt(n[0].replace("fw",""))})),console.log(K),console.log(Q),console.log(Z),console.log(ne),console.log(ee),W=[],0!==K.length&&(ie=W).push.apply(ie,_toConsumableArray(K)),0!==Q.length&&(fe=W).push.apply(fe,_toConsumableArray(Q)),0!==Z.length&&(de=W).push.apply(de,_toConsumableArray(Z)),0!==ne.length&&(pe=W).push.apply(pe,_toConsumableArray(ne)),0!==ee.length&&(ge=W).push.apply(ge,_toConsumableArray(ee)),t.push.apply(t,_toConsumableArray(W)),t.push.apply(t,_toConsumableArray(X)),me=V.filter((function(e,n){return n%2==0})),he=q.filter((function(e,n){return n%2==0})),ye=J.filter((function(e,n){return n%2==0})),xe=$.filter((function(e,n){return n%2==0})),ve=z.filter((function(e,n){return n%2==0})),be=K.filter((function(e,n){return n%2==0})),Ce=Q.filter((function(e,n){return n%2==0})),we=Z.filter((function(e,n){return n%2==0})),ke=ee.filter((function(e,n){return n%2==0})),_e=ne.filter((function(e,n){return n%2==0})),Ee=X.filter((function(e,n){return n%2==0})),Ie=[],me.forEach((function(e){be.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),he.forEach((function(e){Ce.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),ye.forEach((function(e){we.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),xe.forEach((function(e){ke.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),ve.forEach((function(e){_e.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),Ce.forEach((function(e){Ee.forEach((function(n){var t="".concat(e,"__").concat(n),r="".concat(e," ? ").concat(n);Ie.push({id:t,label:r})}))})),me.forEach((function(e,n){me.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),he.forEach((function(e,n){he.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),ye.forEach((function(e,n){ye.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),xe.forEach((function(e,n){xe.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),ve.forEach((function(e,n){ve.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),be.forEach((function(e,n){be.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),Ce.forEach((function(e,n){Ce.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),we.forEach((function(e,n){we.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),ke.forEach((function(e,n){ke.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),_e.forEach((function(e,n){_e.forEach((function(t,r){if(n<r){var o="".concat(e,"__").concat(t),a="".concat(e," ? ").concat(t);Ie.push({id:o,label:a})}}))})),console.log(Ie),Ie.forEach((function(e){var n=document.createElement("label");n.className="label-item";var t=document.createElement("input");t.type="checkbox",t.id=e.id,t.name="stagePair",t.value=e.id,n.appendChild(t),n.appendChild(document.createTextNode(" ".concat(e.label))),labelList.appendChild(n);var c=e.label.slice(0,3),s=e.label.slice(-3);o.push.apply(o,[c]),a.push.apply(a,[s]);var u=["LL "+c.toUpperCase()+" ? "+s.toUpperCase(),"UL "+c.toUpperCase()+" ? "+s.toUpperCase()];r.push.apply(r,u)})),console.log("Allpair: ",r),Te=P.indexOf("Spec"),!isNaN(Te)){e.next=215;break}return logToConsole("Can't find Spec column!"),e.abrupt("return");case 215:return s.getRangeByIndexes(1,Te+2,1,t.length).values=[t],e.next=219,n.sync();case 219:return(S=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=223,n.sync();case 223:N=1e3,O=S.rowCount,L=S.columnCount,U=[],Re=0;case 228:if(!(Re<O)){e.next=238;break}return Fe=Math.min(N,O-Re),(Ae=B.getRangeByIndexes(Re,0,Fe,L)).load("values"),e.next=234,n.sync();case 234:U=U.concat(Ae.values);case 235:Re+=N,e.next=228;break;case 238:return D=U[0],P=U[1],H=S.rowCount,e.next=243,n.sync();case 243:Se=_createForOfIteratorHelper(l.files),e.prev=244,Se.s();case 246:if((Be=Se.n()).done){e.next=287;break}if("ok"!==(Ne=Be.value).status||!Array.isArray(Ne.content)){e.next=285;break}Oe=Ne.content[0],Le=Ne.content[1],Ue=2;case 252:if(!(Ue<Ne.content.length)){e.next=285;break}Ye=Ne.content[Ue],Me=[],Ge=0;case 256:if(!(Ge<D.length)){e.next=279;break}if("Lsl"!==(De=D[Ge])&&"Usl"!==De){e.next=273;break}if(Pe=P[Ge],"Lsl"!==De){e.next=267;break}if(NaN!==(He=Le.indexOf(Pe))){e.next=264;break}return e.abrupt("continue",276);case 264:Me.push(-1!==He?Ye[He]:""),e.next=271;break;case 267:if(NaN!==(je=Le.indexOf(Pe))){e.next=270;break}return e.abrupt("continue",276);case 270:Me.push(-1!==je?Ye[je+1]:"");case 271:e.next=276;break;case 273:We=D.indexOf(De),Xe=Oe.indexOf(De),-1!==We&&-1!==Xe&&(Me[We]=Ye[Xe]);case 276:Ge++,e.next=256;break;case 279:s.getRangeByIndexes(H,0,1,D.length).values=[Me],H++;case 282:Ue++,e.next=252;break;case 285:e.next=246;break;case 287:e.next=292;break;case 289:e.prev=289,e.t1=e.catch(244),Se.e(e.t1);case 292:return e.prev=292,Se.f(),e.finish(292);case 295:return e.next=297,n.sync();case 297:return(S=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=301,n.sync();case 301:N=1e3,O=S.rowCount,L=S.columnCount,U=[],Ve=0;case 306:if(!(Ve<O)){e.next=316;break}return qe=Math.min(N,O-Ve),(Je=B.getRangeByIndexes(Ve,0,qe,L)).load("values"),e.next=312,n.sync();case 312:U=U.concat(Je.values);case 313:Ve+=N,e.next=306;break;case 316:return D=U[0],P=U[1],H=S.rowCount,$e=D.indexOf("Bin_s_num"),e.next=322,n.sync();case 322:return s.getRangeByIndexes(0,$e,S.rowCount,2).insert(Excel.InsertShiftDirection.right),e.next=325,n.sync();case 325:return s.getCell(0,$e).values=[["All LL ? Spec"]],s.getCell(0,$e+1).values=[["All UL ? Spec"]],S.load(["rowCount","columnCount"]),e.next=330,n.sync();case 330:return s.getRangeByIndexes(0,$e+2,S.rowCount,t.length).insert(Excel.InsertShiftDirection.right),S.load(["rowCount","columnCount"]),e.next=334,n.sync();case 334:for(ze=Te+2;ze<Te+2+t.length;ze+=2)c.push.apply(c,["LL Spec? "+P[ze],"UL Spec? "+P[ze]]);return console.log(c),console.log("limit_compare contains undefined?",c.includes(void 0)),console.log("limit_compare contains null?",c.includes(null)),s.getRangeByIndexes(0,$e+2,1,c.length).values=[c],e.next=341,n.sync();case 341:document.body.style.cursor="default";case 342:case"end":return e.stop()}}),e,null,[[244,289,292,295]])})));return function(n){return e.apply(this,arguments)}}());case 16:return s.next=18,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var r,o,a,c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P,H,j,W,X,V,q,J;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.sync();case 2:return e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:return document.body.style.cursor="wait",r=n.workbook.worksheets.getItem("Masterfile"),(o=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,n.sync();case 10:a=n.workbook.worksheets.getItem("Masterfile"),c=1e3,s=o.rowCount,u=o.columnCount,l=[],i=0;case 16:if(!(i<s)){e.next=26;break}return f=Math.min(c,s-i),(d=a.getRangeByIndexes(i,0,f,u)).load("values"),e.next=22,n.sync();case 22:l=l.concat(d.values);case 23:i+=c,e.next=16;break;case 26:for(p=l[0],g=l[1],m=l,h=o.rowCount,o.columnCount,y=g.indexOf("Spec"),x=p.indexOf("All LL ? Spec"),v=p.indexOf("All UL ? Spec"),b=y+t.length+2,C=[],w=2;w<m.length;w++){for(k=[],_=y;_<=b;_++)k.push(m[w][_]);C.push(k)}E=p.indexOf("All UL ? Spec")+1,I=[],T=[],R=[],F=0;case 42:if(!(F<C.length)){e.next=70;break}A=C[F],S=A[0],B=A[1],N="In-spec",O="In-spec",R[F]=[],L=2;case 50:if(!(L+1<A.length)){e.next=65;break}if(U=A[L],Y=A[L+1],void 0!==U&&void 0!==Y){e.next=56;break}return console.warn("Missing LSL/USL at row ".concat(F,", columns ").concat(L," and ").concat(L+1)),e.abrupt("continue",62);case 56:M="",G="",""===U||null==U||isNaN(U)||(U>=S?M=S<U?"Widen":"Same":(N="Out-spec",M="Tighten")),""===Y||null==Y||isNaN(Y)||(Y<=B?G=B>Y?"Widen":"Same":(O="Out-spec",G="Tighten")),R[F].push(M),R[F].push(G);case 62:L+=2,e.next=50;break;case 65:I.push([N]),T.push([O]);case 67:F++,e.next=42;break;case 70:return r.getRangeByIndexes(2,E,R.length,R[0].length).values=R,e.next=73,n.sync();case 73:return D=r.getRangeByIndexes(2,x,I.length,1),P=r.getRangeByIndexes(2,v,T.length,1),D.values=I,P.values=T,e.next=79,n.sync();case 79:return r.getRangeByIndexes(0,3,h,2).insert(Excel.InsertShiftDirection.right),r.getCell(0,3).values="Is used (Y/N)",r.getCell(0,4).values="Can remove (Y/N)",e.next=85,n.sync();case 85:for(logToConsole("Limit Compare Successfully"),H=["Out-spec","In-spec"],j=["#ff9c9c","#C6EFCE"],W=0;W<H.length;W++)X=H[W],V=j[W],(q=D.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=V,q.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:X},(J=P.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=V,J.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:X};return e.next=91,n.sync();case 91:document.body.style.cursor="default";case 92:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 18:return s.next=20,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){var s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,n.sync();case 3:return s=n.workbook.worksheets.getItem("Masterfile"),e.next=6,n.sync();case 6:return(u=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,n.sync();case 10:l=n.workbook.worksheets.getItem("Masterfile"),i=1e3,f=u.rowCount,d=u.columnCount,p=[],g=0;case 16:if(!(g<f)){e.next=26;break}return m=Math.min(i,f-g),(h=l.getRangeByIndexes(g,0,m,d)).load("values"),e.next=22,n.sync();case 22:p=p.concat(h.values);case 23:g+=i,e.next=16;break;case 26:return y=p[0],x=p[1],e.next=30,n.sync();case 30:return v=y.indexOf("Bin_s_num"),s.getRangeByIndexes(0,v,u.rowCount,r.length).insert(Excel.InsertShiftDirection.right),s.getRangeByIndexes(0,v,1,r.length).values=[r],e.next=35,n.sync();case 35:for(b=x.indexOf("Spec"),C=b+t.length+2,w=[],k=2;k<p.length;k++){for(_=[],E=b;E<=C;E++)_.push(p[k][E]);w.push(_)}I=[],T=0;case 41:if(!(T<o.length)){e.next=53;break}if(R=o[T],F=a[T],A=x.indexOf(R),S=x.indexOf(F),!(A<0||S<0)){e.next=49;break}return console.warn("ไม่พบ stage: ".concat(R," หรือ ").concat(F)),e.abrupt("continue",50);case 49:for(B=0;B<w.length;B++)N=w[B],O=N[A-b],L=N[A-b+1],U=N[S-b],Y=N[S-b+1],M="",G="",""===O||null==O||isNaN(O)||""===U||null==U||isNaN(U)||(M=O<U?"Widen":O>U?"Tighten":"Same"),""===L||null==L||isNaN(L)||""===Y||null==Y||isNaN(Y)||(G=L>Y?"Widen":L<Y?"Tighten":"Same"),I[B]||(I[B]=[]),I[B].push(M),I[B].push(G);case 50:T++,e.next=41;break;case 53:if(console.log("All compare:",I),D=y.indexOf(c[c.length-1]),console.log(D),!(D<0)){e.next=58;break}return e.abrupt("return");case 58:return s.getRangeByIndexes(2,D+1,I.length,I[0].length).values=I,e.next=61,n.sync();case 61:return u.load("columnCount"),e.next=64,n.sync();case 64:for(P=0;P<u.columnCount;P++)s.getCell(0,P).format.fill.color="#c4d4f3";return e.next=67,n.sync();case 67:document.body.style.cursor="default";case 68:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 20:return s.next=22,Excel.run(function(){var n=_asyncToGenerator(_regeneratorRuntime().mark((function n(t){var r,o,a;return _regeneratorRuntime().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return document.body.style.cursor="wait",r=t.workbook.worksheets.getItem("InputFiles"),(o=r.getUsedRange()).load("rowCount"),n.next=6,t.sync();case 6:return a=o.rowCount,r.getRangeByIndexes(a,0,1,1).values=[[e]],n.next=11,t.sync();case 11:logToConsole("Successfully limit files imported"),document.body.style.cursor="default";case 13:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}());case 22:case"end":return s.stop()}}),s)})))),f.appendChild(n)})),document.body.style.cursor="default";case 50:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),_importFolder.apply(this,arguments)}function displayResults(e){document.body.style.cursor="wait";var n=document.getElementById("download-links");n.innerHTML="";var t=3;e.forEach((function(e){var r,o=((null===(r=e.content)||void 0===r?void 0:r.length)||0)-3+t,a=document.createElement("div");a.innerHTML="\n      <p><b>".concat(e.path,"</b> - ").concat(e.status," (").concat(t,"-").concat(o,")</p>\n    "),n.appendChild(a),t=o+1})),document.body.style.cursor="default"}function logToConsole(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),r=1;r<n;r++)t[r-1]=arguments[r];var o=document.getElementById("consoleOutput"),a=(new Date).toLocaleString(),c=e,s=0;c=c.replace(/%[sdif]/g,(function(e){var n=t[s++];switch(e){case"%d":case"%i":return parseInt(n);case"%f":return parseFloat(n).toFixed(2);default:return String(n)}}));var u=document.createElement("div");u.textContent="[".concat(a,"] > ").concat(c),o.appendChild(u),o.scrollTop=o.scrollHeight}function checkboxHide(e,n){return _checkboxHide.apply(this,arguments)}function _checkboxHide(){return _checkboxHide=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(r){var o,a,c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",r.workbook.worksheets.load("items/name"),e.next=5,r.sync();case 5:return o=r.workbook.worksheets.getItem("Masterfile"),a=o.getUsedRange(),e.next=9,r.sync();case 9:return a.load(["rowCount","columnCount"]),e.next=12,r.sync();case 12:console.log(a.rowCount),c=1e3,s=a.rowCount,u=a.columnCount,l=[],i=0;case 18:if(!(i<s)){e.next=28;break}return f=Math.min(c,s-i),(d=o.getRangeByIndexes(i,0,f,u)).load("values"),e.next=24,r.sync();case 24:l=l.concat(d.values);case 25:i+=c,e.next=18;break;case 28:p=l[0],h=_createForOfIteratorHelper(n),e.prev=30,h.s();case 32:if((y=h.n()).done){e.next=57;break}if(x=y.value,v=x.slice(0,3),b=x.slice(-3),g="LL "+v.toUpperCase()+" ? "+b.toUpperCase(),console.log(g),-1!==(m=p.indexOf(g))){e.next=42;break}return logToConsole("Can't find an index"),e.abrupt("return");case 42:return logToConsole("Hiding : %s ? %s",v.toUpperCase(),b.toUpperCase()),e.prev=43,o.getRangeByIndexes(0,m-2,a.rowCount,1).getEntireColumn().columnHidden=!0,o.getRangeByIndexes(0,m-1,a.rowCount,1).getEntireColumn().columnHidden=!0,o.getRangeByIndexes(0,m,a.rowCount,1).getEntireColumn().columnHidden=!0,o.getRangeByIndexes(0,m+1,a.rowCount,1).getEntireColumn().columnHidden=!0,e.next=50,r.sync();case 50:e.next=55;break;case 52:e.prev=52,e.t0=e.catch(43),console.log("Can't hide col due to: ",e.t0);case 55:e.next=32;break;case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(30),h.e(e.t1);case 62:return e.prev=62,h.f(),e.finish(62);case 65:return e.next=67,r.sync();case 67:C=_createForOfIteratorHelper(t),e.prev=68,C.s();case 70:if((w=C.n()).done){e.next=95;break}if(k=w.value,_=k.slice(0,3),E=k.slice(-3),g="LL "+_.toUpperCase()+" ? "+E.toUpperCase(),-1!==(m=p.indexOf(g))){e.next=79;break}return logToConsole("Can't find an index"),e.abrupt("return");case 79:return e.prev=79,o.getRangeByIndexes(0,m-2,a.rowCount,1).getEntireColumn().columnHidden=!1,o.getRangeByIndexes(0,m-1,a.rowCount,1).getEntireColumn().columnHidden=!1,o.getRangeByIndexes(0,m,a.rowCount,1).getEntireColumn().columnHidden=!1,o.getRangeByIndexes(0,m+1,a.rowCount,1).getEntireColumn().columnHidden=!1,e.next=86,r.sync();case 86:e.next=91;break;case 88:e.prev=88,e.t2=e.catch(79),console.log("Can't show col due to: ",e.t2);case 91:return e.next=93,r.sync();case 93:e.next=70;break;case 95:e.next=100;break;case 97:e.prev=97,e.t3=e.catch(68),C.e(e.t3);case 100:return e.prev=100,C.f(),e.finish(100);case 103:document.body.style.cursor="default";case 104:case"end":return e.stop()}}),e,null,[[30,59,62,65],[43,52],[68,97,100,103],[79,88]])})));return function(n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_checkboxHide.apply(this,arguments)}function Check_product_stage(e,n){return _Check_product_stage.apply(this,arguments)}function _Check_product_stage(){return _Check_product_stage=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,t){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("productName in Check_product_stage: ",n),console.log("stagename in Check_product_stage: ",t),e.next=4,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(r){var o,a,c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o=r.workbook.worksheets.getItem("Masterfile"),(a=o.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,r.sync();case 6:c=r.workbook.worksheets.getItem("Masterfile"),s=1e3,u=a.rowCount,l=a.columnCount,i=[],f=0;case 12:if(!(f<u)){e.next=22;break}return d=Math.min(s,u-f),(p=c.getRangeByIndexes(f,0,d,l)).load("values"),e.next=18,r.sync();case 18:i=i.concat(p.values);case 19:f+=s,e.next=12;break;case 22:for(g=i[0],console.log("headers: ",g),m=g.indexOf(n),console.log("productColINdex before add product name or stage: %d",m),h=[],v=0;v<=g.length;v++)"Can remove (Y/N)"===g[v]&&(y=v),"Lsl_typ"===g[v]&&(x=v);if(x-y-1>0)for(C=y+1;C<x;C++)w=g[C],k=i[1][C],w&&""!==w.trim()?(h.push({name:w.trim(),stage:k}),b=w.trim()):h.push({name:b,stage:k});if(-1!==m){e.next=55;break}if((_=r.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(E=_.getRange("F1:F1")).values=[[n]],!((I=g.indexOf("Can remove (Y/N)"))<0)){e.next=40;break}return logToConsole("Can't find 'Can remove' column"),e.abrupt("return");case 40:if(!((T=g.indexOf("Lsl_typ"))<0)){e.next=44;break}return logToConsole("Can't find 'Lsl_typ' column"),e.abrupt("return");case 44:for(R=0,F=I;F<T;F++)A=a.getCell(0,F),isNaN(A)&&""===A||R++;return S=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][R%4],E.format.fill.color=S,_.getRange("F2:F2").values=[[t]],e.next=53,r.sync();case 53:e.next=81;break;case 55:return B=r.workbook.worksheets.getItem("Masterfile"),e.next=58,r.sync();case 58:return N=m,O=h.filter((function(e){return e.name===n})).length,console.log("product :  %s , stage count : %d",n,O),B.getRangeByIndexes(0,N+1,1,1).insert(Excel.InsertShiftDirection.right),(a=B.getUsedRange()).load("rowCount"),e.next=67,r.sync();case 67:return L=a.rowCount,B.getRangeByIndexes(1,N+O,L,1).insert(Excel.InsertShiftDirection.right),a=B.getUsedRange(),e.next=73,r.sync();case 73:return B.getCell(1,N+O).values=[[t]],console.log("startcol for merge: %d stagecount for merge: %d",N,O),(U=B.getRangeByIndexes(0,N,1,O)).values=Array(1).fill(Array(O).fill(n)),U.merge(),e.next=81,r.sync();case 81:document.body.style.cursor="default";case 82:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),_Check_product_stage.apply(this,arguments)}function WriteNewtest(e){return _WriteNewtest.apply(this,arguments)}function _WriteNewtest(){return _WriteNewtest=_asyncToGenerator(_regeneratorRuntime().mark((function e(n){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("data from EY oneproduct: ",n),e.next=3,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(t){var r,o,a,c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",r=t.workbook.worksheets.getItem("Masterfile"),(o=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,t.sync();case 6:a=1e3,c=o.rowCount,s=o.columnCount,u=[],l=0;case 11:if(!(l<c)){e.next=21;break}return i=Math.min(a,c-l),(f=r.getRangeByIndexes(l,0,i,s)).load("values"),e.next=17,t.sync();case 17:u=u.concat(f.values);case 18:l+=a,e.next=11;break;case 21:if(d=u[0],p=d.indexOf("Test number"),g=d.indexOf("Suite name"),m=d.indexOf("Test name"),-1!==p){e.next=29;break}return console.error("Can't find Test number column"),logToConsole("Can't find Test number column"),e.abrupt("return");case 29:if(-1!==g){e.next=33;break}return console.error("Can't find Suite name column"),logToConsole("Can't find Suite name column"),e.abrupt("return");case 33:if(-1!==m){e.next=37;break}return console.error("Can't find Test name column"),logToConsole("Can't find Test name column"),e.abrupt("return");case 37:return(h=r.getRangeByIndexes(2,m,u.length-2,1)).load("values"),e.next=41,t.sync();case 41:y=[],e.prev=42,y=h.values.flat().filter((function(e){return""!==e})),e.next=50;break;case 46:return e.prev=46,e.t0=e.catch(42),console.error("Error while processing testNameRange.values:",e.t0),e.abrupt("return");case 50:if(Array.isArray(n)){e.next=53;break}return console.error("data isn't an array or isn't loaded"),e.abrupt("return");case 53:x=[],e.prev=54,x=n.filter((function(e){return!y.includes(e.test_name)})),console.log("newTests from EY: ",x),e.next=63;break;case 59:return e.prev=59,e.t1=e.catch(54),console.error("Error while data.filter",e.t1),e.abrupt("return");case 63:if(Array.isArray(u)){e.next=66;break}return console.error("allValues isn't an array"),e.abrupt("return");case 66:if(v=u.length,w=[],k=[],!(x.length>0)){e.next=88;break}if(_=x.map((function(e){var n;return[null!==(n=null==e?void 0:e.test_number)&&void 0!==n?n:""]})),-1!==p){e.next=74;break}return logToConsole("Can't find Test number column"),e.abrupt("return");case 74:return r.getRangeByIndexes(v,p,x.length,1).values=_,e.next=78,t.sync();case 78:return b=r.getRangeByIndexes(v,g,x.length,1),C=r.getRangeByIndexes(v,m,x.length,1),w=x.map((function(e){return[e.suite_name]})),k=x.map((function(e){return[e.test_name]})),b.values=w,C.values=k,e.next=86,t.sync();case 86:e.next=89;break;case 88:logToConsole("There's no new test");case 89:document.body.style.cursor="default";case 90:case"end":return e.stop()}}),e,null,[[42,46],[54,59]])})));return function(n){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),_WriteNewtest.apply(this,arguments)}function YN(e,n,t){return _YN.apply(this,arguments)}function _YN(){return _YN=_asyncToGenerator(_regeneratorRuntime().mark((function e(n,t,r){return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function e(o){var a,c,s,u,l,i,f,d,p,g,m,h,y,x,v,b,C,w,k,_,E,I,T,R,F,A,S,B,N,O,L,U,Y,M,G,D,P,H,j,W,X,V;return _regeneratorRuntime().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",a=o.workbook.worksheets.getItem("Masterfile"),(c=a.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,o.sync();case 6:s=1e3,u=c.rowCount,l=c.columnCount,i=[],f=0;case 11:if(!(f<u)){e.next=21;break}return d=Math.min(s,u-f),(p=a.getRangeByIndexes(f,0,d,l)).load("values"),e.next=17,o.sync();case 17:i=i.concat(p.values);case 18:f+=s,e.next=11;break;case 21:for(g=i[0],m=[],x=0;x<=g.length;x++)"Can remove (Y/N)"===g[x]&&(h=x),"Lsl_typ"===g[x]&&(y=x);if(y-h-1>0)for(b=h+1;b<y;b++)C=g[b],w=i[1][b],C&&""!==C.trim()?(m.push({name:C.trim(),stage:w}),v=C.trim()):m.push({name:v,stage:w});if(k=g.indexOf("Test number"),_=g.indexOf("Suite name"),E=g.indexOf("Test name"),-1!==k){e.next=33;break}return console.error("Test number column is not found"),logToConsole("Test number column is not found"),e.abrupt("return");case 33:if(-1!==_){e.next=37;break}return console.error("Suite name column is not found"),logToConsole("Suite name column is not found"),e.abrupt("return");case 37:if(-1!==E){e.next=41;break}return console.error("Test name column is not found"),logToConsole("Test name column is not found"),e.abrupt("return");case 41:if(-1!==(I=g.indexOf(t))){e.next=46;break}return console.error("Can't find %s column",t),logToConsole("Can't find %s column",t),e.abrupt("return");case 46:return T=m.filter((function(e){return e.name===t})).length,(F=a.getRangeByIndexes(1,I,1,T)).load("values"),e.next=51,o.sync();case 51:A=0;case 52:if(!(A<=T)){e.next=60;break}if(console.log("stage %d = %s",A,F.values[0][A]),F.values[0][A]!==r){e.next=57;break}return R=A,e.abrupt("break",60);case 57:A++,e.next=52;break;case 60:return void 0===R&&(console.error("Can't find:",r),logToConsole("Can't find:",r)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",I,T,R),(S=a.getRangeByIndexes(2,E,i.length-2,1)).load("values"),e.next=66,o.sync();case 66:B=S.values.map((function(e){return e[0]})),N=[];try{N=B.map((function(e){var t=n.find((function(n){return n.test_name===e}));return[t?t.YN_check:""]}))}catch(e){console.error("Error while processing YNValues:",e),logToConsole("Error while processing YNValues: %s",e.message||e)}return(O=a.getRangeByIndexes(2,I+R,N.length,1)).load("values"),e.next=73,o.sync();case 73:return 0===N.length?(console.warn("There's no Y/N check data"),logToConsole("There's no Y/N check data")):console.log("YN.length of %s %s is %d",t,r,N.length),O.values=N,e.next=77,o.sync();case 77:return L=g.indexOf("Is used (Y/N)"),(U=a.getRangeByIndexes(2,L,O.values.length,1)).load("values"),e.next=82,o.sync();case 82:for(Y=U.values,Array.isArray(Y)&&0!==Y.length||(Y=Array.from({length:O.values.length},(function(){return[""]}))),M=0;M<O.values.length;M++)"Y"===O.values[M][0]?"Partial"===Y[M][0]||"No"===Y[M][0]?Y[M][0]="Partial":""===Y[M][0]&&(Y[M][0]="All"):"All"===Y[M][0]||"Partial"===Y[M][0]?Y[M][0]="Partial":Y[M][0]="No";return U.values=Y,e.next=88,o.sync();case 88:return(G=O.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",G.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},U.conditionalFormats.load("count"),e.next=94,o.sync();case 94:for(D=U.conditionalFormats.count-1;D>=0;D--)U.conditionalFormats.getItemAt(D).delete();return e.next=97,o.sync();case 97:for(P=["Partial","All"],H=["#FFEB9C","#C6EFCE"],j=0;j<P.length;j++)W=P[j],X=H[j],(V=U.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=X,V.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:W};return e.next=102,o.sync();case 102:document.body.style.cursor="default";case 103:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_YN.apply(this,arguments)}