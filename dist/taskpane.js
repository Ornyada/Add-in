/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"eeac5570cbbfdfdbdf0d.css"},60947:function(e,t,n){e.exports=n.p+"53af1a76da26915c8863.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){n=function(){return r};var t,r={},a=Object.prototype,o=a.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",i=c.toStringTag||"@@toStringTag";function l(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(e,t,n){return e[t]=n}}function f(e,n,r,a){var o=n&&n.prototype instanceof h?n:h,c=Object.create(o.prototype);return l(c,"_invoke",function(e,n,r){var a=1;return function(o,c){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===o)throw c;return{value:t,done:!0}}for(r.method=o,r.arg=c;;){var s=r.delegate;if(s){var u=C(s,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var i=d(e,n,r);if("normal"===i.type){if(a=r.done?4:2,i.arg===p)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(a=4,r.method="throw",r.arg=i.arg)}}}(e,r,new R(a||[])),!0),c}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var p={};function h(){}function g(){}function m(){}var x={};l(x,s,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(B([])));v&&v!==a&&o.call(v,s)&&(x=v);var b=m.prototype=h.prototype=Object.create(x);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(t,n){function r(a,c,s,u){var i=d(t[a],t,c);if("throw"!==i.type){var l=i.arg,f=l.value;return f&&"object"==e(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(i.arg)}var a;l(this,"_invoke",(function(e,t){function o(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(o,o):o()}),!0)}function C(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=d(a,e.i,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,p;var c=o.arg;return c?c.done?(n[e.r]=c.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function E(e){this.tryEntries.push(e)}function I(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function R(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function B(n){if(null!=n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function e(){for(;++a<n.length;)if(o.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return g.prototype=m,l(b,"constructor",m),l(m,"constructor",g),g.displayName=l(m,i,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},r.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var c=new k(f(e,t,n,a),o);return r.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},w(b),l(b,i,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},r.values=B,R.prototype={constructor:R,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){c.type="throw",c.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],c=o[4],s=this.prev,u=o[1],i=o[2];if(-1===o[0])return r("end"),!1;if(!u&&!i)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=s){if(s<u)return this.method="next",this.arg=t,r(u),!0;if(s<i)return r(i),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===e||"continue"===e)&&a[0]<=t&&t<=a[2]&&(a=null);var o=a?a[4]:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a[2],p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),I(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var a=r.arg;I(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:B(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},r}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,c=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw c}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,a,o,c){try{var s=e[o](c),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){c(o,r,a,s,u,"next",e)}function u(e){c(o,r,a,s,u,"throw",e)}s(void 0)}))}}function u(){return i.apply(this,arguments)}function i(){return(i=s(n().mark((function e(){var t,r,a,o,c,s,u,i,l,f,d,p,h,g;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,document.body.style.cursor="wait",t=document.getElementById("stdfInput"),r=t.files,a=Array.from(r),r&&0!==r.length){e.next=7;break}return e.abrupt("return");case 7:console.log("File Amount : %d",a.length),v("File Amount : %d",a.length),o=0,c=a;case 10:if(!(o<c.length)){e.next=53;break}if(!(s=c[o]).name.toLowerCase().endsWith(".stdf")){e.next=48;break}if(u=new FormData,s){e.next=18;break}return console.warn("No file"),e.abrupt("return");case 18:return u.append("files",s),console.log("Processing : ".concat(s.name)),v("Processing : ".concat(s.name)),document.body.style.cursor="wait",e.next=24,fetch("https://limit-project-demo.onrender.com/upload-stdf/",{method:"POST",body:u});case 24:if((i=e.sent).ok){e.next=32;break}return e.next=28,i.text();case 28:return l=e.sent,console.error("STDF upload failed:",l),v("STDF upload failed:",l),e.abrupt("return");case 32:return e.next=34,i.blob();case 34:f=e.sent,d=window.URL.createObjectURL(f),p=s.name.replace(/\.[^/.]+$/,""),h="".concat(p,".xlsx"),(g=document.createElement("a")).href=d,g.download=h,document.body.appendChild(g),g.click(),g.remove(),window.URL.revokeObjectURL(d),v("Successfully converted and downloaded STDF"),e.next=50;break;case 48:console.warn("Doesn't support ".concat(s.name)),v("Doesn't support ".concat(s.name));case 50:o++,e.next=10;break;case 53:e.next=59;break;case 55:e.prev=55,e.t0=e.catch(0),console.error("Error while processing file: ".concat(file.name),err),v("Error while processing file: ".concat(file.name));case 59:return e.prev=59,document.body.style.cursor="default",e.finish(59);case 62:case"end":return e.stop()}}),e,null,[[0,55,59,62]])})))).apply(this,arguments)}function l(){return f.apply(this,arguments)}function f(){return f=s(n().mark((function e(){var t,r,a,o,c,u,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.body.style.cursor="wait",t=document.getElementById("fileInput"),r=t.files,a=Array.from(r),r&&0!==r.length){e.next=6;break}return e.abrupt("return");case 6:console.log("File Amount : %d",a.length),v("File Amount : %d",a.length),o=0,c=n().mark((function e(){var t,r,a,c,l,f;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=i[u],r=t.name.toLowerCase().endsWith(".csv"),a=t.name.toLowerCase().endsWith(".xlsx"),e.prev=3,r||a?(console.log("Processing : ".concat(t.name)),v("Processing : ".concat(t.name)),(c=new FileReader).onload=function(){var e=s(n().mark((function e(r){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Uint8Array(r.target.result),!(XLSX.read(a,{type:"array"}).SheetNames.length>1)){e.next=10;break}return e.next=6,d(t,o);case 6:v("Processed file = %d",o=e.sent),e.next=15;break;case 10:return v("EY datalog is importing"),e.next=13,h(t,o);case 13:v("Processed file = %d",o=e.sent);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c.readAsArrayBuffer(t),(l=document.getElementById("importedFilesList"))&&((f=document.createElement("li")).textContent="".concat(t.name," - ").concat(t.webkitRelativePath||t.name),l.appendChild(f))):(console.warn("Doesn't support ".concat(t.name)),v("Doesn't support ".concat(t.name))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(3),console.error("Error while processing file: ".concat(t.name),e.t0),v("Error while processing file: ".concat(t.name));case 11:return e.prev=11,e.next=14,Excel.run(function(){var e=s(n().mark((function e(r){var a,o,c,s,u,i,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=r.workbook.worksheets).load("items/name"),e.next=4,r.sync();case 4:return o="InputFiles",a.items.map((function(e){return e.name})).includes(o)?c=a.getItem(o):(c=a.add(o),s=["File_Name"],(u=c.getRangeByIndexes(0,0,1,s.length)).values=[s],u.format.fill.color="#C6EFCE",u.format.font.bold=!0,c.position=0),(i=c.getUsedRange()).load("rowCount"),e.next=11,r.sync();case 11:return l=i.rowCount,c.getRangeByIndexes(l,0,1,1).values=[[t.name]],e.next=16,r.sync();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 14:return e.finish(11);case 15:case"end":return e.stop()}}),e,null,[[3,7,11,15]])})),u=0,i=a;case 11:if(!(u<i.length)){e.next=16;break}return e.delegateYield(c(),"t0",13);case 13:u++,e.next=11;break;case 16:document.body.style.cursor="default";case 17:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.abrupt("return",new Promise((function(e,a){var o=new FileReader;o.onload=function(a){var o=new FormData;o.append("file",t);var c=new Uint8Array(a.target.result),u=XLSX.read(c,{type:"array"}).Sheets.mir;Excel.run(function(){var t=s(n().mark((function t(c){var i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H,X,G,W,V,$;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=c.workbook.worksheets.getItem("Masterfile"),(d=f.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:p=c.workbook.worksheets.getItem("Masterfile"),h=1e3,g=d.rowCount,m=d.columnCount,x=[],y=0;case 11:if(!(y<g)){t.next=21;break}return b=Math.min(h,g-y),(w=p.getRangeByIndexes(y,0,b,m)).load("values"),t.next=17,c.sync();case 17:x=x.concat(w.values);case 18:y+=h,t.next=11;break;case 21:for(k=x[0],console.log("headers: ",k),C=XLSX.utils.sheet_to_json(u,{defval:""}),E=null===(i=C[0])||void 0===i||null===(i=i.JOB_NAM)||void 0===i?void 0:i.trim(),I=null===(l=C[0])||void 0===l||null===(l=l.TEST_COD)||void 0===l?void 0:l.trim(),R=k.indexOf(E),console.log("productColINdex before add product name or stage: %d",R),B=[],F=0;F<=k.length;F++)"Can remove (Y/N)"===k[F]&&(_=F),"Lsl_typ"===k[F]&&(S=F);if(S-_-1>0)for(T=_+1;T<S;T++)O=k[T],N=x[1][T],O&&""!==O.trim()?(B.push({name:O.trim(),stage:N}),A=O.trim()):B.push({name:A,stage:N});if(-1!==R){t.next=57;break}if((L=c.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(U=L.getRange("F1:F1")).values=[[E]],!((M=k.indexOf("Can remove (Y/N)"))<0)){t.next=42;break}return v("Can't find 'Can remove' col"),t.abrupt("return");case 42:if(!((P=k.indexOf("Lsl_typ"))<0)){t.next=46;break}return v("Can't find 'Lsl_typ' col"),t.abrupt("return");case 46:for(Y=0,j=M;j<P;j++)D=d.getCell(0,j),isNaN(D)&&""===D||Y++;return H=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][Y%4],U.format.fill.color=H,L.getRange("F2:F2").values=[[I]],t.next=55,c.sync();case 55:t.next=83;break;case 57:return X=c.workbook.worksheets.getItem("Masterfile"),t.next=60,c.sync();case 60:return G=R,W=B.filter((function(e){return e.name===E})).length,console.log("product : %s , stage count : %d stage",E,W),X.getRangeByIndexes(0,G+1,1,1).insert(Excel.InsertShiftDirection.right),(d=X.getUsedRange()).load("rowCount"),t.next=69,c.sync();case 69:return V=d.rowCount,X.getRangeByIndexes(1,G+W,V,1).insert(Excel.InsertShiftDirection.right),d=X.getUsedRange(),t.next=75,c.sync();case 75:return X.getCell(1,G+W).values=[[I]],console.log("startcol for merge: %d stagecount for merge: %d",G,W),($=X.getRangeByIndexes(0,G,1,W)).values=Array(1).fill(Array(W).fill(E)),$.merge(),t.next=83,c.sync();case 83:return d=f.getUsedRange(),t.next=86,c.sync();case 86:return f.activate(),console.log("Completely added product name and stage"),v("Completely added product name and stage"),t.abrupt("return",fetch("https://limit-project-demo.onrender.com/process-self-converted-datalog/",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(t){var o=t.test_data;null!==o&&v("Successfully fetched process-datalog-excel"),Excel.run(function(){var t=s(n().mark((function t(c){var s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,R,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H,X,G,W,V,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=c.workbook.worksheets.getItem("Masterfile"),(i=u.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:l=1e3,f=i.rowCount,d=i.columnCount,p=[],h=0;case 10:if(!(h<f)){t.next=20;break}return g=Math.min(l,f-h),(m=u.getRangeByIndexes(h,0,g,d)).load("values"),t.next=16,c.sync();case 16:p=p.concat(m.values);case 17:h+=l,t.next=10;break;case 20:if(x=p[0],y=x.indexOf("Test number"),b=x.indexOf("Suite name"),w=x.indexOf("Test name"),-1!==y){t.next=28;break}return console.error("Test number column is not found"),v("Test number is not found"),t.abrupt("return");case 28:if(-1!==b){t.next=32;break}return console.error("Suite name is not found"),v("Suite name is not found"),t.abrupt("return");case 32:if(-1!==w){t.next=36;break}return console.error("Test name is not found"),v("Test name is not found"),t.abrupt("return");case 36:return(k=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=40,c.sync();case 40:C=[],t.prev=41,C=k.values.flat().filter((function(e){return""!==e})),t.next=49;break;case 45:return t.prev=45,t.t0=t.catch(41),console.error("Error while processing testNameRange.values:",t.t0),t.abrupt("return");case 49:if(Array.isArray(o)){t.next=52;break}return console.error("TestData isn't an array or isn't downloaded"),t.abrupt("return");case 52:E=[],t.prev=53,E=o.filter((function(e){return!C.includes(e.test_name)})),t.next=61;break;case 57:return t.prev=57,t.t1=t.catch(53),console.error("Error while TestData.filter",t.t1),t.abrupt("return");case 61:if(Array.isArray(p)){t.next=64;break}return console.error("allValues isn't an array"),t.abrupt("return");case 64:if(R=p.length,F=[],A=[],t.prev=67,!(E.length>0)){t.next=87;break}if(T=E.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),-1!==y){t.next=73;break}return v("Can't find Test number column in header"),t.abrupt("return");case 73:return u.getRangeByIndexes(R,y,E.length,1).values=T,t.next=77,c.sync();case 77:return _=u.getRangeByIndexes(R,b,E.length,1),S=u.getRangeByIndexes(R,w,E.length,1),F=E.map((function(e){return[e.suite_name]})),A=E.map((function(e){return[e.test_name]})),_.values=F,S.values=A,t.next=85,c.sync();case 85:t.next=88;break;case 87:v("There's no new test");case 88:t.next=93;break;case 90:t.prev=90,t.t2=t.catch(67),console.error("Error while processing newTests:",t.t2);case 93:if(O=new Uint8Array(a.target.result),N=XLSX.read(O,{type:"array"}),L=N.Sheets.mir,U=XLSX.utils.sheet_to_json(L,{defval:""}),M=null===(s=U[0])||void 0===s||null===(s=s.JOB_NAM)||void 0===s?void 0:s.trim(),-1!==(P=x.indexOf(M))){t.next=103;break}return console.error("Can't find product name column:",M),v("Can't find product name column:",M),t.abrupt("return");case 103:return B.push({name:M,stage:I}),Y=B.filter((function(e){return e.name===M})).length,(D=u.getRangeByIndexes(1,P,1,Y)).load("values"),t.next=109,c.sync();case 109:H=0;case 110:if(!(H<=Y)){t.next=118;break}if(console.log("stage %d = %s",H,D.values[0][H]),D.values[0][H]!==I){t.next=115;break}return j=H,t.abrupt("break",118);case 115:H++,t.next=110;break;case 118:return void 0===j&&(console.error("Can't find stage name index :",I),v("Can't find stage name index :",I)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",P,Y,j),i=u.getUsedRange(),t.next=123,c.sync();case 123:return i.load(["rowCount","columnCount"]),t.next=126,c.sync();case 126:f=i.rowCount,d=i.columnCount,p=[],X=0;case 130:if(!(X<f)){t.next=140;break}return G=Math.min(l,f-X),(W=u.getRangeByIndexes(X,0,G,d)).load("values"),t.next=136,c.sync();case 136:p=p.concat(W.values);case 137:X+=l,t.next=130;break;case 140:return x=p[0],(V=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=145,c.sync();case 145:$=V.values.map((function(e){return e[0]})),q=[];try{q=$.map((function(e){var t=o.find((function(t){return t.test_name===e}));return[t?t.YN_check:""]}))}catch(e){console.error("Error while creating YNValues:",e)}return(J=u.getRangeByIndexes(2,P+j,q.length,1)).load("values"),t.next=152,c.sync();case 152:return 0===q.length?(console.warn("No Y/N check data"),v("No Y/N check data")):console.log("YN.length of %s %s is %d",M,I,q.length),J.values=q,t.next=156,c.sync();case 156:return z=x.indexOf("Is used (Y/N)"),(K=u.getRangeByIndexes(2,z,J.values.length,1)).load("values"),t.next=161,c.sync();case 161:for(Q=K.values,Array.isArray(Q)&&0!==Q.length||(Q=Array.from({length:J.values.length},(function(){return[""]}))),Z=0;Z<J.values.length;Z++)"Y"===J.values[Z][0]?"Partial"===Q[Z][0]||"No"===Q[Z][0]?Q[Z][0]="Partial":""===Q[Z][0]&&(Q[Z][0]="All"):"All"===Q[Z][0]||"Partial"===Q[Z][0]?Q[Z][0]="Partial":Q[Z][0]="No";return K.values=Q,t.next=167,c.sync();case 167:for((ee=J.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",ee.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},te=["All","Partial"],ne=["#C6EFCE","#FFEB9C"],re=K.conditionalFormats.count-1;re>=0;re--)K.conditionalFormats.getItemAt(re).delete();return t.next=175,c.sync();case 175:for(ae=0;ae<te.length;ae++)oe=te[ae],ce=ne[ae],(se=K.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=ce,se.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:oe};return t.next=178,c.sync();case 178:console.log("Finished processing a file"),v("Finished processing a file"),r++,e(r),document.body.style.cursor="default";case 183:case"end":return t.stop()}}),t,null,[[41,45],[53,57],[67,90]])})));return function(e){return t.apply(this,arguments)}}())})));case 90:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},o.onerror=a,o.readAsArrayBuffer(t)})));case 2:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function h(e,t){return g.apply(this,arguments)}function g(){return g=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var c=new FileReader;c.onload=function(){var o=s(n().mark((function o(c){var s,u,i,l,f,d,p,h,g,m,x,y,b,w;return n().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(s=new FormData).append("file",t),new Uint8Array(c.target.result),o.next=5,fetch("https://limit-project-demo.onrender.com/process-EY/",{method:"POST",body:s});case 5:if((u=o.sent).ok){o.next=10;break}return console.error("Upload failed"),v("Upload failed"),o.abrupt("return");case 10:return o.next=12,u.json();case 12:i=o.sent,l=i.data,f=[],h=[],g=r(l);try{for(g.s();!(m=g.n()).done;)x=m.value,p!==x.product?(p=x.product,d=x.stage,f.push({name:x.product,stage:x.stage}),h.push(p)):x.stage!==d&&(d=x.stage,f.push({name:x.product,stage:x.stage}))}catch(e){g.e(e)}finally{g.f()}console.log("All product: ",h),console.log("All EY stage and product: ",f),y=n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=w[b],a=f.filter((function(e){return e.name===t})),console.log("OneProduct_Allstage: ",a),o=r(a),e.prev=4,s=n().mark((function e(){var t,r,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,r=t.name,a=t.stage.toLowerCase(),e.next=5,k(r,a);case 5:return o=l.filter((function(e){return r===e.product&&t.stage===e.stage})),console.log("OneStage_data: ",o),e.next=9,E(o);case 9:return e.next=11,R(o,r,a);case 11:case"end":return e.stop()}}),e)})),o.s();case 7:if((c=o.n()).done){e.next=11;break}return e.delegateYield(s(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),o.e(e.t1);case 16:return e.prev=16,o.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})),b=0,w=h;case 22:if(!(b<w.length)){o.next=27;break}return o.delegateYield(y(),"t0",24);case 24:b++,o.next=22;break;case 27:v("Imported EY file successfully"),a++,e(a);case 30:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),c.onerror=o,c.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)}))),g.apply(this,arguments)}function m(e){return x.apply(this,arguments)}function x(){return x=s(n().mark((function e(a){var o,c,u,i,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],c=[],u=[],i=[],l=[],e.next=7,Excel.run(function(){var e=s(n().mark((function e(f){var d,p,h,g,m,x,b,w,k,C,E,I;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,fetch("https://limit-project-demo.onrender.com/upload-folder/",{method:"POST",body:a});case 3:if((d=e.sent).ok){e.next=8;break}return console.error("Upload failed"),v("Upload failed"),e.abrupt("return");case 8:return v("Imported Folder fetched successfully"),e.next=11,d.json();case 11:return p=e.sent,h=p.mfh_files||[],(g=document.getElementById("mfh-list")).innerHTML="",(m=f.workbook.worksheets).load("items/name"),e.next=19,f.sync();case 19:if(x="InputFiles",!m.items.map((function(e){return e.name})).includes(x)){e.next=25;break}b=m.getItem(x),e.next=34;break;case 25:return b=m.add(x),w=["File_Name"],(k=b.getRangeByIndexes(0,0,1,w.length)).values=[w],k.format.fill.color="#C6EFCE",k.format.font.bold=!0,b.position=0,e.next=34,f.sync();case 34:if(x="Masterfile",m.items.map((function(e){return e.name})).includes(x)){e.next=48;break}return console.log("Creating Masterfile..."),v("Creating Masterfile..."),(E=f.workbook.worksheets).load("items/name"),e.next=43,f.sync();case 43:I="Masterfile",E.items.map((function(e){return e.name})).includes(I)||((C=E.add(I)).position=0),C.activate();case 48:h.forEach((function(e){var a=document.createElement("li");a.textContent="".concat(e," (ready)"),a.style.cursor="pointer",a.addEventListener("click",s(n().mark((function f(){var d,p;return n().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return document.querySelectorAll("li").forEach((function(e){e.classList.remove("selected-file")})),a.classList.add("selected-file"),f.next=4,fetch("https://limit-project-demo.onrender.com/process-testtable/?filename=".concat(encodeURIComponent(e)));case 4:if((d=f.sent).ok){f.next=9;break}return document.getElementById("download-links").innerHTML='<p style="color:red;">Failed to process '.concat(e,"</p>"),f.abrupt("return");case 9:return a.textContent=e,f.next=12,d.json();case 12:return y((p=f.sent).files),f.next=16,Excel.run(function(){var e=s(n().mark((function e(a){var s,f,d,h,g,m,x,y,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H,X,G,W,V,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se,ue,ie,le,fe,de,pe,he,ge,me,xe,ye,ve,be,we,ke,Ce,Ee,Ie,Re,Be,_e,Se,Fe,Ae,Te,Oe,Ne,Le,Ue,Me,Pe,Ye,je,De,He,Xe,Ge,We,Ve,$e,qe,Je,ze,Ke,Qe,Ze,et;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.body.style.cursor="wait",s=a.workbook.worksheets.getItem("Masterfile"),f=[],d=0;case 4:if(!(d<p.files.length)){e.next=75;break}return(h=s.getUsedRange()).load(["values","rowCount","columnCount"]),e.next=9,a.sync();case 9:return g=h.values[0]||[],m=h.values[1]||[],e.next=13,a.sync();case 13:if("ok"!==(x=p.files[d]).status||!Array.isArray(x.content)){e.next=72;break}if(y=x.content[0],b=x.content[1],0!==d){e.next=57;break}w=0;case 19:if(!(w<y.length)){e.next=34;break}if(k=y[w],C=b[w],f.push({name:k,stage:C}),!k||k===(g[w]||"")){e.next=27;break}return s.getCell(0,w).values=[[k]],e.next=27,a.sync();case 27:if(!C||C===m[w]){e.next=31;break}return s.getCell(1,w).values=[[C]],e.next=31,a.sync();case 31:w++,e.next=19;break;case 34:return h.load(["rowCount","columnCount"]),e.next=37,a.sync();case 37:E=a.workbook.worksheets.getItem("Masterfile"),I=1e3,R=h.rowCount,B=h.columnCount,_=[],S=0;case 43:if(!(S<R)){e.next=53;break}return F=Math.min(I,R-S),(A=E.getRangeByIndexes(S,0,F,B)).load("values"),e.next=49,a.sync();case 49:_=_.concat(A.values);case 50:S+=I,e.next=43;break;case 53:g=_[0],m=_[1],e.next=70;break;case 57:return h.load(["rowCount","columnCount"]),e.next=60,a.sync();case 60:if(NaN!==(T=g.indexOf("Units"))){e.next=63;break}return e.abrupt("return");case 63:O=n().mark((function e(){var t,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y[N],r=b[N],"Lsl"!==t&&"Usl"!==t){e.next=20;break}if(void 0!==(o=f.find((function(e){return e.stage===r})))&&""!==o){e.next=20;break}return f.push({name:t,stage:r}),s.getRangeByIndexes(0,T+3,h.rowCount,2).insert(Excel.InsertShiftDirection.right),v("Insert new column"),e.next=11,a.sync();case 11:return h.load(["rowCount","columnCount"]),e.next=14,a.sync();case 14:return s.getCell(0,T+3).values=[["Lsl"]],s.getCell(0,T+4).values=[["Usl"]],s.getCell(1,T+3).values=r,s.getCell(1,T+4).values=r,e.next=20,a.sync();case 20:case"end":return e.stop()}}),e)})),N=0;case 65:if(!(N<g.length)){e.next=70;break}return e.delegateYield(O(),"t0",67);case 67:N++,e.next=65;break;case 70:return e.next=72,a.sync();case 72:d++,e.next=4;break;case 75:return e.next=77,a.sync();case 77:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=81,a.sync();case 81:U=a.workbook.worksheets.getItem("Masterfile"),M=1e3,P=L.rowCount,Y=L.columnCount,j=[],D=0;case 87:if(!(D<P)){e.next=97;break}return H=Math.min(M,P-D),(X=U.getRangeByIndexes(D,0,H,Y)).load("values"),e.next=93,a.sync();case 93:j=j.concat(X.values);case 94:D+=M,e.next=87;break;case 97:return G=j[0],W=j[1],V=L.rowCount,e.next=102,a.sync();case 102:return $=[],q=[],J=[],z=[],K=[],Q=[],Z=[],ee=[],te=[],ne=[],re=[],ae=[],oe=[],(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=119,a.sync();case 119:M=1e3,P=L.rowCount,Y=L.columnCount,j=[],ce=0;case 124:if(!(ce<P)){e.next=134;break}return se=Math.min(M,P-ce),(ue=U.getRangeByIndexes(ce,0,se,Y)).load("values"),e.next=130,a.sync();case 130:j=j.concat(ue.values);case 131:ce+=M,e.next=124;break;case 134:return G=j[0],W=j[1],e.next=138,a.sync();case 138:if(console.log(W),$=W.filter((function(e){return"w"===e[0]})),q=W.filter((function(e){return"f"===e[0]})),J=W.filter((function(e){return"a"===e[0]})),console.log($),console.log(q),console.log(J),z=$.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wh",""))-parseInt(t[0].replace("wh",""))})),K=$.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wr",""))-parseInt(t[0].replace("wr",""))})),Q=$.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wc",""))-parseInt(t[0].replace("wc",""))})),Z=$.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wi",""))-parseInt(t[0].replace("wi",""))})),ee=$.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("ww",""))-parseInt(t[0].replace("ww",""))})),console.log(z),console.log(K),console.log(Q),console.log(ee),console.log(Z),$=[],0!==z.length&&(ie=$).push.apply(ie,t(z)),0!==K.length&&(le=$).push.apply(le,t(K)),0!==Q.length&&(fe=$).push.apply(fe,t(Q)),0!==ee.length&&(de=$).push.apply(de,t(ee)),0!==Z.length&&(pe=$).push.apply(pe,t(Z)),o.push.apply(o,t($)),te=q.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fh",""))-parseInt(t[0].replace("fh",""))})),ne=q.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fr",""))-parseInt(t[0].replace("fr",""))})),re=q.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fc",""))-parseInt(t[0].replace("fc",""))})),ae=q.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fi",""))-parseInt(t[0].replace("fi",""))})),oe=q.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fw",""))-parseInt(t[0].replace("fw",""))})),console.log(te),console.log(ne),console.log(re),console.log(oe),console.log(ae),q=[],0!==te.length&&(he=q).push.apply(he,t(te)),0!==ne.length&&(ge=q).push.apply(ge,t(ne)),0!==re.length&&(me=q).push.apply(me,t(re)),0!==oe.length&&(xe=q).push.apply(xe,t(oe)),0!==ae.length&&(ye=q).push.apply(ye,t(ae)),o.push.apply(o,t(q)),o.push.apply(o,t(J)),ve=z.filter((function(e,t){return t%2==0})),be=K.filter((function(e,t){return t%2==0})),we=Q.filter((function(e,t){return t%2==0})),ke=Z.filter((function(e,t){return t%2==0})),Ce=ee.filter((function(e,t){return t%2==0})),Ee=te.filter((function(e,t){return t%2==0})),Ie=ne.filter((function(e,t){return t%2==0})),Re=re.filter((function(e,t){return t%2==0})),Be=ae.filter((function(e,t){return t%2==0})),_e=oe.filter((function(e,t){return t%2==0})),Se=J.filter((function(e,t){return t%2==0})),Fe=[],ve.forEach((function(e){Ee.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),be.forEach((function(e){Ie.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),we.forEach((function(e){Re.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),ke.forEach((function(e){Be.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),Ce.forEach((function(e){_e.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),Ie.forEach((function(e){Se.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Fe.push({id:n,label:r})}))})),ve.forEach((function(e,t){ve.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),be.forEach((function(e,t){be.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),we.forEach((function(e,t){we.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),ke.forEach((function(e,t){ke.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),Ce.forEach((function(e,t){Ce.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),Ee.forEach((function(e,t){Ee.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),Ie.forEach((function(e,t){Ie.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),Re.forEach((function(e,t){Re.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),Be.forEach((function(e,t){Be.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),_e.forEach((function(e,t){_e.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Fe.push({id:a,label:o})}}))})),console.log(Fe),Fe.forEach((function(e){var t=document.createElement("label");t.className="label-item";var n=document.createElement("input");n.type="checkbox",n.id=e.id,n.name="stagePair",n.value=e.id,t.appendChild(n),t.appendChild(document.createTextNode(" ".concat(e.label))),labelList.appendChild(t);var r=e.label.slice(0,3),a=e.label.slice(-3);u.push.apply(u,[r]),i.push.apply(i,[a]);var o=["LL "+r.toUpperCase()+" ? "+a.toUpperCase(),"UL "+r.toUpperCase()+" ? "+a.toUpperCase()];c.push.apply(c,o)})),console.log("Allpair: ",c),Ae=W.indexOf("Spec"),!isNaN(Ae)){e.next=215;break}return v("Can't find Spec column!"),e.abrupt("return");case 215:return s.getRangeByIndexes(1,Ae+2,1,o.length).values=[o],e.next=219,a.sync();case 219:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=223,a.sync();case 223:M=1e3,P=L.rowCount,Y=L.columnCount,j=[],Te=0;case 228:if(!(Te<P)){e.next=238;break}return Oe=Math.min(M,P-Te),(Ne=U.getRangeByIndexes(Te,0,Oe,Y)).load("values"),e.next=234,a.sync();case 234:j=j.concat(Ne.values);case 235:Te+=M,e.next=228;break;case 238:return G=j[0],W=j[1],V=L.rowCount,e.next=243,a.sync();case 243:Le=r(p.files),e.prev=244,Le.s();case 246:if((Ue=Le.n()).done){e.next=287;break}if("ok"!==(Me=Ue.value).status||!Array.isArray(Me.content)){e.next=285;break}Pe=Me.content[0],Ye=Me.content[1],je=2;case 252:if(!(je<Me.content.length)){e.next=285;break}De=Me.content[je],He=[],Xe=0;case 256:if(!(Xe<G.length)){e.next=279;break}if("Lsl"!==(Ge=G[Xe])&&"Usl"!==Ge){e.next=273;break}if(We=W[Xe],"Lsl"!==Ge){e.next=267;break}if(NaN!==(Ve=Ye.indexOf(We))){e.next=264;break}return e.abrupt("continue",276);case 264:He.push(-1!==Ve?De[Ve]:""),e.next=271;break;case 267:if(NaN!==($e=Ye.indexOf(We))){e.next=270;break}return e.abrupt("continue",276);case 270:He.push(-1!==$e?De[$e+1]:"");case 271:e.next=276;break;case 273:qe=G.indexOf(Ge),Je=Pe.indexOf(Ge),-1!==qe&&-1!==Je&&(He[qe]=De[Je]);case 276:Xe++,e.next=256;break;case 279:s.getRangeByIndexes(V,0,1,G.length).values=[He],V++;case 282:je++,e.next=252;break;case 285:e.next=246;break;case 287:e.next=292;break;case 289:e.prev=289,e.t1=e.catch(244),Le.e(e.t1);case 292:return e.prev=292,Le.f(),e.finish(292);case 295:return e.next=297,a.sync();case 297:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=301,a.sync();case 301:M=1e3,P=L.rowCount,Y=L.columnCount,j=[],ze=0;case 306:if(!(ze<P)){e.next=316;break}return Ke=Math.min(M,P-ze),(Qe=U.getRangeByIndexes(ze,0,Ke,Y)).load("values"),e.next=312,a.sync();case 312:j=j.concat(Qe.values);case 313:ze+=M,e.next=306;break;case 316:return G=j[0],W=j[1],V=L.rowCount,Ze=G.indexOf("Bin_s_num"),e.next=322,a.sync();case 322:return s.getRangeByIndexes(0,Ze,L.rowCount,2).insert(Excel.InsertShiftDirection.right),e.next=325,a.sync();case 325:return s.getCell(0,Ze).values=[["All LL ? Spec"]],s.getCell(0,Ze+1).values=[["All UL ? Spec"]],L.load(["rowCount","columnCount"]),e.next=330,a.sync();case 330:return s.getRangeByIndexes(0,Ze+2,L.rowCount,o.length).insert(Excel.InsertShiftDirection.right),L.load(["rowCount","columnCount"]),e.next=334,a.sync();case 334:for(et=Ae+2;et<Ae+2+o.length;et+=2)l.push.apply(l,["LL Spec? "+W[et],"UL Spec? "+W[et]]);return console.log(l),console.log("limit_compare contains undefined?",l.includes(void 0)),console.log("limit_compare contains null?",l.includes(null)),s.getRangeByIndexes(0,Ze+2,1,l.length).values=[l],e.next=341,a.sync();case 341:document.body.style.cursor="default";case 342:case"end":return e.stop()}}),e,null,[[244,289,292,295]])})));return function(t){return e.apply(this,arguments)}}());case 16:return f.next=18,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,c,s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H,X,G,W,V,$,q,J,z;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sync();case 2:return e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:return document.body.style.cursor="wait",r=t.workbook.worksheets.getItem("Masterfile"),(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:c=t.workbook.worksheets.getItem("Masterfile"),s=1e3,u=a.rowCount,i=a.columnCount,l=[],f=0;case 16:if(!(f<u)){e.next=26;break}return d=Math.min(s,u-f),(p=c.getRangeByIndexes(f,0,d,i)).load("values"),e.next=22,t.sync();case 22:l=l.concat(p.values);case 23:f+=s,e.next=16;break;case 26:for(h=l[0],g=l[1],m=l,x=a.rowCount,a.columnCount,y=g.indexOf("Spec"),b=h.indexOf("All LL ? Spec"),w=h.indexOf("All UL ? Spec"),k=y+o.length+2,C=[],E=2;E<m.length;E++){for(I=[],R=y;R<=k;R++)I.push(m[E][R]);C.push(I)}B=h.indexOf("All UL ? Spec")+1,_=[],S=[],F=[],A=0;case 42:if(!(A<C.length)){e.next=70;break}T=C[A],O=T[0],N=T[1],L="In-spec",U="In-spec",F[A]=[],M=2;case 50:if(!(M+1<T.length)){e.next=65;break}if(P=T[M],Y=T[M+1],void 0!==P&&void 0!==Y){e.next=56;break}return console.warn("Missing LSL/USL at row ".concat(A,", columns ").concat(M," and ").concat(M+1)),e.abrupt("continue",62);case 56:j="",D="",""===P||null==P||isNaN(P)||(P>=O?j=O<P?"Widen":"Same":(L="Out-spec",j="Tighten")),""===Y||null==Y||isNaN(Y)||(Y<=N?D=N>Y?"Widen":"Same":(U="Out-spec",D="Tighten")),F[A].push(j),F[A].push(D);case 62:M+=2,e.next=50;break;case 65:_.push([L]),S.push([U]);case 67:A++,e.next=42;break;case 70:return r.getRangeByIndexes(2,B,F.length,F[0].length).values=F,e.next=73,t.sync();case 73:return H=r.getRangeByIndexes(2,b,_.length,1),X=r.getRangeByIndexes(2,w,S.length,1),H.values=_,X.values=S,e.next=79,t.sync();case 79:return r.getRangeByIndexes(0,3,x,2).insert(Excel.InsertShiftDirection.right),r.getCell(0,3).values="Is used (Y/N)",r.getCell(0,4).values="Can remove (Y/N)",e.next=85,t.sync();case 85:for(v("Limit Compare Successfully"),G=["Out-spec","In-spec"],W=["#ff9c9c","#C6EFCE"],V=0;V<G.length;V++)$=G[V],q=W[V],(J=H.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=q,J.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:$},(z=X.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=q,z.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:$};return e.next=91,t.sync();case 91:document.body.style.cursor="default";case 92:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:return f.next=20,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,s,f,d,p,h,g,m,x,y,v,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,t.sync();case 3:return r=t.workbook.worksheets.getItem("Masterfile"),e.next=6,t.sync();case 6:return(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:s=t.workbook.worksheets.getItem("Masterfile"),f=1e3,d=a.rowCount,p=a.columnCount,h=[],g=0;case 16:if(!(g<d)){e.next=26;break}return m=Math.min(f,d-g),(x=s.getRangeByIndexes(g,0,m,p)).load("values"),e.next=22,t.sync();case 22:h=h.concat(x.values);case 23:g+=f,e.next=16;break;case 26:return y=h[0],v=h[1],e.next=30,t.sync();case 30:return b=y.indexOf("Bin_s_num"),r.getRangeByIndexes(0,b,a.rowCount,c.length).insert(Excel.InsertShiftDirection.right),r.getRangeByIndexes(0,b,1,c.length).values=[c],e.next=35,t.sync();case 35:for(w=v.indexOf("Spec"),k=w+o.length+2,C=[],E=2;E<h.length;E++){for(I=[],R=w;R<=k;R++)I.push(h[E][R]);C.push(I)}B=[],_=0;case 41:if(!(_<u.length)){e.next=53;break}if(S=u[_],F=i[_],A=v.indexOf(S),T=v.indexOf(F),!(A<0||T<0)){e.next=49;break}return console.warn("ไม่พบ stage: ".concat(S," หรือ ").concat(F)),e.abrupt("continue",50);case 49:for(O=0;O<C.length;O++)N=C[O],L=N[A-w],U=N[A-w+1],M=N[T-w],P=N[T-w+1],Y="",j="",""===L||null==L||isNaN(L)||""===M||null==M||isNaN(M)||(Y=L<M?"Widen":L>M?"Tighten":"Same"),""===U||null==U||isNaN(U)||""===P||null==P||isNaN(P)||(j=U>P?"Widen":U<P?"Tighten":"Same"),B[O]||(B[O]=[]),B[O].push(Y),B[O].push(j);case 50:_++,e.next=41;break;case 53:if(console.log("All compare:",B),D=y.indexOf(l[l.length-1]),console.log(D),!(D<0)){e.next=58;break}return e.abrupt("return");case 58:return r.getRangeByIndexes(2,D+1,B.length,B[0].length).values=B,e.next=61,t.sync();case 61:return a.load("columnCount"),e.next=64,t.sync();case 64:for(H=0;H<a.columnCount;H++)r.getCell(0,H).format.fill.color="#c4d4f3";return e.next=67,t.sync();case 67:document.body.style.cursor="default";case 68:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:return f.next=22,Excel.run(function(){var t=s(n().mark((function t(r){var a,o,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("InputFiles"),(o=a.getUsedRange()).load("rowCount"),t.next=6,r.sync();case 6:return c=o.rowCount,a.getRangeByIndexes(c,0,1,1).values=[[e]],t.next=11,r.sync();case 11:v("Successfully limit files imported"),document.body.style.cursor="default";case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 22:case"end":return f.stop()}}),f)})))),g.appendChild(a)})),document.body.style.cursor="default";case 50:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function y(e){document.body.style.cursor="wait";var t=document.getElementById("download-links");t.innerHTML="";var n=3;e.forEach((function(e){var r,a=((null===(r=e.content)||void 0===r?void 0:r.length)||0)-3+n,o=document.createElement("div");o.innerHTML="\n      <p><b>".concat(e.path,"</b> - ").concat(e.status," (").concat(n,"-").concat(a,")</p>\n    "),t.appendChild(o),n=a+1})),document.body.style.cursor="default"}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=document.getElementById("consoleOutput"),o=(new Date).toLocaleString(),c=e,s=0;c=c.replace(/%[sdif]/g,(function(e){var t=n[s++];switch(e){case"%d":case"%i":return parseInt(t);case"%f":return parseFloat(t).toFixed(2);default:return String(t)}}));var u=document.createElement("div");u.textContent="[".concat(o,"] > ").concat(c),a.appendChild(u),a.scrollTop=a.scrollHeight}function b(e,t){return w.apply(this,arguments)}function w(){return w=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R,B,_;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o.workbook.worksheets.load("items/name"),e.next=5,o.sync();case 5:return c=o.workbook.worksheets.getItem("Masterfile"),s=c.getUsedRange(),e.next=9,o.sync();case 9:return s.load(["rowCount","columnCount"]),e.next=12,o.sync();case 12:console.log(s.rowCount),u=1e3,i=s.rowCount,l=s.columnCount,f=[],d=0;case 18:if(!(d<i)){e.next=28;break}return p=Math.min(u,i-d),(h=c.getRangeByIndexes(d,0,p,l)).load("values"),e.next=24,o.sync();case 24:f=f.concat(h.values);case 25:d+=u,e.next=18;break;case 28:g=f[0],y=r(t),e.prev=30,y.s();case 32:if((b=y.n()).done){e.next=57;break}if(w=b.value,k=w.slice(0,3),C=w.slice(-3),m="LL "+k.toUpperCase()+" ? "+C.toUpperCase(),console.log(m),-1!==(x=g.indexOf(m))){e.next=42;break}return v("Can't find an index"),e.abrupt("return");case 42:return v("Hiding : %s ? %s",k.toUpperCase(),C.toUpperCase()),e.prev=43,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!0,e.next=50,o.sync();case 50:e.next=55;break;case 52:e.prev=52,e.t0=e.catch(43),console.log("Can't hide col due to: ",e.t0);case 55:e.next=32;break;case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(30),y.e(e.t1);case 62:return e.prev=62,y.f(),e.finish(62);case 65:return e.next=67,o.sync();case 67:E=r(a),e.prev=68,E.s();case 70:if((I=E.n()).done){e.next=95;break}if(R=I.value,B=R.slice(0,3),_=R.slice(-3),m="LL "+B.toUpperCase()+" ? "+_.toUpperCase(),-1!==(x=g.indexOf(m))){e.next=79;break}return v("Can't find an index"),e.abrupt("return");case 79:return e.prev=79,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!1,e.next=86,o.sync();case 86:e.next=91;break;case 88:e.prev=88,e.t2=e.catch(79),console.log("Can't show col due to: ",e.t2);case 91:return e.next=93,o.sync();case 93:e.next=70;break;case 95:e.next=100;break;case 97:e.prev=97,e.t3=e.catch(68),E.e(e.t3);case 100:return e.prev=100,E.f(),e.finish(100);case 103:document.body.style.cursor="default";case 104:case"end":return e.stop()}}),e,null,[[30,59,62,65],[43,52],[68,97,100,103],[79,88]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return C=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("productName in Check_product_stage: ",t),console.log("stagename in Check_product_stage: ",r),e.next=4,Excel.run(function(){var e=s(n().mark((function e(a){var o,c,s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o=a.workbook.worksheets.getItem("Masterfile"),(c=o.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,a.sync();case 6:s=a.workbook.worksheets.getItem("Masterfile"),u=1e3,i=c.rowCount,l=c.columnCount,f=[],d=0;case 12:if(!(d<i)){e.next=22;break}return p=Math.min(u,i-d),(h=s.getRangeByIndexes(d,0,p,l)).load("values"),e.next=18,a.sync();case 18:f=f.concat(h.values);case 19:d+=u,e.next=12;break;case 22:for(g=f[0],console.log("headers: ",g),m=g.indexOf(t),console.log("productColINdex before add product name or stage: %d",m),x=[],w=0;w<=g.length;w++)"Can remove (Y/N)"===g[w]&&(y=w),"Lsl_typ"===g[w]&&(b=w);if(b-y-1>0)for(C=y+1;C<b;C++)E=g[C],I=f[1][C],E&&""!==E.trim()?(x.push({name:E.trim(),stage:I}),k=E.trim()):x.push({name:k,stage:I});if(-1!==m){e.next=55;break}if((R=a.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(B=R.getRange("F1:F1")).values=[[t]],!((_=g.indexOf("Can remove (Y/N)"))<0)){e.next=40;break}return v("Can't find 'Can remove' column"),e.abrupt("return");case 40:if(!((S=g.indexOf("Lsl_typ"))<0)){e.next=44;break}return v("Can't find 'Lsl_typ' column"),e.abrupt("return");case 44:for(F=0,A=_;A<S;A++)T=c.getCell(0,A),isNaN(T)&&""===T||F++;return O=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][F%4],B.format.fill.color=O,R.getRange("F2:F2").values=[[r]],e.next=53,a.sync();case 53:e.next=81;break;case 55:return N=a.workbook.worksheets.getItem("Masterfile"),e.next=58,a.sync();case 58:return L=m,U=x.filter((function(e){return e.name===t})).length,console.log("product :  %s , stage count : %d",t,U),N.getRangeByIndexes(0,L+1,1,1).insert(Excel.InsertShiftDirection.right),(c=N.getUsedRange()).load("rowCount"),e.next=67,a.sync();case 67:return M=c.rowCount,N.getRangeByIndexes(1,L+U,M,1).insert(Excel.InsertShiftDirection.right),c=N.getUsedRange(),e.next=73,a.sync();case 73:return N.getCell(1,L+U).values=[[r]],console.log("startcol for merge: %d stagecount for merge: %d",L,U),(P=N.getRangeByIndexes(0,L,1,U)).values=Array(1).fill(Array(U).fill(t)),P.merge(),e.next=81,a.sync();case 81:document.body.style.cursor="default";case 82:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function E(e){return I.apply(this,arguments)}function I(){return I=s(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("data from EY oneproduct: ",t),e.next=3,Excel.run(function(){var e=s(n().mark((function e(r){var a,o,c,s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("Masterfile"),(o=a.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,r.sync();case 6:c=1e3,s=o.rowCount,u=o.columnCount,i=[],l=0;case 11:if(!(l<s)){e.next=21;break}return f=Math.min(c,s-l),(d=a.getRangeByIndexes(l,0,f,u)).load("values"),e.next=17,r.sync();case 17:i=i.concat(d.values);case 18:l+=c,e.next=11;break;case 21:if(p=i[0],h=p.indexOf("Test number"),g=p.indexOf("Suite name"),m=p.indexOf("Test name"),-1!==h){e.next=29;break}return console.error("Can't find Test number column"),v("Can't find Test number column"),e.abrupt("return");case 29:if(-1!==g){e.next=33;break}return console.error("Can't find Suite name column"),v("Can't find Suite name column"),e.abrupt("return");case 33:if(-1!==m){e.next=37;break}return console.error("Can't find Test name column"),v("Can't find Test name column"),e.abrupt("return");case 37:return(x=a.getRangeByIndexes(2,m,i.length-2,1)).load("values"),e.next=41,r.sync();case 41:y=[],e.prev=42,y=x.values.flat().filter((function(e){return""!==e})),e.next=50;break;case 46:return e.prev=46,e.t0=e.catch(42),console.error("Error while processing testNameRange.values:",e.t0),e.abrupt("return");case 50:if(Array.isArray(t)){e.next=53;break}return console.error("data isn't an array or isn't loaded"),e.abrupt("return");case 53:b=[],e.prev=54,b=t.filter((function(e){return!y.includes(e.test_name)})),console.log("newTests from EY: ",b),e.next=63;break;case 59:return e.prev=59,e.t1=e.catch(54),console.error("Error while data.filter",e.t1),e.abrupt("return");case 63:if(Array.isArray(i)){e.next=66;break}return console.error("allValues isn't an array"),e.abrupt("return");case 66:if(w=i.length,E=[],I=[],!(b.length>0)){e.next=88;break}if(R=b.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),-1!==h){e.next=74;break}return v("Can't find Test number column"),e.abrupt("return");case 74:return a.getRangeByIndexes(w,h,b.length,1).values=R,e.next=78,r.sync();case 78:return k=a.getRangeByIndexes(w,g,b.length,1),C=a.getRangeByIndexes(w,m,b.length,1),E=b.map((function(e){return[e.suite_name]})),I=b.map((function(e){return[e.test_name]})),k.values=E,C.values=I,e.next=86,r.sync();case 86:e.next=89;break;case 88:v("There's no new test");case 89:document.body.style.cursor="default";case 90:case"end":return e.stop()}}),e,null,[[42,46],[54,59]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function R(e,t,n){return B.apply(this,arguments)}function B(){return B=s(n().mark((function e(t,r,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,i,l,f,d,p,h,g,m,x,y,b,w,k,C,E,I,R,B,_,S,F,A,T,O,N,L,U,M,P,Y,j,D,H,X,G,W,V,$,q;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",c=o.workbook.worksheets.getItem("Masterfile"),(s=c.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,o.sync();case 6:u=1e3,i=s.rowCount,l=s.columnCount,f=[],d=0;case 11:if(!(d<i)){e.next=21;break}return p=Math.min(u,i-d),(h=c.getRangeByIndexes(d,0,p,l)).load("values"),e.next=17,o.sync();case 17:f=f.concat(h.values);case 18:d+=u,e.next=11;break;case 21:for(g=f[0],m=[],b=0;b<=g.length;b++)"Can remove (Y/N)"===g[b]&&(x=b),"Lsl_typ"===g[b]&&(y=b);if(y-x-1>0)for(k=x+1;k<y;k++)C=g[k],E=f[1][k],C&&""!==C.trim()?(m.push({name:C.trim(),stage:E}),w=C.trim()):m.push({name:w,stage:E});if(I=g.indexOf("Test number"),R=g.indexOf("Suite name"),B=g.indexOf("Test name"),-1!==I){e.next=33;break}return console.error("Test number column is not found"),v("Test number column is not found"),e.abrupt("return");case 33:if(-1!==R){e.next=37;break}return console.error("Suite name column is not found"),v("Suite name column is not found"),e.abrupt("return");case 37:if(-1!==B){e.next=41;break}return console.error("Test name column is not found"),v("Test name column is not found"),e.abrupt("return");case 41:if(-1!==(_=g.indexOf(r))){e.next=46;break}return console.error("Can't find %s column",r),v("Can't find %s column",r),e.abrupt("return");case 46:return S=m.filter((function(e){return e.name===r})).length,(A=c.getRangeByIndexes(1,_,1,S)).load("values"),e.next=51,o.sync();case 51:T=0;case 52:if(!(T<=S)){e.next=60;break}if(console.log("stage %d = %s",T,A.values[0][T]),A.values[0][T]!==a){e.next=57;break}return F=T,e.abrupt("break",60);case 57:T++,e.next=52;break;case 60:return void 0===F&&(console.error("Can't find:",a),v("Can't find:",a)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",_,S,F),(O=c.getRangeByIndexes(2,B,f.length-2,1)).load("values"),e.next=66,o.sync();case 66:N=O.values.map((function(e){return e[0]})),L=[];try{L=N.map((function(e){var n=t.find((function(t){return t.test_name===e}));return[n?n.YN_check:""]}))}catch(e){console.error("Error while processing YNValues:",e),v("Error while processing YNValues: %s",e.message||e)}return(U=c.getRangeByIndexes(2,_+F,L.length,1)).load("values"),e.next=73,o.sync();case 73:return 0===L.length?(console.warn("There's no Y/N check data"),v("There's no Y/N check data")):console.log("YN.length of %s %s is %d",r,a,L.length),U.values=L,e.next=77,o.sync();case 77:return M=g.indexOf("Is used (Y/N)"),(P=c.getRangeByIndexes(2,M,U.values.length,1)).load("values"),e.next=82,o.sync();case 82:for(Y=P.values,Array.isArray(Y)&&0!==Y.length||(Y=Array.from({length:U.values.length},(function(){return[""]}))),j=0;j<U.values.length;j++)"Y"===U.values[j][0]?"Partial"===Y[j][0]||"No"===Y[j][0]?Y[j][0]="Partial":""===Y[j][0]&&(Y[j][0]="All"):"All"===Y[j][0]||"Partial"===Y[j][0]?Y[j][0]="Partial":Y[j][0]="No";return P.values=Y,e.next=88,o.sync();case 88:return(D=U.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",D.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},P.conditionalFormats.load("count"),e.next=94,o.sync();case 94:for(H=P.conditionalFormats.count-1;H>=0;H--)P.conditionalFormats.getItemAt(H).delete();return e.next=97,o.sync();case 97:for(X=["Partial","All"],G=["#FFEB9C","#C6EFCE"],W=0;W<X.length;W++)V=X[W],$=G[W],(q=P.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=$,q.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:V};return e.next=102,o.sync();case 102:document.body.style.cursor="default";case 103:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),B.apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("convertBtn").onclick=u,document.getElementById("importFolderBtn").addEventListener("click",s(n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=document.getElementById("folderInput").files).length){e.next=4;break}return alert("Please select a folder first."),e.abrupt("return");case 4:a=new FormData,o=r(t);try{for(o.s();!(c=o.n()).done;)s=c.value,a.append("files",s,s.webkitRelativePath)}catch(e){o.e(e)}finally{o.f()}return e.next=9,m(a);case 9:case"end":return e.stop()}}),e)}))));var t=document.getElementById("importDatalogBtn");t&&t.addEventListener("click",l),document.getElementById("compareAll").addEventListener("click",s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelectorAll("#checkboxForm input[type='checkbox']").forEach((function(e){e.checked=!e.checked}));case 2:case"end":return e.stop()}}),e)})))),document.getElementById("compare").addEventListener("click",s(n().mark((function e(){var t,r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelectorAll("#checkboxForm input[type='checkbox']"),r=Array.from(t).filter((function(e){return!e.checked})).map((function(e){return e.value})),console.log(r),a=Array.from(t).filter((function(e){return e.checked})).map((function(e){return e.value})),console.log(a),e.next=7,b(r,a);case 7:case"end":return e.stop()}}),e)}))))}}))}(),new URL(n(58394),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map