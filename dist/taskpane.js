/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"17b1c735468281e01b0b.css"},60947:function(e,t,n){e.exports=n.p+"b9bc3025475cd8fb96d2.js"},86679:function(e,t,n){e.exports=n.p+"12727581d40f381c1fb6.iix"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){n=function(){return r};var t,r={},a=Object.prototype,o=a.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function i(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{i({},"")}catch(t){i=function(e,t,n){return e[t]=n}}function f(e,n,r,a){var o=n&&n.prototype instanceof g?n:g,c=Object.create(o.prototype);return i(c,"_invoke",function(e,n,r){var a=1;return function(o,c){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===o)throw c;return{value:t,done:!0}}for(r.method=o,r.arg=c;;){var s=r.delegate;if(s){var u=C(s,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var l=d(e,n,r);if("normal"===l.type){if(a=r.done?4:2,l.arg===p)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(a=4,r.method="throw",r.arg=l.arg)}}}(e,r,new R(a||[])),!0),c}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var p={};function g(){}function h(){}function m(){}var x={};i(x,s,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(_([])));v&&v!==a&&o.call(v,s)&&(x=v);var b=m.prototype=g.prototype=Object.create(x);function w(e){["next","throw","return"].forEach((function(t){i(e,t,(function(e){return this._invoke(t,e)}))}))}function k(t,n){function r(a,c,s,u){var l=d(t[a],t,c);if("throw"!==l.type){var i=l.arg,f=i.value;return f&&"object"==e(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(f).then((function(e){i.value=e,s(i)}),(function(e){return r("throw",e,s,u)}))}u(l.arg)}var a;i(this,"_invoke",(function(e,t){function o(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(o,o):o()}),!0)}function C(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=d(a,e.i,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,p;var c=o.arg;return c?c.done?(n[e.r]=c.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function I(e){this.tryEntries.push(e)}function E(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function R(e){this.tryEntries=[[-1]],e.forEach(I,this),this.reset(!0)}function _(n){if(null!=n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function e(){for(;++a<n.length;)if(o.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return h.prototype=m,i(b,"constructor",m),i(m,"constructor",h),h.displayName=i(m,l,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,i(e,l,"GeneratorFunction")),e.prototype=Object.create(b),e},r.awrap=function(e){return{__await:e}},w(k.prototype),i(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var c=new k(f(e,t,n,a),o);return r.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},w(b),i(b,l,"Generator"),i(b,s,(function(){return this})),i(b,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},r.values=_,R.prototype={constructor:R,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(E),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){c.type="throw",c.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],c=o[4],s=this.prev,u=o[1],l=o[2];if(-1===o[0])return r("end"),!1;if(!u&&!l)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=s){if(s<u)return this.method="next",this.arg=t,r(u),!0;if(s<l)return r(l),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===e||"continue"===e)&&a[0]<=t&&t<=a[2]&&(a=null);var o=a?a[4]:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a[2],p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),E(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var a=r.arg;E(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},r}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,c=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw c}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,a,o,c){try{var s=e[o](c),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){c(o,r,a,s,u,"next",e)}function u(e){c(o,r,a,s,u,"throw",e)}s(void 0)}))}}function u(){return l.apply(this,arguments)}function l(){return l=s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,document.body.style.cursor="wait",e.next=4,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,o,c,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.workbook.worksheets).load("items/name"),e.next=4,t.sync();case 4:return a="Masterfile",r.items.map((function(e){return e.name})).includes(a)||(o=r.add(a),c=["Suite name","Test name","Test number","Lsl_typ","Usl_typ","Units"],(s=o.getRangeByIndexes(0,0,1,c.length)).values=[c],s.format.fill.color="#43a0ec",s.format.font.bold=!0,(u=t.workbook.worksheets.getItem("Masterfile")).position=0,u.activate()),e.next=10,t.sync();case 10:document.body.style.cursor="default";case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("เกิดข้อผิดพลาด:",e.t0),v("เกิดข้อผิดพลาด");case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),l.apply(this,arguments)}function i(){return f.apply(this,arguments)}function f(){return f=s(n().mark((function e(){var t,r,a,o,c,u,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.body.style.cursor="wait",e.prev=1,t=document.getElementById("fileInput"),r=t.files,a=Array.from(r),r&&0!==r.length){e.next=7;break}return e.abrupt("return");case 7:console.log("Amount of  file: %d",a.length),v("Amount of  file: %d",a.length),o=0,c=n().mark((function e(t){var r,c,u,l,i,f,p,h,m,x,y,b,w,k,C;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a[t],c=r.name.toLowerCase().endsWith(".csv"),u=r.name.toLowerCase().endsWith(".xlsx"),l=r.name.toLowerCase().endsWith(".stdf"),e.prev=4,!c&&!u){e.next=15;break}console.log("file CSV or XLSX is processing"),v("file CSV or XLSX is processing"),(i=new FileReader).onload=function(){var e=s(n().mark((function e(a){var c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=new Uint8Array(a.target.result),!(XLSX.read(c,{type:"array"}).SheetNames.length>1)){e.next=11;break}if(t!==o){e.next=9;break}return e.next=7,d(r,o);case 7:v("Processed file = %d",o=e.sent);case 9:e.next=17;break;case 11:if(v("EY datalog is importing"),t!==o){e.next=17;break}return e.next=15,g(r,o);case 15:v("Processed file = %d",o=e.sent);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),i.readAsArrayBuffer(r),(f=document.getElementById("importedFilesList"))&&((p=document.createElement("li")).textContent="".concat(r.name," - ").concat(r.webkitRelativePath||r.name),f.appendChild(p)),e.next=54;break;case 15:if(!l){e.next=52;break}if(console.log("File is STDF"),v("File is STDF"),h=new FormData,r){e.next=22;break}return console.warn("ไม่มีไฟล์ที่เลือก"),e.abrupt("return",{v:void 0});case 22:return h.append("files",r),console.log("กำลังประมวลผลไฟล์: ".concat(r.name)),v("กำลังประมวลผลไฟล์: ".concat(r.name)),document.body.style.cursor="wait",e.next=28,fetch("https://limit-project-demo.onrender.com/upload-stdf/",{method:"POST",body:h});case 28:if((m=e.sent).ok){e.next=36;break}return e.next=32,m.text();case 32:return x=e.sent,console.error("STDF upload failed:",x),v("STDF upload failed:",x),e.abrupt("return",{v:void 0});case 36:return e.next=38,m.blob();case 38:y=e.sent,b=window.URL.createObjectURL(y),w=r.name.replace(/\.[^/.]+$/,""),k="".concat(w,".xlsx"),(C=document.createElement("a")).href=b,C.download=k,document.body.appendChild(C),C.click(),C.remove(),window.URL.revokeObjectURL(b),v("STDF converted and downloaded successfully"),e.next=54;break;case 52:console.warn("ไม่รองรับไฟล์ ".concat(r.name)),v("ไม่รองรับไฟล์ ".concat(r.name));case 54:e.next=60;break;case 56:e.prev=56,e.t0=e.catch(4),console.error("Error while processing file: ".concat(r.name),e.t0),v("Error while processing file: ".concat(r.name));case 60:return e.prev=60,document.body.style.cursor="default",e.finish(60);case 63:case"end":return e.stop()}}),e,null,[[4,56,60,63]])})),l=0;case 12:if(!(l<a.length)){e.next=20;break}return e.delegateYield(c(l),"t0",14);case 14:if(!(u=e.t0)){e.next=17;break}return e.abrupt("return",u.v);case 17:l++,e.next=12;break;case 20:document.body.style.cursor="default",e.next=28;break;case 23:e.prev=23,e.t1=e.catch(1),console.error("Error while importing file: ".concat(file.name),e.t1),v("Error while importing file: ".concat(file.name)),fileInput.value="";case 28:case"end":return e.stop()}}),e,null,[[1,23]])}))),f.apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.abrupt("return",new Promise((function(e,a){var o=new FileReader;o.onload=function(a){var o=new FormData;o.append("file",t),console.log("Uploading Excel Datalog to API: ".concat(t.name)),v("Uploading Excel Datalog to API: ".concat(t.name));var c=new Uint8Array(a.target.result),u=XLSX.read(c,{type:"array"}).Sheets.mir;Excel.run(function(){var t=s(n().mark((function t(c){var l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H,X,V,G,W,$;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=c.workbook.worksheets.getItem("Masterfile"),(d=f.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:p=c.workbook.worksheets.getItem("Masterfile"),g=1e3,h=d.rowCount,m=d.columnCount,x=[],y=0;case 11:if(!(y<h)){t.next=21;break}return b=Math.min(g,h-y),(w=p.getRangeByIndexes(y,0,b,m)).load("values"),t.next=17,c.sync();case 17:x=x.concat(w.values);case 18:y+=g,t.next=11;break;case 21:for(k=x[0],console.log("headers: ",k),C=XLSX.utils.sheet_to_json(u,{defval:""}),I=null===(l=C[0])||void 0===l||null===(l=l.JOB_NAM)||void 0===l?void 0:l.trim(),E=null===(i=C[0])||void 0===i||null===(i=i.TEST_COD)||void 0===i?void 0:i.trim(),R=k.indexOf(I),console.log("productColINdex before add product name or stage: %d",R),v("productColINdex before add product name or stage: %d",R),_=[],A=0;A<=k.length;A++)"Can remove (Y/N)"===k[A]&&(S=A),"Lsl_typ"===k[A]&&(B=A);if(B-S-1>0)for(N=S+1;N<B;N++)F=k[N],O=x[1][N],F&&""!==F.trim()?(_.push({name:F.trim(),stage:O}),T=F.trim()):_.push({name:T,stage:O});if(-1!==R){t.next=58;break}if((L=c.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(U=L.getRange("F1:F1")).values=[[I]],!((M=k.indexOf("Can remove (Y/N)"))<0)){t.next=43;break}return v("Can't find Can remove col"),t.abrupt("return");case 43:if(!((P=k.indexOf("Lsl_typ"))<0)){t.next=47;break}return v("Can't find Lsl_typ col"),t.abrupt("return");case 47:for(Y=0,D=M;D<P;D++)j=d.getCell(0,D),isNaN(j)&&""===j||Y++;return H=["#C6EFCE","#FFEB9C","#FFC7CE","#D9E1F2"][Y%4],U.format.fill.color=H,L.getRange("F2:F2").values=[[E]],t.next=56,c.sync();case 56:t.next=86;break;case 58:return X=c.workbook.worksheets.getItem("Masterfile"),t.next=61,c.sync();case 61:return V=R,G=_.filter((function(e){return e.name===I})).length,console.log("stage ของ product %s มีอยู่แล้วจำนวน %d",I,G),v("stage ของ product %s มีอยู่แล้วจำนวน %d",I,G),X.getRangeByIndexes(0,V+1,1,1).insert(Excel.InsertShiftDirection.right),(d=X.getUsedRange()).load("rowCount"),t.next=71,c.sync();case 71:return W=d.rowCount,X.getRangeByIndexes(1,V+G,W,1).insert(Excel.InsertShiftDirection.right),d=X.getUsedRange(),t.next=77,c.sync();case 77:return X.getCell(1,V+G).values=[[E]],console.log("startcol for merge: %d stagecount for merge: %d",V,G),v("startcol for merge: %d stagecount for merge: %d",V,G),($=X.getRangeByIndexes(0,V,1,G)).values=Array(1).fill(Array(G).fill(I)),$.merge(),t.next=86,c.sync();case 86:return d=f.getUsedRange(),t.next=89,c.sync();case 89:return f.activate(),console.log("Completely added product name and stage"),v("Completely added product name and stage"),t.abrupt("return",fetch("https://limit-project-demo.onrender.com/process-self-converted-datalog/",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(t){var o=t.test_data;null!==o&&v("process-datalog-excel fetched successfully"),Excel.run(function(){var t=s(n().mark((function t(c){var s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,R,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H,X,V,G,W,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=c.workbook.worksheets.getItem("Masterfile"),(l=u.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:i=1e3,f=l.rowCount,d=l.columnCount,p=[],g=0;case 10:if(!(g<f)){t.next=20;break}return h=Math.min(i,f-g),(m=u.getRangeByIndexes(g,0,h,d)).load("values"),t.next=16,c.sync();case 16:p=p.concat(m.values);case 17:g+=i,t.next=10;break;case 20:if(x=p[0],y=x.indexOf("Test number"),b=x.indexOf("Suite name"),w=x.indexOf("Test name"),-1!==y){t.next=28;break}return console.error("ไม่พบคอลัมน์ Test number"),v("ไม่พบคอลัมน์ Test number"),t.abrupt("return");case 28:if(-1!==b){t.next=32;break}return console.error("ไม่พบคอลัมน์ Suite name"),v("ไม่พบคอลัมน์ Suite name"),t.abrupt("return");case 32:if(-1!==w){t.next=36;break}return console.error("ไม่พบคอลัมน์ Test name"),v("ไม่พบคอลัมน์ Test name"),t.abrupt("return");case 36:return(k=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=40,c.sync();case 40:v("Determined Allcolindex and testNamerange"),C=[],t.prev=42,C=k.values.flat().filter((function(e){return""!==e})),t.next=51;break;case 46:return t.prev=46,t.t0=t.catch(42),console.error("เกิดปัญหาขณะอ่าน testNameRange.values:",t.t0),v("เกิดปัญหาขณะอ่าน testNameRange.values: %s",t.t0.message||t.t0),t.abrupt("return");case 51:if(Array.isArray(o)){t.next=55;break}return console.error("TestData ไม่ใช่ array หรือยังไม่ได้โหลด"),v("TestData ไม่ใช่ array หรือยังไม่ได้โหลด"),t.abrupt("return");case 55:I=[],t.prev=56,I=o.filter((function(e){return!C.includes(e.test_name)})),t.next=65;break;case 60:return t.prev=60,t.t1=t.catch(56),console.error("เกิดปัญหาขณะ TestData.filter",t.t1),v("เกิดปัญหาขณะ TestData.filter: %s",t.t1.message||t.t1),t.abrupt("return");case 65:if(Array.isArray(p)){t.next=69;break}return console.error("allValues ไม่ใช่ array"),v("allValues ไม่ใช่ array"),t.abrupt("return");case 69:if(R=p.length,A=[],T=[],t.prev=72,!(I.length>0)){t.next=93;break}if(N=I.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),v("newTests.length = %d",I.length),-1!==y){t.next=79;break}return v("ไม่พบคอลัมน์ Test number ใน headers"),t.abrupt("return");case 79:return u.getRangeByIndexes(R,y,I.length,1).values=N,t.next=83,c.sync();case 83:return S=u.getRangeByIndexes(R,b,I.length,1),B=u.getRangeByIndexes(R,w,I.length,1),A=I.map((function(e){return[e.suite_name]})),T=I.map((function(e){return[e.test_name]})),S.values=A,B.values=T,t.next=91,c.sync();case 91:t.next=94;break;case 93:v("There's no new tests");case 94:t.next=100;break;case 96:t.prev=96,t.t2=t.catch(72),console.error("เกิดปัญหาในช่วงสร้าง newTests:",t.t2),v("เกิดปัญหาในช่วงสร้าง newTests: %s",t.t2.message||t.t2);case 100:if(F=new Uint8Array(a.target.result),O=XLSX.read(F,{type:"array"}),L=O.Sheets.mir,U=XLSX.utils.sheet_to_json(L,{defval:""}),M=null===(s=U[0])||void 0===s||null===(s=s.JOB_NAM)||void 0===s?void 0:s.trim(),-1!==(P=x.indexOf(M))){t.next=110;break}return console.error("ไม่พบชื่อ product ใน header:",M),v("ไม่พบชื่อ product ใน header:",M),t.abrupt("return");case 110:return _.push({name:M,stage:E}),Y=_.filter((function(e){return e.name===M})).length,(j=u.getRangeByIndexes(1,P,1,Y)).load("values"),t.next=116,c.sync();case 116:H=0;case 117:if(!(H<=Y)){t.next=125;break}if(console.log("stage %d = %s",H,j.values[0][H]),j.values[0][H]!==E){t.next=122;break}return D=H,t.abrupt("break",125);case 122:H++,t.next=117;break;case 125:return void 0===D&&(console.error("ไม่พบ stage name ใน column:",E),v("ไม่พบ stage name ใน column:",E)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",P,Y,D),v("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",P,Y,D),l=u.getUsedRange(),t.next=131,c.sync();case 131:return l.load(["rowCount","columnCount"]),t.next=134,c.sync();case 134:f=l.rowCount,d=l.columnCount,p=[],X=0;case 138:if(!(X<f)){t.next=148;break}return V=Math.min(i,f-X),(G=u.getRangeByIndexes(X,0,V,d)).load("values"),t.next=144,c.sync();case 144:p=p.concat(G.values);case 145:X+=i,t.next=138;break;case 148:return x=p[0],(W=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=153,c.sync();case 153:v("allTestNames length : %d",($=W.values.map((function(e){return e[0]}))).length),q=[];try{q=$.map((function(e){var t=o.find((function(t){return t.test_name===e}));return[t?t.YN_check:""]}))}catch(e){console.error("เกิดปัญหาในช่วงสร้าง YNValues:",e),v("เกิดปัญหาในช่วงสร้าง YNValues: %s",e.message||e)}return v("YNcolIndex : %d",P+D),(J=u.getRangeByIndexes(2,P+D,q.length,1)).load("values"),t.next=162,c.sync();case 162:return 0===q.length?(console.warn("ไม่มีข้อมูล Y/N check ที่จะเขียน"),v("ไม่มีข้อมูล Y/N check ที่จะเขียน")):(console.log("YN.length of %s %s is %d",M,E,q.length),v("YN.length of %s %s is %d",M,E,q.length)),J.values=q,t.next=166,c.sync();case 166:return z=x.indexOf("Is used (Y/N)"),(K=u.getRangeByIndexes(2,z,J.values.length,1)).load("values"),t.next=171,c.sync();case 171:for(Q=K.values,Array.isArray(Q)&&0!==Q.length||(Q=Array.from({length:J.values.length},(function(){return[""]}))),Z=0;Z<J.values.length;Z++)"Y"===J.values[Z][0]?("Partial"!==Q[Z][0]&&"No"!==Q[Z][0]||(Q[Z][0]="Partial"),"No"===Q[Z][0]?Q[Z][0]="Partial":Q[Z][0]="All"):"All"===Q[Z][0]||"Partial"===Q[Z][0]?Q[Z][0]="Partial":Q[Z][0]="No";return K.values=Q,t.next=177,c.sync();case 177:for((ee=J.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",ee.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},te=["All","Partial"],ne=["#C6EFCE","#FFEB9C"],re=K.conditionalFormats.count-1;re>=0;re--)K.conditionalFormats.getItemAt(re).delete();return t.next=185,c.sync();case 185:for(ae=0;ae<te.length;ae++)oe=te[ae],ce=ne[ae],(se=K.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=ce,se.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:oe};return t.next=188,c.sync();case 188:console.log("Finished processing one file"),v("Finished processing one file"),r++,e(r),document.body.style.cursor="default";case 193:case"end":return t.stop()}}),t,null,[[42,46],[56,60],[72,96]])})));return function(e){return t.apply(this,arguments)}}())})));case 93:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},o.onerror=a,o.readAsArrayBuffer(t)})));case 2:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return h=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var c=new FileReader;c.onload=function(){var o=s(n().mark((function o(c){var s,u,l,i,f,d,p,g,h,m,x,y,b,w;return n().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(s=new FormData).append("file",t),console.log("Uploading Excel Datalog to API: ".concat(t.name)),v("Uploading Excel Datalog to API: ".concat(t.name)),new Uint8Array(c.target.result),o.next=7,fetch("https://limit-project-demo.onrender.com/process-EY/",{method:"POST",body:s});case 7:if((u=o.sent).ok){o.next=12;break}return console.error("Upload failed"),v("Upload failed"),o.abrupt("return");case 12:return o.next=14,u.json();case 14:l=o.sent,i=l.data,f=[],g=[],h=r(i);try{for(h.s();!(m=h.n()).done;)x=m.value,p!==x.product?(p=x.product,d=x.stage,f.push({name:x.product,stage:x.stage}),g.push(p)):x.stage!==d&&(d=x.stage,f.push({name:x.product,stage:x.stage}))}catch(e){h.e(e)}finally{h.f()}console.log("All product: ",g),console.log("All EY stage and product: ",f),y=n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=w[b],a=f.filter((function(e){return e.name===t})),console.log("OneProduct_Allstage: ",a),o=r(a),e.prev=4,s=n().mark((function e(){var t,r,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,r=t.name,a=t.stage.toLowerCase(),e.next=5,k(r,a);case 5:return o=i.filter((function(e){return r===e.product&&t.stage===e.stage})),console.log("OneStage_data: ",o),e.next=9,I(o);case 9:return e.next=11,R(o,r,a);case 11:case"end":return e.stop()}}),e)})),o.s();case 7:if((c=o.n()).done){e.next=11;break}return e.delegateYield(s(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),o.e(e.t1);case 16:return e.prev=16,o.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})),b=0,w=g;case 24:if(!(b<w.length)){o.next=29;break}return o.delegateYield(y(),"t0",26);case 26:b++,o.next=24;break;case 29:v("Import EY file successfully"),a++,e(a);case 32:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),c.onerror=o,c.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function m(e){return x.apply(this,arguments)}function x(){return x=s(n().mark((function e(a){var o,c,u,l,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],c=[],u=[],l=[],i=[],e.next=7,Excel.run(function(){var e=s(n().mark((function e(f){var d,p,g,h,m,x,b,w,k,C,I,E;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,fetch("https://limit-project-demo.onrender.com/upload-folder/",{method:"POST",body:a});case 3:if((d=e.sent).ok){e.next=8;break}return console.error("Upload failed"),v("Upload failed"),e.abrupt("return");case 8:return v("Import Folder fetched successfully"),e.next=11,d.json();case 11:return p=e.sent,g=p.mfh_files||[],(h=document.getElementById("mfh-list")).innerHTML="",(m=f.workbook.worksheets).load("items/name"),e.next=19,f.sync();case 19:if(x="InputFiles",!m.items.map((function(e){return e.name})).includes(x)){e.next=25;break}b=m.getItem(x),e.next=34;break;case 25:return b=m.add(x),w=["File_Name"],(k=b.getRangeByIndexes(0,0,1,w.length)).values=[w],k.format.fill.color="#70d9ff",k.format.font.bold=!0,b.position=0,e.next=34,f.sync();case 34:if(x="Masterfile",m.items.map((function(e){return e.name})).includes(x)){e.next=48;break}return console.log("There is no Masterfile yet...Creating Masterfile"),v("There is no Masterfile yet...Creating Masterfile"),(I=f.workbook.worksheets).load("items/name"),e.next=43,f.sync();case 43:E="Masterfile",I.items.map((function(e){return e.name})).includes(E)||((C=I.add(E)).position=0),C.activate();case 48:g.forEach((function(e){var a=document.createElement("li");a.textContent="".concat(e," (ready)"),a.style.cursor="pointer",a.addEventListener("click",s(n().mark((function f(){var d,p;return n().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return document.querySelectorAll("li").forEach((function(e){e.classList.remove("selected-file")})),a.classList.add("selected-file"),f.next=4,fetch("https://limit-project-demo.onrender.com/process-testtable/?filename=".concat(encodeURIComponent(e)));case 4:if((d=f.sent).ok){f.next=9;break}return document.getElementById("download-links").innerHTML='<p style="color:red;">Failed to process '.concat(e,"</p>"),f.abrupt("return");case 9:return a.textContent=e,f.next=12,d.json();case 12:return y((p=f.sent).files),f.next=16,Excel.run(function(){var e=s(n().mark((function e(a){var s,f,d,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H,X,V,G,W,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se,ue,le,ie,fe,de,pe,ge,he,me,xe,ye,ve,be,we,ke,Ce,Ie,Ee,Re,_e,Se,Be,Ae,Te,Ne,Fe,Oe,Le,Ue,Me,Pe,Ye,De,je,He,Xe,Ve,Ge,We,$e,qe,Je,ze,Ke,Qe,Ze,et;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.body.style.cursor="wait",s=a.workbook.worksheets.getItem("Masterfile"),f=[],d=0;case 4:if(!(d<p.files.length)){e.next=75;break}return(g=s.getUsedRange()).load(["values","rowCount","columnCount"]),e.next=9,a.sync();case 9:return h=g.values[0]||[],m=g.values[1]||[],e.next=13,a.sync();case 13:if("ok"!==(x=p.files[d]).status||!Array.isArray(x.content)){e.next=72;break}if(y=x.content[0],b=x.content[1],0!==d){e.next=57;break}w=0;case 19:if(!(w<y.length)){e.next=34;break}if(k=y[w],C=b[w],f.push({name:k,stage:C}),!k||k===(h[w]||"")){e.next=27;break}return s.getCell(0,w).values=[[k]],e.next=27,a.sync();case 27:if(!C||C===m[w]){e.next=31;break}return s.getCell(1,w).values=[[C]],e.next=31,a.sync();case 31:w++,e.next=19;break;case 34:return g.load(["rowCount","columnCount"]),e.next=37,a.sync();case 37:I=a.workbook.worksheets.getItem("Masterfile"),E=1e3,R=g.rowCount,_=g.columnCount,S=[],B=0;case 43:if(!(B<R)){e.next=53;break}return A=Math.min(E,R-B),(T=I.getRangeByIndexes(B,0,A,_)).load("values"),e.next=49,a.sync();case 49:S=S.concat(T.values);case 50:B+=E,e.next=43;break;case 53:h=S[0],m=S[1],e.next=70;break;case 57:return g.load(["rowCount","columnCount"]),e.next=60,a.sync();case 60:if(NaN!==(N=h.indexOf("Units"))){e.next=63;break}return e.abrupt("return");case 63:F=n().mark((function e(){var t,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y[O],r=b[O],"Lsl"!==t&&"Usl"!==t){e.next=21;break}if(void 0!==(o=f.find((function(e){return e.stage===r})))&&""!==o){e.next=21;break}return v("new stage is %s",r),f.push({name:t,stage:r}),s.getRangeByIndexes(0,N+3,g.rowCount,2).insert(Excel.InsertShiftDirection.right),v("Insert new col"),e.next=12,a.sync();case 12:return g.load(["rowCount","columnCount"]),e.next=15,a.sync();case 15:return s.getCell(0,N+3).values=[["Lsl"]],s.getCell(0,N+4).values=[["Usl"]],s.getCell(1,N+3).values=r,s.getCell(1,N+4).values=r,e.next=21,a.sync();case 21:case"end":return e.stop()}}),e)})),O=0;case 65:if(!(O<h.length)){e.next=70;break}return e.delegateYield(F(),"t0",67);case 67:O++,e.next=65;break;case 70:return e.next=72,a.sync();case 72:d++,e.next=4;break;case 75:return e.next=77,a.sync();case 77:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=81,a.sync();case 81:U=a.workbook.worksheets.getItem("Masterfile"),M=1e3,P=L.rowCount,Y=L.columnCount,D=[],j=0;case 87:if(!(j<P)){e.next=97;break}return H=Math.min(M,P-j),(X=U.getRangeByIndexes(j,0,H,Y)).load("values"),e.next=93,a.sync();case 93:D=D.concat(X.values);case 94:j+=M,e.next=87;break;case 97:return V=D[0],G=D[1],W=L.rowCount,e.next=102,a.sync();case 102:return $=[],q=[],J=[],z=[],K=[],Q=[],Z=[],ee=[],te=[],ne=[],re=[],ae=[],oe=[],(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=119,a.sync();case 119:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],ce=0;case 124:if(!(ce<P)){e.next=134;break}return se=Math.min(M,P-ce),(ue=U.getRangeByIndexes(ce,0,se,Y)).load("values"),e.next=130,a.sync();case 130:D=D.concat(ue.values);case 131:ce+=M,e.next=124;break;case 134:return V=D[0],G=D[1],e.next=138,a.sync();case 138:if(console.log(G),$=G.filter((function(e){return"w"===e[0]})),q=G.filter((function(e){return"f"===e[0]})),J=G.filter((function(e){return"a"===e[0]})),console.log($),console.log(q),console.log(J),z=$.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wh",""))-parseInt(t[0].replace("wh",""))})),K=$.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wr",""))-parseInt(t[0].replace("wr",""))})),Q=$.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wc",""))-parseInt(t[0].replace("wc",""))})),Z=$.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wi",""))-parseInt(t[0].replace("wi",""))})),ee=$.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("ww",""))-parseInt(t[0].replace("ww",""))})),console.log(z),console.log(K),console.log(Q),console.log(ee),console.log(Z),$=[],0!==z.length&&(le=$).push.apply(le,t(z)),0!==K.length&&(ie=$).push.apply(ie,t(K)),0!==Q.length&&(fe=$).push.apply(fe,t(Q)),0!==ee.length&&(de=$).push.apply(de,t(ee)),0!==Z.length&&(pe=$).push.apply(pe,t(Z)),o.push.apply(o,t($)),te=q.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fh",""))-parseInt(t[0].replace("fh",""))})),ne=q.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fr",""))-parseInt(t[0].replace("fr",""))})),re=q.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fc",""))-parseInt(t[0].replace("fc",""))})),ae=q.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fi",""))-parseInt(t[0].replace("fi",""))})),oe=q.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fw",""))-parseInt(t[0].replace("fw",""))})),console.log(te),console.log(ne),console.log(re),console.log(oe),console.log(ae),q=[],0!==te.length&&(ge=q).push.apply(ge,t(te)),0!==ne.length&&(he=q).push.apply(he,t(ne)),0!==re.length&&(me=q).push.apply(me,t(re)),0!==oe.length&&(xe=q).push.apply(xe,t(oe)),0!==ae.length&&(ye=q).push.apply(ye,t(ae)),o.push.apply(o,t(q)),o.push.apply(o,t(J)),ve=z.filter((function(e,t){return t%2==0})),be=K.filter((function(e,t){return t%2==0})),we=Q.filter((function(e,t){return t%2==0})),ke=Z.filter((function(e,t){return t%2==0})),Ce=ee.filter((function(e,t){return t%2==0})),Ie=te.filter((function(e,t){return t%2==0})),Ee=ne.filter((function(e,t){return t%2==0})),Re=re.filter((function(e,t){return t%2==0})),_e=ae.filter((function(e,t){return t%2==0})),Se=oe.filter((function(e,t){return t%2==0})),Be=J.filter((function(e,t){return t%2==0})),Ae=[],ve.forEach((function(e){Ie.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),be.forEach((function(e){Ee.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),we.forEach((function(e){Re.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),ke.forEach((function(e){_e.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),Ce.forEach((function(e){Se.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),Ee.forEach((function(e){Be.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Ae.push({id:n,label:r})}))})),ve.forEach((function(e,t){ve.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),be.forEach((function(e,t){be.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),we.forEach((function(e,t){we.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),ke.forEach((function(e,t){ke.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),Ce.forEach((function(e,t){Ce.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),Ie.forEach((function(e,t){Ie.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),Ee.forEach((function(e,t){Ee.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),Re.forEach((function(e,t){Re.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),_e.forEach((function(e,t){_e.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),Se.forEach((function(e,t){Se.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Ae.push({id:a,label:o})}}))})),console.log(Ae),Ae.forEach((function(e){var t=document.createElement("label");t.className="label-item";var n=document.createElement("input");n.type="checkbox",n.id=e.id,n.name="stagePair",n.value=e.id,t.appendChild(n),t.appendChild(document.createTextNode(" ".concat(e.label))),labelList.appendChild(t);var r=e.label.slice(0,3),a=e.label.slice(-3);u.push.apply(u,[r]),l.push.apply(l,[a]);var o=["LL "+r.toUpperCase()+" ? "+a.toUpperCase(),"UL "+r.toUpperCase()+" ? "+a.toUpperCase()];c.push.apply(c,o)})),console.log("Allpair: ",c),Te=G.indexOf("Spec"),!isNaN(Te)){e.next=215;break}return v("Can't find Spec column!"),e.abrupt("return");case 215:return v("Spec index is %d",Te),s.getRangeByIndexes(1,Te+2,1,o.length).values=[o],e.next=220,a.sync();case 220:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=224,a.sync();case 224:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],Ne=0;case 229:if(!(Ne<P)){e.next=239;break}return Fe=Math.min(M,P-Ne),(Oe=U.getRangeByIndexes(Ne,0,Fe,Y)).load("values"),e.next=235,a.sync();case 235:D=D.concat(Oe.values);case 236:Ne+=M,e.next=229;break;case 239:return V=D[0],G=D[1],W=L.rowCount,e.next=244,a.sync();case 244:Le=r(p.files),e.prev=245,Le.s();case 247:if((Ue=Le.n()).done){e.next=288;break}if("ok"!==(Me=Ue.value).status||!Array.isArray(Me.content)){e.next=286;break}Pe=Me.content[0],Ye=Me.content[1],De=2;case 253:if(!(De<Me.content.length)){e.next=286;break}je=Me.content[De],He=[],Xe=0;case 257:if(!(Xe<V.length)){e.next=280;break}if("Lsl"!==(Ve=V[Xe])&&"Usl"!==Ve){e.next=274;break}if(Ge=G[Xe],"Lsl"!==Ve){e.next=268;break}if(NaN!==(We=Ye.indexOf(Ge))){e.next=265;break}return e.abrupt("continue",277);case 265:He.push(-1!==We?je[We]:""),e.next=272;break;case 268:if(NaN!==($e=Ye.indexOf(Ge))){e.next=271;break}return e.abrupt("continue",277);case 271:He.push(-1!==$e?je[$e+1]:"");case 272:e.next=277;break;case 274:qe=V.indexOf(Ve),Je=Pe.indexOf(Ve),-1!==qe&&-1!==Je&&(He[qe]=je[Je]);case 277:Xe++,e.next=257;break;case 280:s.getRangeByIndexes(W,0,1,V.length).values=[He],W++;case 283:De++,e.next=253;break;case 286:e.next=247;break;case 288:e.next=293;break;case 290:e.prev=290,e.t1=e.catch(245),Le.e(e.t1);case 293:return e.prev=293,Le.f(),e.finish(293);case 296:return e.next=298,a.sync();case 298:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=302,a.sync();case 302:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],ze=0;case 307:if(!(ze<P)){e.next=317;break}return Ke=Math.min(M,P-ze),(Qe=U.getRangeByIndexes(ze,0,Ke,Y)).load("values"),e.next=313,a.sync();case 313:D=D.concat(Qe.values);case 314:ze+=M,e.next=307;break;case 317:return V=D[0],G=D[1],W=L.rowCount,Ze=V.indexOf("Bin_s_num"),e.next=323,a.sync();case 323:return s.getRangeByIndexes(0,Ze,L.rowCount,2).insert(Excel.InsertShiftDirection.right),e.next=326,a.sync();case 326:return s.getCell(0,Ze).values=[["All LL ? Spec"]],s.getCell(0,Ze+1).values=[["All UL ? Spec"]],L.load(["rowCount","columnCount"]),e.next=331,a.sync();case 331:return s.getRangeByIndexes(0,Ze+2,L.rowCount,o.length).insert(Excel.InsertShiftDirection.right),L.load(["rowCount","columnCount"]),e.next=335,a.sync();case 335:for(et=Te+2;et<Te+2+o.length;et+=2)i.push.apply(i,["LL Spec? "+G[et],"UL Spec? "+G[et]]);return console.log(i),console.log("limit_compare contains undefined?",i.includes(void 0)),console.log("limit_compare contains null?",i.includes(null)),s.getRangeByIndexes(0,Ze+2,1,i.length).values=[i],e.next=342,a.sync();case 342:document.body.style.cursor="default";case 343:case"end":return e.stop()}}),e,null,[[245,290,293,296]])})));return function(t){return e.apply(this,arguments)}}());case 16:return f.next=18,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,c,s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H,X,V;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sync();case 2:return e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:return document.body.style.cursor="wait",r=t.workbook.worksheets.getItem("Masterfile"),(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:c=t.workbook.worksheets.getItem("Masterfile"),s=1e3,u=a.rowCount,l=a.columnCount,i=[],f=0;case 16:if(!(f<u)){e.next=26;break}return d=Math.min(s,u-f),(p=c.getRangeByIndexes(f,0,d,l)).load("values"),e.next=22,t.sync();case 22:i=i.concat(p.values);case 23:f+=s,e.next=16;break;case 26:for(g=i[0],h=i[1],m=i,x=a.rowCount,y=a.columnCount,v("rowCount : %d columnCount : %d",x,y),b=h.indexOf("Spec"),w=g.indexOf("All LL ? Spec"),k=g.indexOf("All UL ? Spec"),v("LLspecIndex : %d",b),C=b+o.length+2,I=[],E=2;E<m.length;E++){for(R=[],_=b;_<=C;_++)R.push(m[E][_]);I.push(R)}S=g.indexOf("All UL ? Spec")+1,B=[],A=[],T=[],v("Limit length : %d",I.length),N=0;case 45:if(!(N<I.length)){e.next=73;break}F=I[N],O=F[0],L=F[1],U="In-spec",M="In-spec",T[N]=[],P=2;case 53:if(!(P+1<F.length)){e.next=68;break}if(Y=F[P],D=F[P+1],void 0!==Y&&void 0!==D){e.next=59;break}return console.warn("Missing LSL/USL at row ".concat(N,", columns ").concat(P," and ").concat(P+1)),e.abrupt("continue",65);case 59:j="",H="",""===Y||null==Y||isNaN(Y)||(Y>=O?j=O<Y?"Widen":"Same":(U="Out-spec",j="Tighten")),""===D||null==D||isNaN(D)||(D<=L?H=L>D?"Widen":"Same":(M="Out-spec",H="Tighten")),T[N].push(j),T[N].push(H);case 65:P+=2,e.next=53;break;case 68:B.push([U]),A.push([M]);case 70:N++,e.next=45;break;case 73:return r.getRangeByIndexes(2,S,T.length,T[0].length).values=T,e.next=76,t.sync();case 76:return v("All_LL_spec length : %d",B.length),v("All_UL_spec length : %d",A.length),X=r.getRangeByIndexes(2,w,B.length,1),V=r.getRangeByIndexes(2,k,A.length,1),X.values=B,V.values=A,e.next=84,t.sync();case 84:return r.getRangeByIndexes(0,3,x,2).insert(Excel.InsertShiftDirection.right),r.getCell(0,3).values="Is used (Y/N)",r.getCell(0,4).values="Can remove (Y/N)",e.next=90,t.sync();case 90:v("Limit Compare Successed"),document.body.style.cursor="default";case 92:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:return f.next=20,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,s,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,t.sync();case 3:return r=t.workbook.worksheets.getItem("Masterfile"),e.next=6,t.sync();case 6:return(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:s=t.workbook.worksheets.getItem("Masterfile"),f=1e3,d=a.rowCount,p=a.columnCount,g=[],h=0;case 16:if(!(h<d)){e.next=26;break}return m=Math.min(f,d-h),(x=s.getRangeByIndexes(h,0,m,p)).load("values"),e.next=22,t.sync();case 22:g=g.concat(x.values);case 23:h+=f,e.next=16;break;case 26:return y=g[0],b=g[1],e.next=30,t.sync();case 30:return v("Bin s index: %d",w=y.indexOf("Bin_s_num")),r.getRangeByIndexes(0,w,a.rowCount,c.length).insert(Excel.InsertShiftDirection.right),r.getRangeByIndexes(0,w,1,c.length).values=[c],e.next=36,t.sync();case 36:for(v("LLspecIndex : %d",k=b.indexOf("Spec")),C=k+o.length+2,I=[],E=2;E<g.length;E++){for(R=[],_=k;_<=C;_++)R.push(g[E][_]);I.push(R)}S=[],B=0;case 43:if(!(B<u.length)){e.next=55;break}if(A=u[B],T=l[B],N=b.indexOf(A),F=b.indexOf(T),!(N<0||F<0)){e.next=51;break}return console.warn("ไม่พบ stage: ".concat(A," หรือ ").concat(T)),e.abrupt("continue",52);case 51:for(O=0;O<I.length;O++)L=I[O],U=L[N-k],M=L[N-k+1],P=L[F-k],Y=L[F-k+1],D="",j="",""===U||null==U||isNaN(U)||""===P||null==P||isNaN(P)||(D=U<P?"Widen":U>P?"Tighten":"Same"),""===M||null==M||isNaN(M)||""===Y||null==Y||isNaN(Y)||(j=M>Y?"Widen":M<Y?"Tighten":"Same"),S[O]||(S[O]=[]),S[O].push(D),S[O].push(j);case 52:B++,e.next=43;break;case 55:if(console.log("All compare:",S),H=y.indexOf(i[i.length-1]),console.log(H),!(H<0)){e.next=61;break}return v("Can't find last spec vs limit col"),e.abrupt("return");case 61:return r.getRangeByIndexes(2,H+1,S.length,S[0].length).values=S,e.next=64,t.sync();case 64:document.body.style.cursor="default";case 65:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:return f.next=22,Excel.run(function(){var t=s(n().mark((function t(r){var a,o,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("InputFiles"),(o=a.getUsedRange()).load("rowCount"),t.next=6,r.sync();case 6:return c=o.rowCount,a.getRangeByIndexes(c,0,1,1).values=[[e]],t.next=11,r.sync();case 11:v("Successfully limit files imported"),document.body.style.cursor="default";case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 22:case"end":return f.stop()}}),f)})))),h.appendChild(a)})),document.body.style.cursor="default";case 50:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function y(e){document.body.style.cursor="wait";var t=document.getElementById("download-links");t.innerHTML="",e.forEach((function(e){var n=document.createElement("div");n.innerHTML="\n      <p><b>".concat(e.path,"</b> - ").concat(e.status,"</p>\n    "),t.appendChild(n)})),document.body.style.cursor="default"}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=document.getElementById("consoleOutput"),o=e,c=0;o=o.replace(/%[sdif]/g,(function(e){var t=n[c++];switch(e){case"%d":case"%i":return parseInt(t);case"%f":return parseFloat(t).toFixed(2);default:return String(t)}}));var s=document.createElement("div");s.textContent="> ".concat(o),a.appendChild(s),a.scrollTop=a.scrollHeight}function b(e,t){return w.apply(this,arguments)}function w(){return w=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o.workbook.worksheets.load("items/name"),e.next=5,o.sync();case 5:return c=o.workbook.worksheets.getItem("Masterfile"),s=c.getUsedRange(),e.next=9,o.sync();case 9:return s.load(["rowCount","columnCount"]),e.next=12,o.sync();case 12:console.log(s.rowCount),u=1e3,l=s.rowCount,i=s.columnCount,f=[],d=0;case 18:if(!(d<l)){e.next=28;break}return p=Math.min(u,l-d),(g=c.getRangeByIndexes(d,0,p,i)).load("values"),e.next=24,o.sync();case 24:f=f.concat(g.values);case 25:d+=u,e.next=18;break;case 28:h=f[0],y=r(t),e.prev=30,y.s();case 32:if((b=y.n()).done){e.next=57;break}if(w=b.value,k=w.slice(0,3),C=w.slice(-3),m="LL "+k.toUpperCase()+" ? "+C.toUpperCase(),console.log(m),-1!==(x=h.indexOf(m))){e.next=42;break}return v("can't find an index to hide"),e.abrupt("return");case 42:return v("Hiding : %s ? %s",k.toUpperCase(),C.toUpperCase()),e.prev=43,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!0,e.next=50,o.sync();case 50:e.next=55;break;case 52:e.prev=52,e.t0=e.catch(43),console.log("Can't hide col due to: ",e.t0);case 55:e.next=32;break;case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(30),y.e(e.t1);case 62:return e.prev=62,y.f(),e.finish(62);case 65:return e.next=67,o.sync();case 67:I=r(a),e.prev=68,I.s();case 70:if((E=I.n()).done){e.next=95;break}if(R=E.value,_=R.slice(0,3),S=R.slice(-3),m="LL "+_.toUpperCase()+" ? "+S.toUpperCase(),-1!==(x=h.indexOf(m))){e.next=79;break}return v("can't find an index to hide"),e.abrupt("return");case 79:return e.prev=79,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!1,e.next=86,o.sync();case 86:e.next=91;break;case 88:e.prev=88,e.t2=e.catch(79),console.log("Can't show col due to: ",e.t2);case 91:return e.next=93,o.sync();case 93:e.next=70;break;case 95:e.next=100;break;case 97:e.prev=97,e.t3=e.catch(68),I.e(e.t3);case 100:return e.prev=100,I.f(),e.finish(100);case 103:document.body.style.cursor="default";case 104:case"end":return e.stop()}}),e,null,[[30,59,62,65],[43,52],[68,97,100,103],[79,88]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return C=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("productName in Check_product_stage: ",t),console.log("stagename in Check_product_stage: ",r),e.next=4,Excel.run(function(){var e=s(n().mark((function e(a){var o,c,s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o=a.workbook.worksheets.getItem("Masterfile"),(c=o.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,a.sync();case 6:s=a.workbook.worksheets.getItem("Masterfile"),u=1e3,l=c.rowCount,i=c.columnCount,f=[],d=0;case 12:if(!(d<l)){e.next=22;break}return p=Math.min(u,l-d),(g=s.getRangeByIndexes(d,0,p,i)).load("values"),e.next=18,a.sync();case 18:f=f.concat(g.values);case 19:d+=u,e.next=12;break;case 22:for(h=f[0],console.log("headers: ",h),m=h.indexOf(t),console.log("productColINdex before add product name or stage: %d",m),v("productColINdex before add product name or stage: %d",m),x=[],w=0;w<=h.length;w++)"Can remove (Y/N)"===h[w]&&(y=w),"Lsl_typ"===h[w]&&(b=w);if(b-y-1>0)for(C=y+1;C<b;C++)I=h[C],E=f[1][C],I&&""!==I.trim()?(x.push({name:I.trim(),stage:E}),k=I.trim()):x.push({name:k,stage:E});if(-1!==m){e.next=56;break}if((R=a.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(_=R.getRange("F1:F1")).values=[[t]],!((S=h.indexOf("Can remove (Y/N)"))<0)){e.next=41;break}return v("Can't find Can remove col"),e.abrupt("return");case 41:if(!((B=h.indexOf("Lsl_typ"))<0)){e.next=45;break}return v("Can't find Lsl_typ col"),e.abrupt("return");case 45:for(A=0,T=S;T<B;T++)N=c.getCell(0,T),isNaN(N)&&""===N||A++;return F=["#C6EFCE","#FFEB9C","#FFC7CE","#D9E1F2"][A%4],_.format.fill.color=F,R.getRange("F2:F2").values=[[r]],e.next=54,a.sync();case 54:e.next=84;break;case 56:return O=a.workbook.worksheets.getItem("Masterfile"),e.next=59,a.sync();case 59:return L=m,U=x.filter((function(e){return e.name===t})).length,console.log("stage ของ product %s มีอยู่แล้วจำนวน %d",t,U),v("stage ของ product %s มีอยู่แล้วจำนวน %d",t,U),O.getRangeByIndexes(0,L+1,1,1).insert(Excel.InsertShiftDirection.right),(c=O.getUsedRange()).load("rowCount"),e.next=69,a.sync();case 69:return M=c.rowCount,O.getRangeByIndexes(1,L+U,M,1).insert(Excel.InsertShiftDirection.right),c=O.getUsedRange(),e.next=75,a.sync();case 75:return O.getCell(1,L+U).values=[[r]],console.log("startcol for merge: %d stagecount for merge: %d",L,U),v("startcol for merge: %d stagecount for merge: %d",L,U),(P=O.getRangeByIndexes(0,L,1,U)).values=Array(1).fill(Array(U).fill(t)),P.merge(),e.next=84,a.sync();case 84:document.body.style.cursor="default";case 85:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function I(e){return E.apply(this,arguments)}function E(){return E=s(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("data from EY oneproduct: ",t),e.next=3,Excel.run(function(){var e=s(n().mark((function e(r){var a,o,c,s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("Masterfile"),(o=a.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,r.sync();case 6:c=1e3,s=o.rowCount,u=o.columnCount,l=[],i=0;case 11:if(!(i<s)){e.next=21;break}return f=Math.min(c,s-i),(d=a.getRangeByIndexes(i,0,f,u)).load("values"),e.next=17,r.sync();case 17:l=l.concat(d.values);case 18:i+=c,e.next=11;break;case 21:if(p=l[0],g=p.indexOf("Test number"),h=p.indexOf("Suite name"),m=p.indexOf("Test name"),-1!==g){e.next=29;break}return console.error("ไม่พบคอลัมน์ Test number"),v("ไม่พบคอลัมน์ Test number"),e.abrupt("return");case 29:if(-1!==h){e.next=33;break}return console.error("ไม่พบคอลัมน์ Suite name"),v("ไม่พบคอลัมน์ Suite name"),e.abrupt("return");case 33:if(-1!==m){e.next=37;break}return console.error("ไม่พบคอลัมน์ Test name"),v("ไม่พบคอลัมน์ Test name"),e.abrupt("return");case 37:return(x=a.getRangeByIndexes(2,m,l.length-2,1)).load("values"),e.next=41,r.sync();case 41:v("Determined Allcolindex and testNamerange"),y=[],e.prev=43,y=x.values.flat().filter((function(e){return""!==e})),e.next=52;break;case 47:return e.prev=47,e.t0=e.catch(43),console.error("เกิดปัญหาขณะอ่าน testNameRange.values:",e.t0),v("เกิดปัญหาขณะอ่าน testNameRange.values: %s",e.t0.message||e.t0),e.abrupt("return");case 52:if(Array.isArray(t)){e.next=56;break}return console.error("data ไม่ใช่ array หรือยังไม่ได้โหลด"),v("data ไม่ใช่ array หรือยังไม่ได้โหลด"),e.abrupt("return");case 56:b=[],e.prev=57,b=t.filter((function(e){return!y.includes(e.test_name)})),console.log("newTests from EY: ",b),e.next=67;break;case 62:return e.prev=62,e.t1=e.catch(57),console.error("เกิดปัญหาขณะ data.filter",e.t1),v("เกิดปัญหาขณะ data.filter: %s",e.t1.message||e.t1),e.abrupt("return");case 67:if(Array.isArray(l)){e.next=71;break}return console.error("allValues ไม่ใช่ array"),v("allValues ไม่ใช่ array"),e.abrupt("return");case 71:if(w=l.length,I=[],E=[],!(b.length>0)){e.next=94;break}if(R=b.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),v("newTests.length = %d",b.length),-1!==g){e.next=80;break}return v("ไม่พบคอลัมน์ Test number ใน headers"),e.abrupt("return");case 80:return a.getRangeByIndexes(w,g,b.length,1).values=R,e.next=84,r.sync();case 84:return k=a.getRangeByIndexes(w,h,b.length,1),C=a.getRangeByIndexes(w,m,b.length,1),I=b.map((function(e){return[e.suite_name]})),E=b.map((function(e){return[e.test_name]})),k.values=I,C.values=E,e.next=92,r.sync();case 92:e.next=95;break;case 94:v("There's no new tests");case 95:document.body.style.cursor="default";case 96:case"end":return e.stop()}}),e,null,[[43,47],[57,62]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),E.apply(this,arguments)}function R(e,t,n){return _.apply(this,arguments)}function _(){return _=s(n().mark((function e(t,r,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,l,i,f,d,p,g,h,m,x,y,b,w,k,C,I,E,R,_,S,B,A,T,N,F,O,L,U,M,P,Y,D,j,H,X,V,G,W,$,q;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",c=o.workbook.worksheets.getItem("Masterfile"),(s=c.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,o.sync();case 6:u=1e3,l=s.rowCount,i=s.columnCount,f=[],d=0;case 11:if(!(d<l)){e.next=21;break}return p=Math.min(u,l-d),(g=c.getRangeByIndexes(d,0,p,i)).load("values"),e.next=17,o.sync();case 17:f=f.concat(g.values);case 18:d+=u,e.next=11;break;case 21:for(h=f[0],m=[],b=0;b<=h.length;b++)"Can remove (Y/N)"===h[b]&&(x=b),"Lsl_typ"===h[b]&&(y=b);if(y-x-1>0)for(k=x+1;k<y;k++)C=h[k],I=f[1][k],C&&""!==C.trim()?(m.push({name:C.trim(),stage:I}),w=C.trim()):m.push({name:w,stage:I});if(E=h.indexOf("Test number"),R=h.indexOf("Suite name"),_=h.indexOf("Test name"),-1!==E){e.next=33;break}return console.error("ไม่พบคอลัมน์ Test number"),v("ไม่พบคอลัมน์ Test number"),e.abrupt("return");case 33:if(-1!==R){e.next=37;break}return console.error("ไม่พบคอลัมน์ Suite name"),v("ไม่พบคอลัมน์ Suite name"),e.abrupt("return");case 37:if(-1!==_){e.next=41;break}return console.error("ไม่พบคอลัมน์ Test name"),v("ไม่พบคอลัมน์ Test name"),e.abrupt("return");case 41:if(-1!==(S=h.indexOf(r))){e.next=46;break}return console.error("ไม่พบชื่อ product ใน header:",r),v("ไม่พบชื่อ product ใน header:",r),e.abrupt("return");case 46:return B=m.filter((function(e){return e.name===r})).length,(T=c.getRangeByIndexes(1,S,1,B)).load("values"),e.next=51,o.sync();case 51:N=0;case 52:if(!(N<=B)){e.next=60;break}if(console.log("stage %d = %s",N,T.values[0][N]),T.values[0][N]!==a){e.next=57;break}return A=N,e.abrupt("break",60);case 57:N++,e.next=52;break;case 60:return void 0===A&&(console.error("ไม่พบ stage name ใน column:",a),v("ไม่พบ stage name ใน column:",a)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",S,B,A),v("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",S,B,A),(F=c.getRangeByIndexes(2,_,f.length-2,1)).load("values"),e.next=67,o.sync();case 67:v("allTestNames length : %d",(O=F.values.map((function(e){return e[0]}))).length),L=[];try{L=O.map((function(e){var n=t.find((function(t){return t.test_name===e}));return[n?n.YN_check:""]}))}catch(e){console.error("เกิดปัญหาในช่วงสร้าง YNValues:",e),v("เกิดปัญหาในช่วงสร้าง YNValues: %s",e.message||e)}return v("YNcolIndex : %d",S+A),(U=c.getRangeByIndexes(2,S+A,L.length,1)).load("values"),e.next=76,o.sync();case 76:return 0===L.length?(console.warn("ไม่มีข้อมูล Y/N check ที่จะเขียน"),v("ไม่มีข้อมูล Y/N check ที่จะเขียน")):(console.log("YN.length of %s %s is %d",r,a,L.length),v("YN.length of %s %s is %d",r,a,L.length)),U.values=L,e.next=80,o.sync();case 80:return M=h.indexOf("Is used (Y/N)"),(P=c.getRangeByIndexes(2,M,U.values.length,1)).load("values"),e.next=85,o.sync();case 85:for(Y=P.values,Array.isArray(Y)&&0!==Y.length||(Y=Array.from({length:U.values.length},(function(){return[""]}))),D=0;D<U.values.length;D++)"Y"===U.values[D][0]?("Partial"!==Y[D][0]&&"No"!==Y[D][0]||(Y[D][0]="Partial"),"No"===Y[D][0]?Y[D][0]="Partial":""===Y[D][0]&&(Y[D][0]="All")):"All"===Y[D][0]||"Partial"===Y[D][0]?Y[D][0]="Partial":Y[D][0]="No";return P.values=Y,e.next=91,o.sync();case 91:return(j=U.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",j.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},P.conditionalFormats.load("count"),e.next=97,o.sync();case 97:for(H=P.conditionalFormats.count-1;H>=0;H--)P.conditionalFormats.getItemAt(H).delete();return e.next=100,o.sync();case 100:for(X=["Partial","All"],V=["#FFEB9C","#C6EFCE"],G=0;G<X.length;G++)W=X[G],$=V[G],(q=P.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=$,q.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:W};return e.next=105,o.sync();case 105:document.body.style.cursor="default";case 106:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=u,document.getElementById("importFolderBtn").addEventListener("click",s(n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=document.getElementById("folderInput").files).length){e.next=4;break}return alert("Please select a folder first."),e.abrupt("return");case 4:a=new FormData,o=r(t);try{for(o.s();!(c=o.n()).done;)s=c.value,a.append("files",s,s.webkitRelativePath)}catch(e){o.e(e)}finally{o.f()}return e.next=9,m(a);case 9:case"end":return e.stop()}}),e)}))));var t=document.getElementById("importDatalogBtn");t&&t.addEventListener("click",i),document.getElementById("compareAll").addEventListener("click",s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelectorAll("#checkboxForm input[type='checkbox']").forEach((function(e){e.checked=!e.checked}));case 2:case"end":return e.stop()}}),e)})))),document.getElementById("compare").addEventListener("click",s(n().mark((function e(){var t,r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelectorAll("#checkboxForm input[type='checkbox']"),r=Array.from(t).filter((function(e){return!e.checked})).map((function(e){return e.value})),console.log(r),a=Array.from(t).filter((function(e){return e.checked})).map((function(e){return e.value})),console.log(a),e.next=7,b(r,a);case 7:case"end":return e.stop()}}),e)}))))}}))}(),new URL(n(58394),n.b),new URL(n(86679),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map