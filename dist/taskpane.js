/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"21ee818572af74978545.css"},60947:function(e,t,n){e.exports=n.p+"d56e51b571d856ffb9d9.js"}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||a(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(){n=function(){return r};var t,r={},a=Object.prototype,o=a.hasOwnProperty,c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",i=c.toStringTag||"@@toStringTag";function l(e,t,n,r){return Object.defineProperty(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r})}try{l({},"")}catch(t){l=function(e,t,n){return e[t]=n}}function f(e,n,r,a){var o=n&&n.prototype instanceof g?n:g,c=Object.create(o.prototype);return l(c,"_invoke",function(e,n,r){var a=1;return function(o,c){if(3===a)throw Error("Generator is already running");if(4===a){if("throw"===o)throw c;return{value:t,done:!0}}for(r.method=o,r.arg=c;;){var s=r.delegate;if(s){var u=C(s,r);if(u){if(u===p)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(1===a)throw a=4,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=3;var i=d(e,n,r);if("normal"===i.type){if(a=r.done?4:2,i.arg===p)continue;return{value:i.arg,done:r.done}}"throw"===i.type&&(a=4,r.method="throw",r.arg=i.arg)}}}(e,r,new R(a||[])),!0),c}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}r.wrap=f;var p={};function g(){}function h(){}function m(){}var x={};l(x,s,(function(){return this}));var y=Object.getPrototypeOf,v=y&&y(y(_([])));v&&v!==a&&o.call(v,s)&&(x=v);var b=m.prototype=g.prototype=Object.create(x);function w(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(t,n){function r(a,c,s,u){var i=d(t[a],t,c);if("throw"!==i.type){var l=i.arg,f=l.value;return f&&"object"==e(f)&&o.call(f,"__await")?n.resolve(f.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):n.resolve(f).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(i.arg)}var a;l(this,"_invoke",(function(e,t){function o(){return new n((function(n,a){r(e,t,n,a)}))}return a=a?a.then(o,o):o()}),!0)}function C(e,n){var r=n.method,a=e.i[r];if(a===t)return n.delegate=null,"throw"===r&&e.i.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var o=d(a,e.i,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,p;var c=o.arg;return c?c.done?(n[e.r]=c.value,n.next=e.n,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,p):c:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,p)}function E(e){this.tryEntries.push(e)}function I(e){var n=e[4]||{};n.type="normal",n.arg=t,e[4]=n}function R(e){this.tryEntries=[[-1]],e.forEach(E,this),this.reset(!0)}function _(n){if(null!=n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var a=-1,c=function e(){for(;++a<n.length;)if(o.call(n,a))return e.value=n[a],e.done=!1,e;return e.value=t,e.done=!0,e};return c.next=c}}throw new TypeError(e(n)+" is not iterable")}return h.prototype=m,l(b,"constructor",m),l(m,"constructor",h),h.displayName=l(m,i,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===h||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,l(e,i,"GeneratorFunction")),e.prototype=Object.create(b),e},r.awrap=function(e){return{__await:e}},w(k.prototype),l(k.prototype,u,(function(){return this})),r.AsyncIterator=k,r.async=function(e,t,n,a,o){void 0===o&&(o=Promise);var c=new k(f(e,t,n,a),o);return r.isGeneratorFunction(t)?c:c.next().then((function(e){return e.done?e.value:c.next()}))},w(b),l(b,i,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),n=[];for(var r in t)n.unshift(r);return function e(){for(;n.length;)if((r=n.pop())in t)return e.value=r,e.done=!1,e;return e.done=!0,e}},r.values=_,R.prototype={constructor:R,reset:function(e){if(this.prev=this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&o.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0][4];if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(t){c.type="throw",c.arg=e,n.next=t}for(var a=n.tryEntries.length-1;a>=0;--a){var o=this.tryEntries[a],c=o[4],s=this.prev,u=o[1],i=o[2];if(-1===o[0])return r("end"),!1;if(!u&&!i)throw Error("try statement without catch or finally");if(null!=o[0]&&o[0]<=s){if(s<u)return this.method="next",this.arg=t,r(u),!0;if(s<i)return r(i),!1}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r[0]>-1&&r[0]<=this.prev&&this.prev<r[2]){var a=r;break}}a&&("break"===e||"continue"===e)&&a[0]<=t&&t<=a[2]&&(a=null);var o=a?a[4]:{};return o.type=e,o.arg=t,a?(this.method="next",this.next=a[2],p):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[2]===e)return this.complete(n[4],n[3]),I(n),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n[0]===e){var r=n[4];if("throw"===r.type){var a=r.arg;I(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={i:_(e),r:n,n:r},"next"===this.method&&(this.arg=t),p}},r}function r(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=a(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,s=!0,u=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){u=!0,c=e},f:function(){try{s||null==n.return||n.return()}finally{if(u)throw c}}}}function a(e,t){if(e){if("string"==typeof e)return o(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e,t,n,r,a,o,c){try{var s=e[o](c),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,a)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,a){var o=e.apply(t,n);function s(e){c(o,r,a,s,u,"next",e)}function u(e){c(o,r,a,s,u,"throw",e)}s(void 0)}))}}function u(){return i.apply(this,arguments)}function i(){return i=s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,document.body.style.cursor="wait",e.next=4,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,o,c,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=t.workbook.worksheets).load("items/name"),e.next=4,t.sync();case 4:return a="Masterfile",r.items.map((function(e){return e.name})).includes(a)||(o=r.add(a),c=["Suite name","Test name","Test number","Lsl_typ","Usl_typ","Units"],(s=o.getRangeByIndexes(0,0,1,c.length)).values=[c],s.format.fill.color="#43a0ec",s.format.font.bold=!0,(u=t.workbook.worksheets.getItem("Masterfile")).position=0,u.activate()),e.next=10,t.sync();case 10:document.body.style.cursor="default";case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:e.next=10;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Error:",e.t0),v("Error");case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),i.apply(this,arguments)}function l(){return f.apply(this,arguments)}function f(){return f=s(n().mark((function e(){var t,r,a,o,c,u,i,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(document.body.style.cursor="wait",t=document.getElementById("fileInput"),r=t.files,a=Array.from(r),r&&0!==r.length){e.next=6;break}return e.abrupt("return");case 6:console.log("Amount of  file: %d",a.length),v("Amount of  file: %d",a.length),o=0,c=n().mark((function e(){var t,r,a,c,u,f,p,h,m,x,y,b,w,k,C;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l[i],r=t.name.toLowerCase().endsWith(".csv"),a=t.name.toLowerCase().endsWith(".xlsx"),c=t.name.toLowerCase().endsWith(".stdf"),e.prev=4,!r&&!a){e.next=15;break}console.log("file CSV or XLSX is processing"),v("file CSV or XLSX is processing"),(u=new FileReader).onload=function(){var e=s(n().mark((function e(r){var a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=new Uint8Array(r.target.result),!(XLSX.read(a,{type:"array"}).SheetNames.length>1)){e.next=10;break}return e.next=6,d(t,o);case 6:v("Processed file = %d",o=e.sent),e.next=15;break;case 10:return v("EY datalog is importing"),e.next=13,g(t,o);case 13:v("Processed file = %d",o=e.sent);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u.readAsArrayBuffer(t),(f=document.getElementById("importedFilesList"))&&((p=document.createElement("li")).textContent="".concat(t.name," - ").concat(t.webkitRelativePath||t.name),f.appendChild(p)),e.next=54;break;case 15:if(!c){e.next=52;break}if(console.log("File is STDF"),v("File is STDF"),h=new FormData,t){e.next=22;break}return console.warn("No file"),e.abrupt("return",{v:void 0});case 22:return h.append("files",t),console.log("Processing: ".concat(t.name)),v("Processing: ".concat(t.name)),document.body.style.cursor="wait",e.next=28,fetch("https://limit-project-demo.onrender.com/upload-stdf/",{method:"POST",body:h});case 28:if((m=e.sent).ok){e.next=36;break}return e.next=32,m.text();case 32:return x=e.sent,console.error("STDF upload failed:",x),v("STDF upload failed:",x),e.abrupt("return",{v:void 0});case 36:return e.next=38,m.blob();case 38:y=e.sent,b=window.URL.createObjectURL(y),w=t.name.replace(/\.[^/.]+$/,""),k="".concat(w,".xlsx"),(C=document.createElement("a")).href=b,C.download=k,document.body.appendChild(C),C.click(),C.remove(),window.URL.revokeObjectURL(b),v("STDF converted and downloaded successfully"),e.next=54;break;case 52:console.warn("Doesn't support ".concat(t.name)),v("Doesn't support ".concat(t.name));case 54:e.next=60;break;case 56:e.prev=56,e.t0=e.catch(4),console.error("Error while processing file: ".concat(t.name),e.t0),v("Error while processing file: ".concat(t.name));case 60:return e.prev=60,e.next=63,Excel.run(function(){var e=s(n().mark((function e(r){var a,o,c,s,u,i,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=r.workbook.worksheets).load("items/name"),e.next=4,r.sync();case 4:return o="InputFiles",a.items.map((function(e){return e.name})).includes(o)?c=a.getItem(o):(c=a.add(o),s=["File_Name"],(u=c.getRangeByIndexes(0,0,1,s.length)).values=[s],u.format.fill.color="#C6EFCE",u.format.font.bold=!0,c.position=0),(i=c.getUsedRange()).load("rowCount"),e.next=11,r.sync();case 11:return l=i.rowCount,c.getRangeByIndexes(l,0,1,1).values=[[t.name]],e.next=16,r.sync();case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 63:return e.finish(60);case 64:case"end":return e.stop()}}),e,null,[[4,56,60,64]])})),i=0,l=a;case 11:if(!(i<l.length)){e.next=19;break}return e.delegateYield(c(),"t0",13);case 13:if(!(u=e.t0)){e.next=16;break}return e.abrupt("return",u.v);case 16:i++,e.next=11;break;case 19:document.body.style.cursor="default";case 20:case"end":return e.stop()}}),e)}))),f.apply(this,arguments)}function d(e,t){return p.apply(this,arguments)}function p(){return p=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.abrupt("return",new Promise((function(e,a){var o=new FileReader;o.onload=function(a){var o=new FormData;o.append("file",t),console.log("Uploading Excel Datalog to API: ".concat(t.name)),v("Uploading Excel Datalog to API: ".concat(t.name));var c=new Uint8Array(a.target.result),u=XLSX.read(c,{type:"array"}).Sheets.mir;Excel.run(function(){var t=s(n().mark((function t(c){var i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X,G,V,W,$;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return f=c.workbook.worksheets.getItem("Masterfile"),(d=f.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:p=c.workbook.worksheets.getItem("Masterfile"),g=1e3,h=d.rowCount,m=d.columnCount,x=[],y=0;case 11:if(!(y<h)){t.next=21;break}return b=Math.min(g,h-y),(w=p.getRangeByIndexes(y,0,b,m)).load("values"),t.next=17,c.sync();case 17:x=x.concat(w.values);case 18:y+=g,t.next=11;break;case 21:for(k=x[0],console.log("headers: ",k),C=XLSX.utils.sheet_to_json(u,{defval:""}),E=null===(i=C[0])||void 0===i||null===(i=i.JOB_NAM)||void 0===i?void 0:i.trim(),I=null===(l=C[0])||void 0===l||null===(l=l.TEST_COD)||void 0===l?void 0:l.trim(),R=k.indexOf(E),console.log("productColINdex before add product name or stage: %d",R),v("productColINdex before add product name or stage: %d",R),_=[],T=0;T<=k.length;T++)"Can remove (Y/N)"===k[T]&&(S=T),"Lsl_typ"===k[T]&&(B=T);if(B-S-1>0)for(F=S+1;F<B;F++)N=k[F],O=x[1][F],N&&""!==N.trim()?(_.push({name:N.trim(),stage:O}),A=N.trim()):_.push({name:A,stage:O});if(-1!==R){t.next=58;break}if((L=c.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(U=L.getRange("F1:F1")).values=[[E]],!((M=k.indexOf("Can remove (Y/N)"))<0)){t.next=43;break}return v("Can't find Can remove col"),t.abrupt("return");case 43:if(!((P=k.indexOf("Lsl_typ"))<0)){t.next=47;break}return v("Can't find Lsl_typ col"),t.abrupt("return");case 47:for(Y=0,D=M;D<P;D++)j=d.getCell(0,D),isNaN(j)&&""===j||Y++;return H=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][Y%4],U.format.fill.color=H,L.getRange("F2:F2").values=[[I]],t.next=56,c.sync();case 56:t.next=85;break;case 58:return X=c.workbook.worksheets.getItem("Masterfile"),t.next=61,c.sync();case 61:return G=R,V=_.filter((function(e){return e.name===E})).length,console.log("product : %s , stage count : %d stage",E,V),X.getRangeByIndexes(0,G+1,1,1).insert(Excel.InsertShiftDirection.right),(d=X.getUsedRange()).load("rowCount"),t.next=70,c.sync();case 70:return W=d.rowCount,X.getRangeByIndexes(1,G+V,W,1).insert(Excel.InsertShiftDirection.right),d=X.getUsedRange(),t.next=76,c.sync();case 76:return X.getCell(1,G+V).values=[[I]],console.log("startcol for merge: %d stagecount for merge: %d",G,V),v("startcol for merge: %d stagecount for merge: %d",G,V),($=X.getRangeByIndexes(0,G,1,V)).values=Array(1).fill(Array(V).fill(E)),$.merge(),t.next=85,c.sync();case 85:return d=f.getUsedRange(),t.next=88,c.sync();case 88:return f.activate(),console.log("Completely added product name and stage"),v("Completely added product name and stage"),t.abrupt("return",fetch("https://limit-project-demo.onrender.com/process-self-converted-datalog/",{method:"POST",body:o}).then((function(e){return e.json()})).then((function(t){var o=t.test_data;null!==o&&v("process-datalog-excel fetched successfully"),Excel.run(function(){var t=s(n().mark((function t(c){var s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,R,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X,G,V,W,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u=c.workbook.worksheets.getItem("Masterfile"),(i=u.getUsedRange()).load(["rowCount","columnCount"]),t.next=5,c.sync();case 5:l=1e3,f=i.rowCount,d=i.columnCount,p=[],g=0;case 10:if(!(g<f)){t.next=20;break}return h=Math.min(l,f-g),(m=u.getRangeByIndexes(g,0,h,d)).load("values"),t.next=16,c.sync();case 16:p=p.concat(m.values);case 17:g+=l,t.next=10;break;case 20:if(x=p[0],y=x.indexOf("Test number"),b=x.indexOf("Suite name"),w=x.indexOf("Test name"),-1!==y){t.next=28;break}return console.error("Test number column is not found"),v("Test number is not found"),t.abrupt("return");case 28:if(-1!==b){t.next=32;break}return console.error("Suite name is not found"),v("Suite name is not found"),t.abrupt("return");case 32:if(-1!==w){t.next=36;break}return console.error("Test name is not found"),v("Test name is not found"),t.abrupt("return");case 36:return(k=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=40,c.sync();case 40:v("Determined Allcolindex and testNamerange"),C=[],t.prev=42,C=k.values.flat().filter((function(e){return""!==e})),t.next=51;break;case 46:return t.prev=46,t.t0=t.catch(42),console.error("Error while processing testNameRange.values:",t.t0),v("Error while processing testNameRange.values: %s",t.t0.message||t.t0),t.abrupt("return");case 51:if(Array.isArray(o)){t.next=55;break}return console.error("TestData isn't an array or isn't downloaded"),v("TestData isn't an array or isn't downloaded"),t.abrupt("return");case 55:E=[],t.prev=56,E=o.filter((function(e){return!C.includes(e.test_name)})),t.next=65;break;case 60:return t.prev=60,t.t1=t.catch(56),console.error("Error while TestData.filter",t.t1),v("Error while TestData.filter: %s",t.t1.message||t.t1),t.abrupt("return");case 65:if(Array.isArray(p)){t.next=69;break}return console.error("allValues isn't an array"),v("allValues isn't an array"),t.abrupt("return");case 69:if(R=p.length,T=[],A=[],t.prev=72,!(E.length>0)){t.next=92;break}if(F=E.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),-1!==y){t.next=78;break}return v("Can't find Test number column in header"),t.abrupt("return");case 78:return u.getRangeByIndexes(R,y,E.length,1).values=F,t.next=82,c.sync();case 82:return S=u.getRangeByIndexes(R,b,E.length,1),B=u.getRangeByIndexes(R,w,E.length,1),T=E.map((function(e){return[e.suite_name]})),A=E.map((function(e){return[e.test_name]})),S.values=T,B.values=A,t.next=90,c.sync();case 90:t.next=93;break;case 92:v("There's no new tests");case 93:t.next=98;break;case 95:t.prev=95,t.t2=t.catch(72),console.error("Error while processing newTests:",t.t2);case 98:if(N=new Uint8Array(a.target.result),O=XLSX.read(N,{type:"array"}),L=O.Sheets.mir,U=XLSX.utils.sheet_to_json(L,{defval:""}),M=null===(s=U[0])||void 0===s||null===(s=s.JOB_NAM)||void 0===s?void 0:s.trim(),-1!==(P=x.indexOf(M))){t.next=108;break}return console.error("Can't find product name :",M),v("Can't find product name :",M),t.abrupt("return");case 108:return _.push({name:M,stage:I}),Y=_.filter((function(e){return e.name===M})).length,(j=u.getRangeByIndexes(1,P,1,Y)).load("values"),t.next=114,c.sync();case 114:H=0;case 115:if(!(H<=Y)){t.next=123;break}if(console.log("stage %d = %s",H,j.values[0][H]),j.values[0][H]!==I){t.next=120;break}return D=H,t.abrupt("break",123);case 120:H++,t.next=115;break;case 123:return void 0===D&&(console.error("Can't find stage name index :",I),v("Can't find stage name index:",I)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",P,Y,D),i=u.getUsedRange(),t.next=128,c.sync();case 128:return i.load(["rowCount","columnCount"]),t.next=131,c.sync();case 131:f=i.rowCount,d=i.columnCount,p=[],X=0;case 135:if(!(X<f)){t.next=145;break}return G=Math.min(l,f-X),(V=u.getRangeByIndexes(X,0,G,d)).load("values"),t.next=141,c.sync();case 141:p=p.concat(V.values);case 142:X+=l,t.next=135;break;case 145:return x=p[0],(W=u.getRangeByIndexes(2,w,p.length-2,1)).load("values"),t.next=150,c.sync();case 150:$=W.values.map((function(e){return e[0]})),q=[];try{q=$.map((function(e){var t=o.find((function(t){return t.test_name===e}));return[t?t.YN_check:""]}))}catch(e){console.error("Error while creating YNValues:",e)}return(J=u.getRangeByIndexes(2,P+D,q.length,1)).load("values"),t.next=157,c.sync();case 157:return 0===q.length?(console.warn("No Y/N check data"),v("No Y/N check data")):(console.log("YN.length of %s %s is %d",M,I,q.length),v("YN.length of %s %s is %d",M,I,q.length)),J.values=q,t.next=161,c.sync();case 161:return z=x.indexOf("Is used (Y/N)"),(K=u.getRangeByIndexes(2,z,J.values.length,1)).load("values"),t.next=166,c.sync();case 166:for(Q=K.values,Array.isArray(Q)&&0!==Q.length||(Q=Array.from({length:J.values.length},(function(){return[""]}))),Z=0;Z<J.values.length;Z++)"Y"===J.values[Z][0]?"Partial"===Q[Z][0]||"No"===Q[Z][0]?Q[Z][0]="Partial":""===Q[Z][0]&&(Q[Z][0]="All"):"All"===Q[Z][0]||"Partial"===Q[Z][0]?Q[Z][0]="Partial":Q[Z][0]="No";return K.values=Q,t.next=172,c.sync();case 172:for((ee=J.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",ee.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},te=["All","Partial"],ne=["#C6EFCE","#FFEB9C"],re=K.conditionalFormats.count-1;re>=0;re--)K.conditionalFormats.getItemAt(re).delete();return t.next=180,c.sync();case 180:for(ae=0;ae<te.length;ae++)oe=te[ae],ce=ne[ae],(se=K.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=ce,se.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:oe};return t.next=183,c.sync();case 183:console.log("Finished processing one file"),v("Finished processing one file"),r++,e(r),document.body.style.cursor="default";case 188:case"end":return t.stop()}}),t,null,[[42,46],[56,60],[72,95]])})));return function(e){return t.apply(this,arguments)}}())})));case 92:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},o.onerror=a,o.readAsArrayBuffer(t)})));case 2:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function g(e,t){return h.apply(this,arguments)}function h(){return h=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,o){var c=new FileReader;c.onload=function(){var o=s(n().mark((function o(c){var s,u,i,l,f,d,p,g,h,m,x,y,b,w;return n().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return(s=new FormData).append("file",t),console.log("Uploading Excel Datalog to API: ".concat(t.name)),v("Uploading Excel Datalog to API: ".concat(t.name)),new Uint8Array(c.target.result),o.next=7,fetch("https://limit-project-demo.onrender.com/process-EY/",{method:"POST",body:s});case 7:if((u=o.sent).ok){o.next=12;break}return console.error("Upload failed"),v("Upload failed"),o.abrupt("return");case 12:return o.next=14,u.json();case 14:i=o.sent,l=i.data,f=[],g=[],h=r(l);try{for(h.s();!(m=h.n()).done;)x=m.value,p!==x.product?(p=x.product,d=x.stage,f.push({name:x.product,stage:x.stage}),g.push(p)):x.stage!==d&&(d=x.stage,f.push({name:x.product,stage:x.stage}))}catch(e){h.e(e)}finally{h.f()}console.log("All product: ",g),console.log("All EY stage and product: ",f),y=n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=w[b],a=f.filter((function(e){return e.name===t})),console.log("OneProduct_Allstage: ",a),o=r(a),e.prev=4,s=n().mark((function e(){var t,r,a,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.value,r=t.name,a=t.stage.toLowerCase(),e.next=5,k(r,a);case 5:return o=l.filter((function(e){return r===e.product&&t.stage===e.stage})),console.log("OneStage_data: ",o),e.next=9,E(o);case 9:return e.next=11,R(o,r,a);case 11:case"end":return e.stop()}}),e)})),o.s();case 7:if((c=o.n()).done){e.next=11;break}return e.delegateYield(s(),"t0",9);case 9:e.next=7;break;case 11:e.next=16;break;case 13:e.prev=13,e.t1=e.catch(4),o.e(e.t1);case 16:return e.prev=16,o.f(),e.finish(16);case 19:case"end":return e.stop()}}),e,null,[[4,13,16,19]])})),b=0,w=g;case 24:if(!(b<w.length)){o.next=29;break}return o.delegateYield(y(),"t0",26);case 26:b++,o.next=24;break;case 29:v("Import EY file successfully"),a++,e(a);case 32:case"end":return o.stop()}}),o)})));return function(e){return o.apply(this,arguments)}}(),c.onerror=o,c.readAsArrayBuffer(t)})));case 1:case"end":return e.stop()}}),e)}))),h.apply(this,arguments)}function m(e){return x.apply(this,arguments)}function x(){return x=s(n().mark((function e(a){var o,c,u,i,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],c=[],u=[],i=[],l=[],e.next=7,Excel.run(function(){var e=s(n().mark((function e(f){var d,p,g,h,m,x,b,w,k,C,E,I;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,fetch("https://limit-project-demo.onrender.com/upload-folder/",{method:"POST",body:a});case 3:if((d=e.sent).ok){e.next=8;break}return console.error("Upload failed"),v("Upload failed"),e.abrupt("return");case 8:return v("Import Folder fetched successfully"),e.next=11,d.json();case 11:return p=e.sent,g=p.mfh_files||[],(h=document.getElementById("mfh-list")).innerHTML="",(m=f.workbook.worksheets).load("items/name"),e.next=19,f.sync();case 19:if(x="InputFiles",!m.items.map((function(e){return e.name})).includes(x)){e.next=25;break}b=m.getItem(x),e.next=34;break;case 25:return b=m.add(x),w=["File_Name"],(k=b.getRangeByIndexes(0,0,1,w.length)).values=[w],k.format.fill.color="#C6EFCE",k.format.font.bold=!0,b.position=0,e.next=34,f.sync();case 34:if(x="Masterfile",m.items.map((function(e){return e.name})).includes(x)){e.next=48;break}return console.log("There is no Masterfile yet...Creating Masterfile"),v("There is no Masterfile yet...Creating Masterfile"),(E=f.workbook.worksheets).load("items/name"),e.next=43,f.sync();case 43:I="Masterfile",E.items.map((function(e){return e.name})).includes(I)||((C=E.add(I)).position=0),C.activate();case 48:g.forEach((function(e){var a=document.createElement("li");a.textContent="".concat(e," (ready)"),a.style.cursor="pointer",a.addEventListener("click",s(n().mark((function f(){var d,p;return n().wrap((function(f){for(;;)switch(f.prev=f.next){case 0:return document.querySelectorAll("li").forEach((function(e){e.classList.remove("selected-file")})),a.classList.add("selected-file"),f.next=4,fetch("https://limit-project-demo.onrender.com/process-testtable/?filename=".concat(encodeURIComponent(e)));case 4:if((d=f.sent).ok){f.next=9;break}return document.getElementById("download-links").innerHTML='<p style="color:red;">Failed to process '.concat(e,"</p>"),f.abrupt("return");case 9:return a.textContent=e,f.next=12,d.json();case 12:return y((p=f.sent).files),f.next=16,Excel.run(function(){var e=s(n().mark((function e(a){var s,f,d,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X,G,V,W,$,q,J,z,K,Q,Z,ee,te,ne,re,ae,oe,ce,se,ue,ie,le,fe,de,pe,ge,he,me,xe,ye,ve,be,we,ke,Ce,Ee,Ie,Re,_e,Se,Be,Te,Ae,Fe,Ne,Oe,Le,Ue,Me,Pe,Ye,De,je,He,Xe,Ge,Ve,We,$e,qe,Je,ze,Ke,Qe,Ze,et;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.body.style.cursor="wait",s=a.workbook.worksheets.getItem("Masterfile"),f=[],d=0;case 4:if(!(d<p.files.length)){e.next=75;break}return(g=s.getUsedRange()).load(["values","rowCount","columnCount"]),e.next=9,a.sync();case 9:return h=g.values[0]||[],m=g.values[1]||[],e.next=13,a.sync();case 13:if("ok"!==(x=p.files[d]).status||!Array.isArray(x.content)){e.next=72;break}if(y=x.content[0],b=x.content[1],0!==d){e.next=57;break}w=0;case 19:if(!(w<y.length)){e.next=34;break}if(k=y[w],C=b[w],f.push({name:k,stage:C}),!k||k===(h[w]||"")){e.next=27;break}return s.getCell(0,w).values=[[k]],e.next=27,a.sync();case 27:if(!C||C===m[w]){e.next=31;break}return s.getCell(1,w).values=[[C]],e.next=31,a.sync();case 31:w++,e.next=19;break;case 34:return g.load(["rowCount","columnCount"]),e.next=37,a.sync();case 37:E=a.workbook.worksheets.getItem("Masterfile"),I=1e3,R=g.rowCount,_=g.columnCount,S=[],B=0;case 43:if(!(B<R)){e.next=53;break}return T=Math.min(I,R-B),(A=E.getRangeByIndexes(B,0,T,_)).load("values"),e.next=49,a.sync();case 49:S=S.concat(A.values);case 50:B+=I,e.next=43;break;case 53:h=S[0],m=S[1],e.next=70;break;case 57:return g.load(["rowCount","columnCount"]),e.next=60,a.sync();case 60:if(NaN!==(F=h.indexOf("Units"))){e.next=63;break}return e.abrupt("return");case 63:N=n().mark((function e(){var t,r,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=y[O],r=b[O],"Lsl"!==t&&"Usl"!==t){e.next=21;break}if(void 0!==(o=f.find((function(e){return e.stage===r})))&&""!==o){e.next=21;break}return v("new stage is %s",r),f.push({name:t,stage:r}),s.getRangeByIndexes(0,F+3,g.rowCount,2).insert(Excel.InsertShiftDirection.right),v("Insert new col"),e.next=12,a.sync();case 12:return g.load(["rowCount","columnCount"]),e.next=15,a.sync();case 15:return s.getCell(0,F+3).values=[["Lsl"]],s.getCell(0,F+4).values=[["Usl"]],s.getCell(1,F+3).values=r,s.getCell(1,F+4).values=r,e.next=21,a.sync();case 21:case"end":return e.stop()}}),e)})),O=0;case 65:if(!(O<h.length)){e.next=70;break}return e.delegateYield(N(),"t0",67);case 67:O++,e.next=65;break;case 70:return e.next=72,a.sync();case 72:d++,e.next=4;break;case 75:return e.next=77,a.sync();case 77:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=81,a.sync();case 81:U=a.workbook.worksheets.getItem("Masterfile"),M=1e3,P=L.rowCount,Y=L.columnCount,D=[],j=0;case 87:if(!(j<P)){e.next=97;break}return H=Math.min(M,P-j),(X=U.getRangeByIndexes(j,0,H,Y)).load("values"),e.next=93,a.sync();case 93:D=D.concat(X.values);case 94:j+=M,e.next=87;break;case 97:return G=D[0],V=D[1],W=L.rowCount,e.next=102,a.sync();case 102:return $=[],q=[],J=[],z=[],K=[],Q=[],Z=[],ee=[],te=[],ne=[],re=[],ae=[],oe=[],(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=119,a.sync();case 119:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],ce=0;case 124:if(!(ce<P)){e.next=134;break}return se=Math.min(M,P-ce),(ue=U.getRangeByIndexes(ce,0,se,Y)).load("values"),e.next=130,a.sync();case 130:D=D.concat(ue.values);case 131:ce+=M,e.next=124;break;case 134:return G=D[0],V=D[1],e.next=138,a.sync();case 138:if(console.log(V),$=V.filter((function(e){return"w"===e[0]})),q=V.filter((function(e){return"f"===e[0]})),J=V.filter((function(e){return"a"===e[0]})),console.log($),console.log(q),console.log(J),z=$.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wh",""))-parseInt(t[0].replace("wh",""))})),K=$.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wr",""))-parseInt(t[0].replace("wr",""))})),Q=$.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wc",""))-parseInt(t[0].replace("wc",""))})),Z=$.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("wi",""))-parseInt(t[0].replace("wi",""))})),ee=$.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("ww",""))-parseInt(t[0].replace("ww",""))})),console.log(z),console.log(K),console.log(Q),console.log(ee),console.log(Z),$=[],0!==z.length&&(ie=$).push.apply(ie,t(z)),0!==K.length&&(le=$).push.apply(le,t(K)),0!==Q.length&&(fe=$).push.apply(fe,t(Q)),0!==ee.length&&(de=$).push.apply(de,t(ee)),0!==Z.length&&(pe=$).push.apply(pe,t(Z)),o.push.apply(o,t($)),te=q.filter((function(e){return"h"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fh",""))-parseInt(t[0].replace("fh",""))})),ne=q.filter((function(e){return"r"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fr",""))-parseInt(t[0].replace("fr",""))})),re=q.filter((function(e){return"c"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fc",""))-parseInt(t[0].replace("fc",""))})),ae=q.filter((function(e){return"i"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fi",""))-parseInt(t[0].replace("fi",""))})),oe=q.filter((function(e){return"w"===e[1]})).sort((function(e,t){return parseInt(e[0].replace("fw",""))-parseInt(t[0].replace("fw",""))})),console.log(te),console.log(ne),console.log(re),console.log(oe),console.log(ae),q=[],0!==te.length&&(ge=q).push.apply(ge,t(te)),0!==ne.length&&(he=q).push.apply(he,t(ne)),0!==re.length&&(me=q).push.apply(me,t(re)),0!==oe.length&&(xe=q).push.apply(xe,t(oe)),0!==ae.length&&(ye=q).push.apply(ye,t(ae)),o.push.apply(o,t(q)),o.push.apply(o,t(J)),ve=z.filter((function(e,t){return t%2==0})),be=K.filter((function(e,t){return t%2==0})),we=Q.filter((function(e,t){return t%2==0})),ke=Z.filter((function(e,t){return t%2==0})),Ce=ee.filter((function(e,t){return t%2==0})),Ee=te.filter((function(e,t){return t%2==0})),Ie=ne.filter((function(e,t){return t%2==0})),Re=re.filter((function(e,t){return t%2==0})),_e=ae.filter((function(e,t){return t%2==0})),Se=oe.filter((function(e,t){return t%2==0})),Be=J.filter((function(e,t){return t%2==0})),Te=[],ve.forEach((function(e){Ee.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),be.forEach((function(e){Ie.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),we.forEach((function(e){Re.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),ke.forEach((function(e){_e.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),Ce.forEach((function(e){Se.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),Ie.forEach((function(e){Be.forEach((function(t){var n="".concat(e,"__").concat(t),r="".concat(e," ? ").concat(t);Te.push({id:n,label:r})}))})),ve.forEach((function(e,t){ve.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),be.forEach((function(e,t){be.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),we.forEach((function(e,t){we.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),ke.forEach((function(e,t){ke.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),Ce.forEach((function(e,t){Ce.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),Ee.forEach((function(e,t){Ee.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),Ie.forEach((function(e,t){Ie.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),Re.forEach((function(e,t){Re.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),_e.forEach((function(e,t){_e.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),Se.forEach((function(e,t){Se.forEach((function(n,r){if(t<r){var a="".concat(e,"__").concat(n),o="".concat(e," ? ").concat(n);Te.push({id:a,label:o})}}))})),console.log(Te),Te.forEach((function(e){var t=document.createElement("label");t.className="label-item";var n=document.createElement("input");n.type="checkbox",n.id=e.id,n.name="stagePair",n.value=e.id,t.appendChild(n),t.appendChild(document.createTextNode(" ".concat(e.label))),labelList.appendChild(t);var r=e.label.slice(0,3),a=e.label.slice(-3);u.push.apply(u,[r]),i.push.apply(i,[a]);var o=["LL "+r.toUpperCase()+" ? "+a.toUpperCase(),"UL "+r.toUpperCase()+" ? "+a.toUpperCase()];c.push.apply(c,o)})),console.log("Allpair: ",c),Ae=V.indexOf("Spec"),!isNaN(Ae)){e.next=215;break}return v("Can't find Spec column!"),e.abrupt("return");case 215:return v("Spec index is %d",Ae),s.getRangeByIndexes(1,Ae+2,1,o.length).values=[o],e.next=220,a.sync();case 220:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=224,a.sync();case 224:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],Fe=0;case 229:if(!(Fe<P)){e.next=239;break}return Ne=Math.min(M,P-Fe),(Oe=U.getRangeByIndexes(Fe,0,Ne,Y)).load("values"),e.next=235,a.sync();case 235:D=D.concat(Oe.values);case 236:Fe+=M,e.next=229;break;case 239:return G=D[0],V=D[1],W=L.rowCount,e.next=244,a.sync();case 244:Le=r(p.files),e.prev=245,Le.s();case 247:if((Ue=Le.n()).done){e.next=288;break}if("ok"!==(Me=Ue.value).status||!Array.isArray(Me.content)){e.next=286;break}Pe=Me.content[0],Ye=Me.content[1],De=2;case 253:if(!(De<Me.content.length)){e.next=286;break}je=Me.content[De],He=[],Xe=0;case 257:if(!(Xe<G.length)){e.next=280;break}if("Lsl"!==(Ge=G[Xe])&&"Usl"!==Ge){e.next=274;break}if(Ve=V[Xe],"Lsl"!==Ge){e.next=268;break}if(NaN!==(We=Ye.indexOf(Ve))){e.next=265;break}return e.abrupt("continue",277);case 265:He.push(-1!==We?je[We]:""),e.next=272;break;case 268:if(NaN!==($e=Ye.indexOf(Ve))){e.next=271;break}return e.abrupt("continue",277);case 271:He.push(-1!==$e?je[$e+1]:"");case 272:e.next=277;break;case 274:qe=G.indexOf(Ge),Je=Pe.indexOf(Ge),-1!==qe&&-1!==Je&&(He[qe]=je[Je]);case 277:Xe++,e.next=257;break;case 280:s.getRangeByIndexes(W,0,1,G.length).values=[He],W++;case 283:De++,e.next=253;break;case 286:e.next=247;break;case 288:e.next=293;break;case 290:e.prev=290,e.t1=e.catch(245),Le.e(e.t1);case 293:return e.prev=293,Le.f(),e.finish(293);case 296:return e.next=298,a.sync();case 298:return(L=s.getUsedRange()).load(["rowCount","columnCount"]),e.next=302,a.sync();case 302:M=1e3,P=L.rowCount,Y=L.columnCount,D=[],ze=0;case 307:if(!(ze<P)){e.next=317;break}return Ke=Math.min(M,P-ze),(Qe=U.getRangeByIndexes(ze,0,Ke,Y)).load("values"),e.next=313,a.sync();case 313:D=D.concat(Qe.values);case 314:ze+=M,e.next=307;break;case 317:return G=D[0],V=D[1],W=L.rowCount,Ze=G.indexOf("Bin_s_num"),e.next=323,a.sync();case 323:return s.getRangeByIndexes(0,Ze,L.rowCount,2).insert(Excel.InsertShiftDirection.right),e.next=326,a.sync();case 326:return s.getCell(0,Ze).values=[["All LL ? Spec"]],s.getCell(0,Ze+1).values=[["All UL ? Spec"]],L.load(["rowCount","columnCount"]),e.next=331,a.sync();case 331:return s.getRangeByIndexes(0,Ze+2,L.rowCount,o.length).insert(Excel.InsertShiftDirection.right),L.load(["rowCount","columnCount"]),e.next=335,a.sync();case 335:for(et=Ae+2;et<Ae+2+o.length;et+=2)l.push.apply(l,["LL Spec? "+V[et],"UL Spec? "+V[et]]);return console.log(l),console.log("limit_compare contains undefined?",l.includes(void 0)),console.log("limit_compare contains null?",l.includes(null)),s.getRangeByIndexes(0,Ze+2,1,l.length).values=[l],e.next=342,a.sync();case 342:document.body.style.cursor="default";case 343:case"end":return e.stop()}}),e,null,[[245,290,293,296]])})));return function(t){return e.apply(this,arguments)}}());case 16:return f.next=18,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,c,s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X,G,V,W,$,q,J,z,K;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.sync();case 2:return e.next=4,new Promise((function(e){return setTimeout(e,100)}));case 4:return document.body.style.cursor="wait",r=t.workbook.worksheets.getItem("Masterfile"),(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:c=t.workbook.worksheets.getItem("Masterfile"),s=1e3,u=a.rowCount,i=a.columnCount,l=[],f=0;case 16:if(!(f<u)){e.next=26;break}return d=Math.min(s,u-f),(p=c.getRangeByIndexes(f,0,d,i)).load("values"),e.next=22,t.sync();case 22:l=l.concat(p.values);case 23:f+=s,e.next=16;break;case 26:for(g=l[0],h=l[1],m=l,x=a.rowCount,y=a.columnCount,v("rowCount : %d columnCount : %d",x,y),b=h.indexOf("Spec"),w=g.indexOf("All LL ? Spec"),k=g.indexOf("All UL ? Spec"),v("LLspecIndex : %d",b),C=b+o.length+2,E=[],I=2;I<m.length;I++){for(R=[],_=b;_<=C;_++)R.push(m[I][_]);E.push(R)}S=g.indexOf("All UL ? Spec")+1,B=[],T=[],A=[],v("Limit length : %d",E.length),F=0;case 45:if(!(F<E.length)){e.next=73;break}N=E[F],O=N[0],L=N[1],U="In-spec",M="In-spec",A[F]=[],P=2;case 53:if(!(P+1<N.length)){e.next=68;break}if(Y=N[P],D=N[P+1],void 0!==Y&&void 0!==D){e.next=59;break}return console.warn("Missing LSL/USL at row ".concat(F,", columns ").concat(P," and ").concat(P+1)),e.abrupt("continue",65);case 59:j="",H="",""===Y||null==Y||isNaN(Y)||(Y>=O?j=O<Y?"Widen":"Same":(U="Out-spec",j="Tighten")),""===D||null==D||isNaN(D)||(D<=L?H=L>D?"Widen":"Same":(M="Out-spec",H="Tighten")),A[F].push(j),A[F].push(H);case 65:P+=2,e.next=53;break;case 68:B.push([U]),T.push([M]);case 70:F++,e.next=45;break;case 73:return r.getRangeByIndexes(2,S,A.length,A[0].length).values=A,e.next=76,t.sync();case 76:return v("All_LL_spec length : %d",B.length),v("All_UL_spec length : %d",T.length),X=r.getRangeByIndexes(2,w,B.length,1),G=r.getRangeByIndexes(2,k,T.length,1),X.values=B,G.values=T,e.next=84,t.sync();case 84:return r.getRangeByIndexes(0,3,x,2).insert(Excel.InsertShiftDirection.right),r.getCell(0,3).values="Is used (Y/N)",r.getCell(0,4).values="Can remove (Y/N)",e.next=90,t.sync();case 90:for(v("Limit Compare Successed"),V=["Out-spec","In-spec"],W=["#ff9c9c","#C6EFCE"],$=0;$<V.length;$++)q=V[$],J=W[$],(z=X.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=J,z.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:q},(K=G.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=J,K.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:q};return e.next=96,t.sync();case 96:document.body.style.cursor="default";case 97:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 18:return f.next=20,Excel.run(function(){var e=s(n().mark((function e(t){var r,a,s,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",e.next=3,t.sync();case 3:return r=t.workbook.worksheets.getItem("Masterfile"),e.next=6,t.sync();case 6:return(a=r.getUsedRange()).load(["rowCount","columnCount"]),e.next=10,t.sync();case 10:s=t.workbook.worksheets.getItem("Masterfile"),f=1e3,d=a.rowCount,p=a.columnCount,g=[],h=0;case 16:if(!(h<d)){e.next=26;break}return m=Math.min(f,d-h),(x=s.getRangeByIndexes(h,0,m,p)).load("values"),e.next=22,t.sync();case 22:g=g.concat(x.values);case 23:h+=f,e.next=16;break;case 26:return y=g[0],b=g[1],e.next=30,t.sync();case 30:return v("Bin s index: %d",w=y.indexOf("Bin_s_num")),r.getRangeByIndexes(0,w,a.rowCount,c.length).insert(Excel.InsertShiftDirection.right),r.getRangeByIndexes(0,w,1,c.length).values=[c],e.next=36,t.sync();case 36:for(v("LLspecIndex : %d",k=b.indexOf("Spec")),C=k+o.length+2,E=[],I=2;I<g.length;I++){for(R=[],_=k;_<=C;_++)R.push(g[I][_]);E.push(R)}S=[],B=0;case 43:if(!(B<u.length)){e.next=55;break}if(T=u[B],A=i[B],F=b.indexOf(T),N=b.indexOf(A),!(F<0||N<0)){e.next=51;break}return console.warn("ไม่พบ stage: ".concat(T," หรือ ").concat(A)),e.abrupt("continue",52);case 51:for(O=0;O<E.length;O++)L=E[O],U=L[F-k],M=L[F-k+1],P=L[N-k],Y=L[N-k+1],D="",j="",""===U||null==U||isNaN(U)||""===P||null==P||isNaN(P)||(D=U<P?"Widen":U>P?"Tighten":"Same"),""===M||null==M||isNaN(M)||""===Y||null==Y||isNaN(Y)||(j=M>Y?"Widen":M<Y?"Tighten":"Same"),S[O]||(S[O]=[]),S[O].push(D),S[O].push(j);case 52:B++,e.next=43;break;case 55:if(console.log("All compare:",S),H=y.indexOf(l[l.length-1]),console.log(H),!(H<0)){e.next=61;break}return v("Can't find last spec vs limit col"),e.abrupt("return");case 61:return r.getRangeByIndexes(2,H+1,S.length,S[0].length).values=S,e.next=64,t.sync();case 64:return a.load("columnCount"),e.next=67,t.sync();case 67:for(X=0;X<a.columnCount;X++)r.getCell(0,X).format.fill.color="#c4d4f3";return e.next=70,t.sync();case 70:document.body.style.cursor="default";case 71:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:return f.next=22,Excel.run(function(){var t=s(n().mark((function t(r){var a,o,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("InputFiles"),(o=a.getUsedRange()).load("rowCount"),t.next=6,r.sync();case 6:return c=o.rowCount,a.getRangeByIndexes(c,0,1,1).values=[[e]],t.next=11,r.sync();case 11:v("Successfully limit files imported"),document.body.style.cursor="default";case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());case 22:case"end":return f.stop()}}),f)})))),h.appendChild(a)})),document.body.style.cursor="default";case 50:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 7:case"end":return e.stop()}}),e)}))),x.apply(this,arguments)}function y(e){document.body.style.cursor="wait";var t=document.getElementById("download-links");t.innerHTML="";var n=3;e.forEach((function(e){var r,a=((null===(r=e.content)||void 0===r?void 0:r.length)||0)-3+n,o=document.createElement("div");o.innerHTML="\n      <p><b>".concat(e.path,"</b> - ").concat(e.status," (").concat(n,"-").concat(a,")</p>\n    "),t.appendChild(o),n=a+1})),document.body.style.cursor="default"}function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=document.getElementById("consoleOutput"),o=(new Date).toLocaleString(),c=e,s=0;c=c.replace(/%[sdif]/g,(function(e){var t=n[s++];switch(e){case"%d":case"%i":return parseInt(t);case"%f":return parseFloat(t).toFixed(2);default:return String(t)}}));var u=document.createElement("div");u.textContent="[".concat(o,"] > ").concat(c),a.appendChild(u),a.scrollTop=a.scrollHeight}function b(e,t){return w.apply(this,arguments)}function w(){return w=s(n().mark((function e(t,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o.workbook.worksheets.load("items/name"),e.next=5,o.sync();case 5:return c=o.workbook.worksheets.getItem("Masterfile"),s=c.getUsedRange(),e.next=9,o.sync();case 9:return s.load(["rowCount","columnCount"]),e.next=12,o.sync();case 12:console.log(s.rowCount),u=1e3,i=s.rowCount,l=s.columnCount,f=[],d=0;case 18:if(!(d<i)){e.next=28;break}return p=Math.min(u,i-d),(g=c.getRangeByIndexes(d,0,p,l)).load("values"),e.next=24,o.sync();case 24:f=f.concat(g.values);case 25:d+=u,e.next=18;break;case 28:h=f[0],y=r(t),e.prev=30,y.s();case 32:if((b=y.n()).done){e.next=57;break}if(w=b.value,k=w.slice(0,3),C=w.slice(-3),m="LL "+k.toUpperCase()+" ? "+C.toUpperCase(),console.log(m),-1!==(x=h.indexOf(m))){e.next=42;break}return v("can't find an index to hide"),e.abrupt("return");case 42:return v("Hiding : %s ? %s",k.toUpperCase(),C.toUpperCase()),e.prev=43,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!0,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!0,e.next=50,o.sync();case 50:e.next=55;break;case 52:e.prev=52,e.t0=e.catch(43),console.log("Can't hide col due to: ",e.t0);case 55:e.next=32;break;case 57:e.next=62;break;case 59:e.prev=59,e.t1=e.catch(30),y.e(e.t1);case 62:return e.prev=62,y.f(),e.finish(62);case 65:return e.next=67,o.sync();case 67:E=r(a),e.prev=68,E.s();case 70:if((I=E.n()).done){e.next=95;break}if(R=I.value,_=R.slice(0,3),S=R.slice(-3),m="LL "+_.toUpperCase()+" ? "+S.toUpperCase(),-1!==(x=h.indexOf(m))){e.next=79;break}return v("can't find an index to hide"),e.abrupt("return");case 79:return e.prev=79,c.getRangeByIndexes(0,x-2,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x-1,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x,s.rowCount,1).getEntireColumn().columnHidden=!1,c.getRangeByIndexes(0,x+1,s.rowCount,1).getEntireColumn().columnHidden=!1,e.next=86,o.sync();case 86:e.next=91;break;case 88:e.prev=88,e.t2=e.catch(79),console.log("Can't show col due to: ",e.t2);case 91:return e.next=93,o.sync();case 93:e.next=70;break;case 95:e.next=100;break;case 97:e.prev=97,e.t3=e.catch(68),E.e(e.t3);case 100:return e.prev=100,E.f(),e.finish(100);case 103:document.body.style.cursor="default";case 104:case"end":return e.stop()}}),e,null,[[30,59,62,65],[43,52],[68,97,100,103],[79,88]])})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),w.apply(this,arguments)}function k(e,t){return C.apply(this,arguments)}function C(){return C=s(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("productName in Check_product_stage: ",t),console.log("stagename in Check_product_stage: ",r),e.next=4,Excel.run(function(){var e=s(n().mark((function e(a){var o,c,s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",o=a.workbook.worksheets.getItem("Masterfile"),(c=o.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,a.sync();case 6:s=a.workbook.worksheets.getItem("Masterfile"),u=1e3,i=c.rowCount,l=c.columnCount,f=[],d=0;case 12:if(!(d<i)){e.next=22;break}return p=Math.min(u,i-d),(g=s.getRangeByIndexes(d,0,p,l)).load("values"),e.next=18,a.sync();case 18:f=f.concat(g.values);case 19:d+=u,e.next=12;break;case 22:for(h=f[0],console.log("headers: ",h),m=h.indexOf(t),console.log("productColINdex before add product name or stage: %d",m),v("productColINdex before add product name or stage: %d",m),x=[],w=0;w<=h.length;w++)"Can remove (Y/N)"===h[w]&&(y=w),"Lsl_typ"===h[w]&&(b=w);if(b-y-1>0)for(C=y+1;C<b;C++)E=h[C],I=f[1][C],E&&""!==E.trim()?(x.push({name:E.trim(),stage:I}),k=E.trim()):x.push({name:k,stage:I});if(-1!==m){e.next=56;break}if((R=a.workbook.worksheets.getItem("Masterfile")).getRange("F:F").insert(Excel.InsertShiftDirection.right),(_=R.getRange("F1:F1")).values=[[t]],!((S=h.indexOf("Can remove (Y/N)"))<0)){e.next=41;break}return v("Can't find Can remove col"),e.abrupt("return");case 41:if(!((B=h.indexOf("Lsl_typ"))<0)){e.next=45;break}return v("Can't find Lsl_typ col"),e.abrupt("return");case 45:for(T=0,A=S;A<B;A++)F=c.getCell(0,A),isNaN(F)&&""===F||T++;return N=["#C6EFCE","#FFEB9C","#FFC7CE","#e6cdfa"][T%4],_.format.fill.color=N,R.getRange("F2:F2").values=[[r]],e.next=54,a.sync();case 54:e.next=84;break;case 56:return O=a.workbook.worksheets.getItem("Masterfile"),e.next=59,a.sync();case 59:return L=m,U=x.filter((function(e){return e.name===t})).length,console.log("product :  %s , stage count : %d",t,U),v("product : %s , stage count : %d",t,U),O.getRangeByIndexes(0,L+1,1,1).insert(Excel.InsertShiftDirection.right),(c=O.getUsedRange()).load("rowCount"),e.next=69,a.sync();case 69:return M=c.rowCount,O.getRangeByIndexes(1,L+U,M,1).insert(Excel.InsertShiftDirection.right),c=O.getUsedRange(),e.next=75,a.sync();case 75:return O.getCell(1,L+U).values=[[r]],console.log("startcol for merge: %d stagecount for merge: %d",L,U),v("startcol for merge: %d stagecount for merge: %d",L,U),(P=O.getRangeByIndexes(0,L,1,U)).values=Array(1).fill(Array(U).fill(t)),P.merge(),e.next=84,a.sync();case 84:document.body.style.cursor="default";case 85:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}}),e)}))),C.apply(this,arguments)}function E(e){return I.apply(this,arguments)}function I(){return I=s(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("data from EY oneproduct: ",t),e.next=3,Excel.run(function(){var e=s(n().mark((function e(r){var a,o,c,s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",a=r.workbook.worksheets.getItem("Masterfile"),(o=a.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,r.sync();case 6:c=1e3,s=o.rowCount,u=o.columnCount,i=[],l=0;case 11:if(!(l<s)){e.next=21;break}return f=Math.min(c,s-l),(d=a.getRangeByIndexes(l,0,f,u)).load("values"),e.next=17,r.sync();case 17:i=i.concat(d.values);case 18:l+=c,e.next=11;break;case 21:if(p=i[0],g=p.indexOf("Test number"),h=p.indexOf("Suite name"),m=p.indexOf("Test name"),-1!==g){e.next=29;break}return console.error("Can't find Test number column"),v("Can't find Test number column"),e.abrupt("return");case 29:if(-1!==h){e.next=33;break}return console.error("Can't find Suite name column"),v("Can't find Suite name column"),e.abrupt("return");case 33:if(-1!==m){e.next=37;break}return console.error("Can't find Test name column"),v("Can't find Test name column"),e.abrupt("return");case 37:return(x=a.getRangeByIndexes(2,m,i.length-2,1)).load("values"),e.next=41,r.sync();case 41:v("Determined Allcolindex and testNamerange"),y=[],e.prev=43,y=x.values.flat().filter((function(e){return""!==e})),e.next=51;break;case 47:return e.prev=47,e.t0=e.catch(43),console.error("Error while processing testNameRange.values:",e.t0),e.abrupt("return");case 51:if(Array.isArray(t)){e.next=54;break}return console.error("data isn't an array or isn't loaded"),e.abrupt("return");case 54:b=[],e.prev=55,b=t.filter((function(e){return!y.includes(e.test_name)})),console.log("newTests from EY: ",b),e.next=64;break;case 60:return e.prev=60,e.t1=e.catch(55),console.error("Error while data.filter",e.t1),e.abrupt("return");case 64:if(Array.isArray(i)){e.next=67;break}return console.error("allValues isn't an array"),e.abrupt("return");case 67:if(w=i.length,E=[],I=[],!(b.length>0)){e.next=90;break}if(R=b.map((function(e){var t;return[null!==(t=null==e?void 0:e.test_number)&&void 0!==t?t:""]})),v("newTests.length = %d",b.length),-1!==g){e.next=76;break}return v("Can't find Test number column"),e.abrupt("return");case 76:return a.getRangeByIndexes(w,g,b.length,1).values=R,e.next=80,r.sync();case 80:return k=a.getRangeByIndexes(w,h,b.length,1),C=a.getRangeByIndexes(w,m,b.length,1),E=b.map((function(e){return[e.suite_name]})),I=b.map((function(e){return[e.test_name]})),k.values=E,C.values=I,e.next=88,r.sync();case 88:e.next=91;break;case 90:v("There's no new tests");case 91:document.body.style.cursor="default";case 92:case"end":return e.stop()}}),e,null,[[43,47],[55,60]])})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)}))),I.apply(this,arguments)}function R(e,t,n){return _.apply(this,arguments)}function _(){return _=s(n().mark((function e(t,r,a){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Excel.run(function(){var e=s(n().mark((function e(o){var c,s,u,i,l,f,d,p,g,h,m,x,y,b,w,k,C,E,I,R,_,S,B,T,A,F,N,O,L,U,M,P,Y,D,j,H,X,G,V,W,$,q;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return document.body.style.cursor="wait",c=o.workbook.worksheets.getItem("Masterfile"),(s=c.getUsedRange()).load(["rowCount","columnCount"]),e.next=6,o.sync();case 6:u=1e3,i=s.rowCount,l=s.columnCount,f=[],d=0;case 11:if(!(d<i)){e.next=21;break}return p=Math.min(u,i-d),(g=c.getRangeByIndexes(d,0,p,l)).load("values"),e.next=17,o.sync();case 17:f=f.concat(g.values);case 18:d+=u,e.next=11;break;case 21:for(h=f[0],m=[],b=0;b<=h.length;b++)"Can remove (Y/N)"===h[b]&&(x=b),"Lsl_typ"===h[b]&&(y=b);if(y-x-1>0)for(k=x+1;k<y;k++)C=h[k],E=f[1][k],C&&""!==C.trim()?(m.push({name:C.trim(),stage:E}),w=C.trim()):m.push({name:w,stage:E});if(I=h.indexOf("Test number"),R=h.indexOf("Suite name"),_=h.indexOf("Test name"),-1!==I){e.next=33;break}return console.error("Test number column is not found"),v("Test number column is not found"),e.abrupt("return");case 33:if(-1!==R){e.next=37;break}return console.error("Suite name column is not found"),v("Suite name column is not found"),e.abrupt("return");case 37:if(-1!==_){e.next=41;break}return console.error("Test name column is not found"),v("Test name column is not found"),e.abrupt("return");case 41:if(-1!==(S=h.indexOf(r))){e.next=46;break}return console.error("Can't find:",r),v("Can't find:",r),e.abrupt("return");case 46:return B=m.filter((function(e){return e.name===r})).length,(A=c.getRangeByIndexes(1,S,1,B)).load("values"),e.next=51,o.sync();case 51:F=0;case 52:if(!(F<=B)){e.next=60;break}if(console.log("stage %d = %s",F,A.values[0][F]),A.values[0][F]!==a){e.next=57;break}return T=F,e.abrupt("break",60);case 57:F++,e.next=52;break;case 60:return void 0===T&&(console.error("Can't find:",a),v("Can't find:",a)),console.log("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",S,B,T),v("productColIndex: %d, stage_count: %d, stageArrayIndex: %d ",S,B,T),(N=c.getRangeByIndexes(2,_,f.length-2,1)).load("values"),e.next=67,o.sync();case 67:v("allTestNames length : %d",(O=N.values.map((function(e){return e[0]}))).length),L=[];try{L=O.map((function(e){var n=t.find((function(t){return t.test_name===e}));return[n?n.YN_check:""]}))}catch(e){console.error("Error while processing YNValues:",e),v("Error while processing YNValues: %s",e.message||e)}return v("YNcolIndex : %d",S+T),(U=c.getRangeByIndexes(2,S+T,L.length,1)).load("values"),e.next=76,o.sync();case 76:return 0===L.length?(console.warn("There's no Y/N check data"),v("There's no Y/N check data")):(console.log("YN.length of %s %s is %d",r,a,L.length),v("YN.length of %s %s is %d",r,a,L.length)),U.values=L,e.next=80,o.sync();case 80:return M=h.indexOf("Is used (Y/N)"),(P=c.getRangeByIndexes(2,M,U.values.length,1)).load("values"),e.next=85,o.sync();case 85:for(Y=P.values,Array.isArray(Y)&&0!==Y.length||(Y=Array.from({length:U.values.length},(function(){return[""]}))),D=0;D<U.values.length;D++)"Y"===U.values[D][0]?"Partial"===Y[D][0]||"No"===Y[D][0]?Y[D][0]="Partial":""===Y[D][0]&&(Y[D][0]="All"):"All"===Y[D][0]||"Partial"===Y[D][0]?Y[D][0]="Partial":Y[D][0]="No";return P.values=Y,e.next=91,o.sync();case 91:return(j=U.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="#C6EFCE",j.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Y"},P.conditionalFormats.load("count"),e.next=97,o.sync();case 97:for(H=P.conditionalFormats.count-1;H>=0;H--)P.conditionalFormats.getItemAt(H).delete();return e.next=100,o.sync();case 100:for(X=["Partial","All"],G=["#FFEB9C","#C6EFCE"],V=0;V<X.length;V++)W=X[V],$=G[V],(q=P.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color=$,q.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:W};return e.next=105,o.sync();case 105:document.body.style.cursor="default";case 106:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 2:case"end":return e.stop()}}),e)}))),_.apply(this,arguments)}Office.onReady((function(e){if(e.host===Office.HostType.Excel){document.getElementById("sideload-msg").style.display="none",document.getElementById("app-body").style.display="flex",document.getElementById("run").onclick=u,document.getElementById("importFolderBtn").addEventListener("click",s(n().mark((function e(){var t,a,o,c,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((t=document.getElementById("folderInput").files).length){e.next=4;break}return alert("Please select a folder first."),e.abrupt("return");case 4:a=new FormData,o=r(t);try{for(o.s();!(c=o.n()).done;)s=c.value,a.append("files",s,s.webkitRelativePath)}catch(e){o.e(e)}finally{o.f()}return e.next=9,m(a);case 9:case"end":return e.stop()}}),e)}))));var t=document.getElementById("importDatalogBtn");t&&t.addEventListener("click",l),document.getElementById("compareAll").addEventListener("click",s(n().mark((function e(){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:document.querySelectorAll("#checkboxForm input[type='checkbox']").forEach((function(e){e.checked=!e.checked}));case 2:case"end":return e.stop()}}),e)})))),document.getElementById("compare").addEventListener("click",s(n().mark((function e(){var t,r,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=document.querySelectorAll("#checkboxForm input[type='checkbox']"),r=Array.from(t).filter((function(e){return!e.checked})).map((function(e){return e.value})),console.log(r),a=Array.from(t).filter((function(e){return e.checked})).map((function(e){return e.value})),console.log(a),e.next=7,b(r,a);case 7:case"end":return e.stop()}}),e)}))))}}))}(),new URL(n(58394),n.b),new URL(n(60947),n.b)}();
//# sourceMappingURL=taskpane.js.map